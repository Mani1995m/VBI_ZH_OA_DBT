2020-05-22 07:09:43.217770 (MainThread): Running with dbt=0.16.1
2020-05-22 07:09:43.641171 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:09:44.600625 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 07:09:44.602061 (MainThread): Tracking: tracking
2020-05-22 07:09:44.603057 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D7CBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0690E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0692C8>]}
2020-05-22 07:09:44.644095 (MainThread): Partial parsing not enabled
2020-05-22 07:09:44.657136 (MainThread): Parsing macros\core.sql
2020-05-22 07:09:44.671926 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:09:44.834734 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:09:44.870744 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:09:44.878744 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:09:44.884683 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:09:44.893800 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:09:44.898863 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:09:44.906863 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:09:44.914982 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:09:44.939895 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:09:44.960950 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:09:44.966764 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:09:44.975804 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:09:45.003804 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:09:45.052192 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:09:45.055498 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:09:45.080375 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:09:45.087919 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:09:45.095919 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:09:45.106115 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:09:45.110162 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:09:45.114117 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:09:45.116366 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:09:45.117363 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:09:45.146517 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:09:45.150517 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:09:45.167049 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:09:45.168046 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:09:45.176091 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:09:45.204092 (MainThread): Partial parsing not enabled
2020-05-22 07:09:45.255623 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:09:45.255623 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:09:45.297262 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.my_first_dbt_model".
2020-05-22 07:09:45.297262 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:09:45.308300 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.my_second_dbt_model".
2020-05-22 07:09:45.308300 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:09:45.413410 (MainThread): Acquiring new snowflake connection "test.vbi_zoho_people.unique_my_first_dbt_model_id".
2020-05-22 07:09:45.413410 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:09:45.432152 (MainThread): Acquiring new snowflake connection "test.vbi_zoho_people.not_null_my_first_dbt_model_id".
2020-05-22 07:09:45.432152 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:09:45.444280 (MainThread): Acquiring new snowflake connection "test.vbi_zoho_people.unique_my_second_dbt_model_id".
2020-05-22 07:09:45.444280 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:09:45.456280 (MainThread): Acquiring new snowflake connection "test.vbi_zoho_people.not_null_my_second_dbt_model_id".
2020-05-22 07:09:45.456280 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:09:45.893505 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 0 sources
2020-05-22 07:09:45.901340 (MainThread): 
2020-05-22 07:09:45.902334 (MainThread): 12:39:45 | Concurrency: 1 threads (target='dev')
2020-05-22 07:09:45.902334 (MainThread): 12:39:45 | 
2020-05-22 07:09:45.954988 (Thread-1): Began running node model.vbi_zoho_people.my_first_dbt_model
2020-05-22 07:09:45.955989 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.my_first_dbt_model".
2020-05-22 07:09:45.955989 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:09:45.955989 (Thread-1): Compiling model.vbi_zoho_people.my_first_dbt_model
2020-05-22 07:09:46.024937 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.my_first_dbt_model"
2020-05-22 07:09:46.032093 (Thread-1): finished collecting timing info
2020-05-22 07:09:46.032713 (Thread-1): finished collecting timing info
2020-05-22 07:09:46.033751 (Thread-1): Finished running node model.vbi_zoho_people.my_first_dbt_model
2020-05-22 07:09:46.033751 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:09:46.036191 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:09:46.037877 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:09:46.037877 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:09:46.058493 (Thread-1): On "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 07:09:46.227863 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:09:46.227863 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 07:09:48.274624 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 07:09:49.862831 (Thread-1): SQL status: SUCCESS 1 in 3.63 seconds
2020-05-22 07:09:49.862831 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:09:49.862831 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 07:09:50.397411 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:09:50.397411 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: ROLLBACK
2020-05-22 07:09:50.397411 (Thread-1): initiating rollback
2020-05-22 07:09:51.156260 (Thread-1): Error running SQL: macro list_relations_without_caching
2020-05-22 07:09:51.156260 (Thread-1): Rolling back transaction.
2020-05-22 07:09:51.211184 (Thread-1): finished collecting timing info
2020-05-22 07:09:51.211184 (Thread-1): Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (02000): SQL compilation error:
  Database 'ZOHO_OA_EDW' does not exist or not authorized.
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database 'ZOHO_OA_EDW' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 160, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 335, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\compilation.py", line 250, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\compilation.py", line 154, in compile_node
    compiled_node.compiled_sql = dbt.clients.jinja.get_rendered(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 415, in get_rendered
    return render_template(template, ctx, node)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 409, in render_template
    return template.render(ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 26, in top-level template code
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 5, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 685, in get_relation
    relations_list = self.list_relations(database, schema)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 636, in list_relations
    relations = self.list_relations_without_caching(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\impl.py", line 202, in list_relations_without_caching
    results = self.execute_macro(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 952, in execute_macro
    result = macro_function(**kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 214, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 23, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 9, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (02000): SQL compilation error:
  Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:09:51.252380 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:09:51.254382 (Thread-1): Began running node model.vbi_zoho_people.my_second_dbt_model
2020-05-22 07:09:51.255379 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.my_second_dbt_model".
2020-05-22 07:09:51.255379 (Thread-1): Re-using an available connection from the pool (formerly model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW).
2020-05-22 07:09:51.255379 (Thread-1): Compiling model.vbi_zoho_people.my_second_dbt_model
2020-05-22 07:09:51.287451 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.my_second_dbt_model"
2020-05-22 07:09:51.292268 (Thread-1): finished collecting timing info
2020-05-22 07:09:51.293469 (Thread-1): finished collecting timing info
2020-05-22 07:09:51.294466 (Thread-1): Finished running node model.vbi_zoho_people.my_second_dbt_model
2020-05-22 07:09:51.294466 (Thread-1): Began running node test.vbi_zoho_people.not_null_my_first_dbt_model_id
2020-05-22 07:09:51.297551 (Thread-1): Acquiring new snowflake connection "test.vbi_zoho_people.not_null_my_first_dbt_model_id".
2020-05-22 07:09:51.298551 (MainThread): Connection 'test.vbi_zoho_people.not_null_my_second_dbt_model_id' was properly closed.
2020-05-22 07:09:51.299497 (Thread-1): Re-using an available connection from the pool (formerly model.vbi_zoho_people.my_second_dbt_model).
2020-05-22 07:09:51.299497 (MainThread): Connection 'model.vbi_zoho_people.my_second_dbt_model' was left open.
2020-05-22 07:09:51.300505 (Thread-1): Compiling test.vbi_zoho_people.not_null_my_first_dbt_model_id
2020-05-22 07:09:51.301601 (MainThread): On test.vbi_zoho_people.not_null_my_first_dbt_model_id: Close
2020-05-22 07:09:51.347099 (Thread-1): Writing injected SQL for node "test.vbi_zoho_people.not_null_my_first_dbt_model_id"
2020-05-22 07:09:51.353245 (Thread-1): finished collecting timing info
2020-05-22 07:09:51.354283 (Thread-1): finished collecting timing info
2020-05-22 07:09:52.214436 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E13CB98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E18E580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1D11D8>]}
2020-05-22 07:09:52.215135 (Thread-1): Finished running node test.vbi_zoho_people.not_null_my_first_dbt_model_id
2020-05-22 07:09:52.216609 (MainThread): Flushing usage events
2020-05-22 07:09:52.217654 (Thread-1): Began running node test.vbi_zoho_people.unique_my_first_dbt_model_id
2020-05-22 07:09:52.220642 (Thread-1): Acquiring new snowflake connection "test.vbi_zoho_people.unique_my_first_dbt_model_id".
2020-05-22 07:09:52.220642 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:09:52.221684 (Thread-1): Compiling test.vbi_zoho_people.unique_my_first_dbt_model_id
2020-05-22 07:09:52.265663 (Thread-1): Writing injected SQL for node "test.vbi_zoho_people.unique_my_first_dbt_model_id"
2020-05-22 07:09:52.273237 (Thread-1): finished collecting timing info
2020-05-22 07:09:52.274284 (Thread-1): finished collecting timing info
2020-05-22 07:09:52.274284 (Thread-1): Finished running node test.vbi_zoho_people.unique_my_first_dbt_model_id
2020-05-22 07:09:55.048787 (MainThread): Connection 'test.vbi_zoho_people.unique_my_first_dbt_model_id' was properly closed.
2020-05-22 07:09:55.048787 (MainThread): Encountered an error:
2020-05-22 07:09:55.052797 (MainThread): Runtime Error
  Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
    002003 (02000): SQL compilation error:
    Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:09:55.104115 (MainThread): Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 371, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 332, in execute_with_hooks
    res = self.execute_nodes()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 271, in execute_nodes
    self.run_queue(pool)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 218, in run_queue
    self._raise_set_error()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 194, in _raise_set_error
    raise RuntimeException(self._raise_next_tick)
dbt.exceptions.RuntimeException: Runtime Error
  Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
    002003 (02000): SQL compilation error:
    Database 'ZOHO_OA_EDW' does not exist or not authorized.

2020-05-22 07:09:55.104115 (MainThread): unclosed running multiprocessing pool <multiprocessing.pool.ThreadPool state=RUN pool_size=1>
2020-05-22 07:10:12.370547 (MainThread): Running with dbt=0.16.1
2020-05-22 07:10:12.643642 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:10:13.100805 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 07:10:13.104798 (MainThread): Tracking: tracking
2020-05-22 07:10:13.104798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF7BB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E829028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E829058>]}
2020-05-22 07:10:13.138941 (MainThread): Partial parsing not enabled
2020-05-22 07:10:13.142941 (MainThread): Parsing macros\core.sql
2020-05-22 07:10:13.150948 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:10:13.252558 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:10:13.275526 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:10:13.275526 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:10:13.279578 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:10:13.284975 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:10:13.285972 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:10:13.293141 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:10:13.295216 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:10:13.314854 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:10:13.347901 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:10:13.357148 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:10:13.372604 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:10:13.427694 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:10:13.511877 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:10:13.514881 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:10:13.549906 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:10:13.570100 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:10:13.580870 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:10:13.593123 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:10:13.597172 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:10:13.599234 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:10:13.599234 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:10:13.605402 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:10:13.652929 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:10:13.653928 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:10:13.673546 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:10:13.677601 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:10:13.686702 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:10:13.725440 (MainThread): Partial parsing not enabled
2020-05-22 07:10:13.781522 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:13.781522 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:10:14.010950 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.vbi_zoho_people.example

2020-05-22 07:10:14.084353 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 0 sources
2020-05-22 07:10:14.086260 (MainThread): 
2020-05-22 07:10:14.087255 (MainThread): 12:40:14 | Concurrency: 1 threads (target='dev')
2020-05-22 07:10:14.088253 (MainThread): 12:40:14 | 
2020-05-22 07:10:14.092347 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:10:14.093349 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:14.093349 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:10:14.093349 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:10:14.123495 (Thread-1): On "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 07:10:14.323478 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:14.323478 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 07:10:15.811040 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 07:10:17.164756 (Thread-1): SQL status: SUCCESS 1 in 2.84 seconds
2020-05-22 07:10:17.164756 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:17.164756 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 07:10:17.780435 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:10:17.780435 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: ROLLBACK
2020-05-22 07:10:17.780435 (Thread-1): initiating rollback
2020-05-22 07:10:18.375602 (Thread-1): Error running SQL: macro list_relations_without_caching
2020-05-22 07:10:18.375602 (Thread-1): Rolling back transaction.
2020-05-22 07:10:18.384566 (Thread-1): finished collecting timing info
2020-05-22 07:10:18.386179 (Thread-1): Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (02000): SQL compilation error:
  Database 'ZOHO_OA_EDW' does not exist or not authorized.
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database 'ZOHO_OA_EDW' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 160, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 335, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\compilation.py", line 250, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\compilation.py", line 154, in compile_node
    compiled_node.compiled_sql = dbt.clients.jinja.get_rendered(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 415, in get_rendered
    return render_template(template, ctx, node)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 409, in render_template
    return template.render(ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 26, in top-level template code
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 5, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 685, in get_relation
    relations_list = self.list_relations(database, schema)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 636, in list_relations
    relations = self.list_relations_without_caching(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\impl.py", line 202, in list_relations_without_caching
    results = self.execute_macro(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 952, in execute_macro
    result = macro_function(**kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 214, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 23, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 9, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (02000): SQL compilation error:
  Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:10:18.412564 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:10:18.414011 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-22 07:10:18.414011 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 07:10:18.415040 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 07:10:19.831337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E900A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E900AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E961580>]}
2020-05-22 07:10:19.831337 (MainThread): Flushing usage events
2020-05-22 07:10:22.902933 (MainThread): Encountered an error:
2020-05-22 07:10:22.905478 (MainThread): Runtime Error
  Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
    002003 (02000): SQL compilation error:
    Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:10:22.943189 (MainThread): Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 371, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 332, in execute_with_hooks
    res = self.execute_nodes()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 271, in execute_nodes
    self.run_queue(pool)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 231, in run_queue
    self._raise_set_error()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 194, in _raise_set_error
    raise RuntimeException(self._raise_next_tick)
dbt.exceptions.RuntimeException: Runtime Error
  Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
    002003 (02000): SQL compilation error:
    Database 'ZOHO_OA_EDW' does not exist or not authorized.

2020-05-22 07:10:22.944146 (MainThread): unclosed running multiprocessing pool <multiprocessing.pool.ThreadPool state=RUN pool_size=1>
2020-05-22 07:10:49.980735 (MainThread): Running with dbt=0.16.1
2020-05-22 07:10:50.276796 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:10:50.692705 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 07:10:50.696701 (MainThread): Tracking: tracking
2020-05-22 07:10:50.696701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E05BB98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8F9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8F90A0>]}
2020-05-22 07:10:50.723012 (MainThread): Partial parsing not enabled
2020-05-22 07:10:50.731042 (MainThread): Parsing macros\core.sql
2020-05-22 07:10:50.739087 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:10:50.815216 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:10:50.828319 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:10:50.832346 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:10:50.832346 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:10:50.836348 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:10:50.838532 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:10:50.842559 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:10:50.842559 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:10:50.854609 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:10:50.876948 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:10:50.876948 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:10:50.889166 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:10:50.921262 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:10:50.967290 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:10:50.970062 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:10:50.994583 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:10:51.003798 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:10:51.012828 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:10:51.023026 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:10:51.027054 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:10:51.027054 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:10:51.031052 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:10:51.031052 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:10:51.060267 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:10:51.064294 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:10:51.080339 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:10:51.080339 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:10:51.088385 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:10:51.118266 (MainThread): Partial parsing not enabled
2020-05-22 07:10:51.164633 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:51.164633 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:10:51.411763 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 0 sources
2020-05-22 07:10:51.412761 (MainThread): 
2020-05-22 07:10:51.412761 (MainThread): 12:40:51 | Concurrency: 1 threads (target='dev')
2020-05-22 07:10:51.413933 (MainThread): 12:40:51 | 
2020-05-22 07:10:51.417758 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:10:51.418698 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:51.418698 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:10:51.418698 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:10:51.446345 (Thread-1): On "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 07:10:51.597431 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:51.597431 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 07:10:53.183315 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 07:10:54.621218 (Thread-1): SQL status: SUCCESS 1 in 3.02 seconds
2020-05-22 07:10:54.621218 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:10:54.621218 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 07:10:55.187433 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:10:55.187433 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: ROLLBACK
2020-05-22 07:10:55.187433 (Thread-1): initiating rollback
2020-05-22 07:10:55.872280 (Thread-1): Error running SQL: macro list_relations_without_caching
2020-05-22 07:10:55.872280 (Thread-1): Rolling back transaction.
2020-05-22 07:10:55.880379 (Thread-1): finished collecting timing info
2020-05-22 07:10:55.884378 (Thread-1): Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (02000): SQL compilation error:
  Database 'ZOHO_OA_EDW' does not exist or not authorized.
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database 'ZOHO_OA_EDW' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 160, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 335, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\compilation.py", line 250, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\compilation.py", line 154, in compile_node
    compiled_node.compiled_sql = dbt.clients.jinja.get_rendered(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 415, in get_rendered
    return render_template(template, ctx, node)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 409, in render_template
    return template.render(ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 26, in top-level template code
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 5, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 685, in get_relation
    relations_list = self.list_relations(database, schema)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 636, in list_relations
    relations = self.list_relations_without_caching(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\impl.py", line 202, in list_relations_without_caching
    results = self.execute_macro(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 952, in execute_macro
    result = macro_function(**kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 214, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 23, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 9, in template
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (02000): SQL compilation error:
  Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:10:55.908378 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:10:55.908378 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-22 07:10:55.912335 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 07:10:55.912335 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 07:10:56.874999 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9CEAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9CEB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA317D8>]}
2020-05-22 07:10:56.874999 (MainThread): Flushing usage events
2020-05-22 07:10:59.409647 (MainThread): Encountered an error:
2020-05-22 07:10:59.412455 (MainThread): Runtime Error
  Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
    002003 (02000): SQL compilation error:
    Database 'ZOHO_OA_EDW' does not exist or not authorized.
2020-05-22 07:10:59.414493 (MainThread): Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 371, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 332, in execute_with_hooks
    res = self.execute_nodes()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 271, in execute_nodes
    self.run_queue(pool)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 231, in run_queue
    self._raise_set_error()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 194, in _raise_set_error
    raise RuntimeException(self._raise_next_tick)
dbt.exceptions.RuntimeException: Runtime Error
  Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
    002003 (02000): SQL compilation error:
    Database 'ZOHO_OA_EDW' does not exist or not authorized.

2020-05-22 07:10:59.414493 (MainThread): unclosed running multiprocessing pool <multiprocessing.pool.ThreadPool state=RUN pool_size=1>
2020-05-22 07:11:57.770767 (MainThread): Running with dbt=0.16.1
2020-05-22 07:11:57.990878 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:11:58.411867 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 07:11:58.413254 (MainThread): Tracking: tracking
2020-05-22 07:11:58.413803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DC8BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5390B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5390E8>]}
2020-05-22 07:11:58.464961 (MainThread): Partial parsing not enabled
2020-05-22 07:11:58.472985 (MainThread): Parsing macros\core.sql
2020-05-22 07:11:58.481366 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:11:58.546925 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:11:58.561632 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:11:58.561632 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:11:58.565638 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:11:58.569640 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:11:58.569640 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:11:58.575936 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:11:58.576976 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:11:58.589215 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:11:58.609619 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:11:58.613578 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:11:58.627911 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:11:58.676776 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:11:58.740775 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:11:58.744775 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:11:58.767661 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:11:58.775661 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:11:58.783661 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:11:58.791661 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:11:58.795661 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:11:58.799661 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:11:58.799661 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:11:58.803661 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:11:58.827661 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:11:58.831662 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:11:58.843661 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:11:58.847661 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:11:58.851661 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:11:58.879661 (MainThread): Partial parsing not enabled
2020-05-22 07:11:58.920933 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:11:58.920933 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:11:59.222491 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 0 sources
2020-05-22 07:11:59.225305 (MainThread): 
2020-05-22 07:11:59.225305 (MainThread): 12:41:59 | Concurrency: 1 threads (target='dev')
2020-05-22 07:11:59.226382 (MainThread): 12:41:59 | 
2020-05-22 07:11:59.232245 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:11:59.232245 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:11:59.233441 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:11:59.233441 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:11:59.273289 (Thread-1): On "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 07:11:59.458097 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:11:59.458097 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 07:12:01.269209 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 07:12:02.620995 (Thread-1): SQL status: SUCCESS 1 in 3.16 seconds
2020-05-22 07:12:02.620995 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:12:02.625065 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 07:12:04.293945 (Thread-1): SQL status: SUCCESS 0 in 1.67 seconds
2020-05-22 07:12:04.298020 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[]
2020-05-22 07:12:04.302020 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 07:12:04.309628 (Thread-1): finished collecting timing info
2020-05-22 07:12:04.310815 (Thread-1): finished collecting timing info
2020-05-22 07:12:04.311856 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: ROLLBACK
2020-05-22 07:12:04.311856 (Thread-1): initiating rollback
2020-05-22 07:12:05.097316 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:12:05.102588 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-22 07:12:05.103621 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 07:12:05.103621 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 07:12:06.234096 (MainThread): 12:42:06 | Done.
2020-05-22 07:12:06.234549 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E60A508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E670280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6704F0>]}
2020-05-22 07:12:06.236114 (MainThread): Flushing usage events
2020-05-22 07:12:27.717503 (MainThread): Running with dbt=0.16.1
2020-05-22 07:12:27.987061 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:12:28.402384 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_REPORTING_CHANGES_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-22 07:12:28.406384 (MainThread): Tracking: tracking
2020-05-22 07:12:28.406384 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1AC850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA59340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA590B8>]}
2020-05-22 07:12:28.438404 (MainThread): Partial parsing not enabled
2020-05-22 07:12:28.446487 (MainThread): Parsing macros\core.sql
2020-05-22 07:12:28.454688 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:12:28.545724 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:12:28.561730 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:12:28.561730 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:12:28.565789 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:12:28.569737 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:12:28.573737 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:12:28.573737 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:12:28.577792 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:12:28.589817 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:12:28.617762 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:12:28.621762 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:12:28.633768 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:12:28.680877 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:12:28.746106 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:12:28.750106 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:12:28.782124 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:12:28.798130 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:12:28.806137 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:12:28.818143 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:12:28.822143 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:12:28.826201 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:12:28.826201 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:12:28.830150 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:12:28.863497 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:12:28.867436 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:12:28.886386 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:12:28.889434 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:12:28.898444 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:12:28.940443 (MainThread): Partial parsing not enabled
2020-05-22 07:12:29.013828 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:12:29.013828 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:12:29.255234 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 0 sources
2020-05-22 07:12:29.256334 (MainThread): 
2020-05-22 07:12:29.257332 (MainThread): Acquiring new snowflake connection "master".
2020-05-22 07:12:29.257332 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:12:29.266806 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 07:12:29.267762 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-22 07:12:29.457612 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 07:12:29.457612 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-22 07:12:31.212143 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 07:12:32.390063 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.93 seconds
2020-05-22 07:12:32.472963 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 07:12:32.473777 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-22 07:12:32.481145 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 07:12:32.481145 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-22 07:12:35.409758 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.93 seconds
2020-05-22 07:12:35.410751 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 07:12:35.410751 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 07:12:37.455636 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 2.04 seconds
2020-05-22 07:12:37.460903 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-22 07:12:37.460903 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-22 07:12:38.014648 (MainThread): Using snowflake connection "master".
2020-05-22 07:12:38.015688 (MainThread): On master: BEGIN
2020-05-22 07:12:41.049563 (MainThread): SQL status: SUCCESS 1 in 3.03 seconds
2020-05-22 07:12:41.051892 (MainThread): On master: COMMIT
2020-05-22 07:12:41.051892 (MainThread): Using snowflake connection "master".
2020-05-22 07:12:41.053208 (MainThread): On master: COMMIT
2020-05-22 07:12:41.762400 (MainThread): SQL status: SUCCESS 1 in 0.71 seconds
2020-05-22 07:12:41.763422 (MainThread): 12:42:41 | Concurrency: 1 threads (target='dev')
2020-05-22 07:12:41.765697 (MainThread): 12:42:41 | 
2020-05-22 07:12:41.806919 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:12:41.807829 (Thread-1): 12:42:41 | 1 of 1 START incremental model ANALYTICS.TB_REPORTING_CHANGES_VIEW... [RUN]
2020-05-22 07:12:41.810966 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:12:41.811982 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:12:41.812517 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:12:41.902773 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 07:12:41.906207 (Thread-1): finished collecting timing info
2020-05-22 07:12:42.055227 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 07:12:42.059928 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:12:42.059928 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 07:12:45.444279 (Thread-1): SQL status: SUCCESS 1 in 3.38 seconds
2020-05-22 07:12:45.444279 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:12:45.444279 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_REPORTING_CHANGES_VIEW  as
      (

select 
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Comments"::String as COMMENTS,
    SRC:"New People Manager"::String as NEW_PEOPLE_MANAGER,
    SRC:"Added By"::String as ADDED_BY,
    SRC:"ownerID"::String as OWNER_ID,
    SRC:"ApprovalStatus"::String as APPROVAL_STATUS,
    SRC:"Effective"::Date as EFFECTIVE,
    SRC:"recordId"::String as RECORDID,
    SRC:"Modified By"::String as MODIFIED_BY,
    SRC:"Current People Manager"::String as CURRENT_PEOPLE_MANAGER,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"createdTime"::String as CREATED_TIME_INT    
    
from TB_HIST_REPORTING_CHANGES_VIEW 


      );
2020-05-22 07:12:45.946842 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TB_HIST_REPORTING_CHANGES_VIEW' does not exist or not authorized.
2020-05-22 07:12:45.946842 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: ROLLBACK
2020-05-22 07:12:45.946842 (Thread-1): initiating rollback
2020-05-22 07:12:46.673130 (Thread-1): finished collecting timing info
2020-05-22 07:12:46.677901 (Thread-1): Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (42S02): SQL compilation error:
  Object 'TB_HIST_REPORTING_CHANGES_VIEW' does not exist or not authorized.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_REPORTING_CHANGES_VIEW.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'TB_HIST_REPORTING_CHANGES_VIEW' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
  002003 (42S02): SQL compilation error:
  Object 'TB_HIST_REPORTING_CHANGES_VIEW' does not exist or not authorized.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_REPORTING_CHANGES_VIEW.sql
2020-05-22 07:12:46.705907 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59138c7-c581-4294-bde4-c8c11f0e7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFE5C58>]}
2020-05-22 07:12:46.705907 (Thread-1): 12:42:46 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_REPORTING_CHANGES_VIEW [ERROR in 4.90s]
2020-05-22 07:12:46.712817 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:12:46.718142 (MainThread): Using snowflake connection "master".
2020-05-22 07:12:46.719204 (MainThread): On master: BEGIN
2020-05-22 07:12:47.172349 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2020-05-22 07:12:47.172349 (MainThread): On master: COMMIT
2020-05-22 07:12:47.172349 (MainThread): Using snowflake connection "master".
2020-05-22 07:12:47.172349 (MainThread): On master: COMMIT
2020-05-22 07:12:47.904148 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2020-05-22 07:12:47.904148 (MainThread): 12:42:47 | 
2020-05-22 07:12:47.909620 (MainThread): 12:42:47 | Finished running 1 incremental model in 18.65s.
2020-05-22 07:12:47.911836 (MainThread): Connection 'master' was left open.
2020-05-22 07:12:47.912841 (MainThread): On master: Close
2020-05-22 07:12:48.636344 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-22 07:12:48.641225 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-22 07:12:49.543341 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-22 07:12:49.547609 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-22 07:12:50.360785 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 07:12:50.360785 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 07:12:51.075504 (MainThread): 
2020-05-22 07:12:51.077217 (MainThread): Completed with 1 error and 0 warnings:
2020-05-22 07:12:51.110266 (MainThread): 
2020-05-22 07:12:51.112780 (MainThread): Database Error in model TB_REPORTING_CHANGES_VIEW (models\analytics\TB_REPORTING_CHANGES_VIEW.sql)
2020-05-22 07:12:51.116085 (MainThread):   002003 (42S02): SQL compilation error:
2020-05-22 07:12:51.118217 (MainThread):   Object 'TB_HIST_REPORTING_CHANGES_VIEW' does not exist or not authorized.
2020-05-22 07:12:51.120972 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_REPORTING_CHANGES_VIEW.sql
2020-05-22 07:12:51.123417 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-22 07:12:51.183812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFE5E98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFE5FE8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFE5F10>]}
2020-05-22 07:12:51.185872 (MainThread): Flushing usage events
2020-05-22 07:29:27.098407 (MainThread): Running with dbt=0.16.1
2020-05-22 07:29:27.351835 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:29:27.736360 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 07:29:27.736360 (MainThread): Tracking: tracking
2020-05-22 07:29:27.736360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DD6BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E619028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E619088>]}
2020-05-22 07:29:27.770599 (MainThread): Partial parsing not enabled
2020-05-22 07:29:27.774661 (MainThread): Parsing macros\core.sql
2020-05-22 07:29:27.780753 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:29:27.852663 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:29:27.868736 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:29:27.868736 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:29:27.872742 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:29:27.876735 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:29:27.876735 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:29:27.880826 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:29:27.884779 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:29:27.896825 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:29:27.916931 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:29:27.920913 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:29:27.931049 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:29:27.965440 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:29:28.014185 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:29:28.018282 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:29:28.044424 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:29:28.056474 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:29:28.064563 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:29:28.074737 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:29:28.078684 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:29:28.078684 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:29:28.082684 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:29:28.082684 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:29:28.112974 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:29:28.116976 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:29:28.129018 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:29:28.133104 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:29:28.137065 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:29:28.167354 (MainThread): Partial parsing not enabled
2020-05-22 07:29:28.217647 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:29:28.217647 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:29:28.253784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E674868>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E717F58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E717280>]}
2020-05-22 07:29:28.253784 (MainThread): Flushing usage events
2020-05-22 07:29:31.206051 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-22 07:29:31.207046 (MainThread): Encountered an error:
2020-05-22 07:29:31.208639 (MainThread): Compilation Error
  The schema file at source.yml is invalid because no version is specified. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files
2020-05-22 07:29:31.297197 (MainThread): Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 336, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 208, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 182, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 138, in parse_with_cache
    parser.parse_file(block)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\schemas.py", line 289, in parse_file
    self._parse_format_version(yaml_block)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\schemas.py", line 142, in _parse_format_version
    raise_invalid_schema_yml_version(path, 'no version is specified')
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\exceptions.py", line 760, in raise_invalid_schema_yml_version
    raise_compiler_error(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at source.yml is invalid because no version is specified. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files

2020-05-22 07:31:25.146654 (MainThread): Running with dbt=0.16.1
2020-05-22 07:31:25.420303 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:31:25.805833 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 07:31:25.805833 (MainThread): Tracking: tracking
2020-05-22 07:31:25.805833 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DB4BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E409070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4090D0>]}
2020-05-22 07:31:25.836925 (MainThread): Partial parsing not enabled
2020-05-22 07:31:25.840952 (MainThread): Parsing macros\core.sql
2020-05-22 07:31:25.851182 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:31:25.922177 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:31:25.969400 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:31:25.973400 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:31:25.977402 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:31:25.985400 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:31:25.993400 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:31:26.001401 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:31:26.005407 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:31:26.033399 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:31:26.064987 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:31:26.068989 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:31:26.076992 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:31:26.108992 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:31:26.159321 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:31:26.159321 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:31:26.187356 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:31:26.199406 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:31:26.207424 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:31:26.215456 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:31:26.219545 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:31:26.219545 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:31:26.223505 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:31:26.227506 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:31:26.253790 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:31:26.257823 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:31:26.272048 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:31:26.276075 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:31:26.280101 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:31:26.311608 (MainThread): Partial parsing not enabled
2020-05-22 07:31:26.357984 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:31:26.357984 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:31:26.703692 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 1 source
2020-05-22 07:31:26.705686 (MainThread): 
2020-05-22 07:31:26.706578 (MainThread): 13:01:26 | Concurrency: 1 threads (target='dev')
2020-05-22 07:31:26.715353 (MainThread): 13:01:26 | 
2020-05-22 07:31:26.720943 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:31:26.721975 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:31:26.721975 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:31:26.721975 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:31:26.761535 (Thread-1): On "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 07:31:26.997716 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:31:26.997716 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 07:31:29.048279 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 07:31:30.551750 (Thread-1): SQL status: SUCCESS 1 in 3.55 seconds
2020-05-22 07:31:30.551750 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:31:30.555820 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 07:31:32.883652 (Thread-1): SQL status: SUCCESS 0 in 2.33 seconds
2020-05-22 07:31:32.887750 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[]
2020-05-22 07:31:32.891768 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 07:31:32.897844 (Thread-1): finished collecting timing info
2020-05-22 07:31:32.898883 (Thread-1): finished collecting timing info
2020-05-22 07:31:32.898883 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: ROLLBACK
2020-05-22 07:31:32.898883 (Thread-1): initiating rollback
2020-05-22 07:31:33.603949 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:31:33.606898 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-22 07:31:33.607948 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 07:31:33.608894 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 07:31:34.348616 (MainThread): 13:01:34 | Done.
2020-05-22 07:31:34.351288 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4D7B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E530C28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E530B50>]}
2020-05-22 07:31:34.352282 (MainThread): Flushing usage events
2020-05-22 07:32:08.810658 (MainThread): Running with dbt=0.16.1
2020-05-22 07:32:09.083922 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 07:32:09.468936 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_REPORTING_CHANGES_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-22 07:32:09.471188 (MainThread): Tracking: tracking
2020-05-22 07:32:09.471188 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE9BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E74A448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E74A1A8>]}
2020-05-22 07:32:09.499230 (MainThread): Partial parsing not enabled
2020-05-22 07:32:09.507337 (MainThread): Parsing macros\core.sql
2020-05-22 07:32:09.515275 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 07:32:09.585040 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 07:32:09.597091 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 07:32:09.601181 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 07:32:09.601181 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 07:32:09.605127 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 07:32:09.609128 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 07:32:09.611429 (MainThread): Parsing macros\etc\query.sql
2020-05-22 07:32:09.615373 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 07:32:09.627417 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 07:32:09.650131 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 07:32:09.654137 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 07:32:09.664274 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 07:32:09.698544 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 07:32:09.748882 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 07:32:09.752972 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 07:32:09.779268 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 07:32:09.791313 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 07:32:09.799414 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 07:32:09.807364 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 07:32:09.811417 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 07:32:09.811417 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 07:32:09.815406 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 07:32:09.819404 (MainThread): Parsing macros\adapters.sql
2020-05-22 07:32:09.845793 (MainThread): Parsing macros\catalog.sql
2020-05-22 07:32:09.849745 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 07:32:09.865799 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 07:32:09.869803 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 07:32:09.873833 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 07:32:09.904261 (MainThread): Partial parsing not enabled
2020-05-22 07:32:09.953570 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:32:09.953570 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:32:10.246016 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 1 source
2020-05-22 07:32:10.248050 (MainThread): 
2020-05-22 07:32:10.249117 (MainThread): Acquiring new snowflake connection "master".
2020-05-22 07:32:10.249117 (MainThread): Opening a new connection, currently in state init
2020-05-22 07:32:10.259764 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 07:32:10.259764 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-22 07:32:10.432899 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 07:32:10.432899 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-22 07:32:12.636843 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 07:32:14.152021 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.72 seconds
2020-05-22 07:32:14.194970 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 07:32:14.196382 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-22 07:32:14.205602 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 07:32:14.205602 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-22 07:32:17.121548 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=1228, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.43.142', 60952), raddr=('52.184.166.117', 443)>
2020-05-22 07:32:19.514038 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 5.31 seconds
2020-05-22 07:32:19.514038 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 07:32:19.514038 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 07:32:21.012320 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.50 seconds
2020-05-22 07:32:21.016493 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-22 07:32:21.016493 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-22 07:32:21.600310 (MainThread): Using snowflake connection "master".
2020-05-22 07:32:21.600310 (MainThread): On master: BEGIN
2020-05-22 07:32:24.639771 (MainThread): SQL status: SUCCESS 1 in 3.04 seconds
2020-05-22 07:32:24.639771 (MainThread): On master: COMMIT
2020-05-22 07:32:24.639771 (MainThread): Using snowflake connection "master".
2020-05-22 07:32:24.643853 (MainThread): On master: COMMIT
2020-05-22 07:32:25.289093 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2020-05-22 07:32:25.289093 (MainThread): 13:02:25 | Concurrency: 1 threads (target='dev')
2020-05-22 07:32:25.294412 (MainThread): 13:02:25 | 
2020-05-22 07:32:25.330446 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:32:25.331332 (Thread-1): 13:02:25 | 1 of 1 START incremental model ANALYTICS.TB_REPORTING_CHANGES_VIEW... [RUN]
2020-05-22 07:32:25.333477 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:32:25.334504 (Thread-1): Opening a new connection, currently in state init
2020-05-22 07:32:25.335517 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:32:25.428393 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 07:32:25.430931 (Thread-1): finished collecting timing info
2020-05-22 07:32:25.501424 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 07:32:25.505982 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:32:25.505982 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 07:32:28.998773 (Thread-1): SQL status: SUCCESS 1 in 3.49 seconds
2020-05-22 07:32:28.998773 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:32:28.998773 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_REPORTING_CHANGES_VIEW  as
      (

select 
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Comments"::String as COMMENTS,
    SRC:"New People Manager"::String as NEW_PEOPLE_MANAGER,
    SRC:"Added By"::String as ADDED_BY,
    SRC:"ownerID"::String as OWNER_ID,
    SRC:"ApprovalStatus"::String as APPROVAL_STATUS,
    SRC:"Effective"::Date as EFFECTIVE,
    SRC:"recordId"::String as RECORDID,
    SRC:"Modified By"::String as MODIFIED_BY,
    SRC:"Current People Manager"::String as CURRENT_PEOPLE_MANAGER,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"createdTime"::String as CREATED_TIME_INT    
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_REPORTING_CHANGES_VIEW


      );
2020-05-22 07:32:32.685636 (Thread-1): SQL status: SUCCESS 1 in 3.69 seconds
2020-05-22 07:32:32.689799 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: COMMIT
2020-05-22 07:32:32.689799 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 07:32:32.689799 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: COMMIT
2020-05-22 07:32:33.300324 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-22 07:32:33.308504 (Thread-1): finished collecting timing info
2020-05-22 07:32:33.312490 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0575c788-a489-40d6-a338-4a02ae518cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E898E68>]}
2020-05-22 07:32:33.312490 (Thread-1): 13:02:33 | 1 of 1 OK created incremental model ANALYTICS.TB_REPORTING_CHANGES_VIEW [SUCCESS 1 in 7.98s]
2020-05-22 07:32:33.317681 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 07:32:33.322224 (MainThread): Using snowflake connection "master".
2020-05-22 07:32:33.322224 (MainThread): On master: BEGIN
2020-05-22 07:32:34.119565 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2020-05-22 07:32:34.119565 (MainThread): On master: COMMIT
2020-05-22 07:32:34.119565 (MainThread): Using snowflake connection "master".
2020-05-22 07:32:34.119565 (MainThread): On master: COMMIT
2020-05-22 07:32:34.938172 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2020-05-22 07:32:34.942257 (MainThread): 13:02:34 | 
2020-05-22 07:32:34.943332 (MainThread): 13:02:34 | Finished running 1 incremental model in 24.69s.
2020-05-22 07:32:34.968207 (MainThread): Connection 'master' was left open.
2020-05-22 07:32:34.969204 (MainThread): On master: Close
2020-05-22 07:32:35.919700 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-22 07:32:35.919700 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-22 07:32:36.784982 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-22 07:32:36.784982 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-22 07:32:37.810194 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 07:32:37.810194 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 07:32:38.851272 (MainThread): 
2020-05-22 07:32:38.853267 (MainThread): Completed successfully
2020-05-22 07:32:38.856636 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-22 07:32:38.858628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E86F148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC47F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E88BE68>]}
2020-05-22 07:32:38.859625 (MainThread): Flushing usage events
2020-05-22 09:17:11.911390 (MainThread): Running with dbt=0.16.1
2020-05-22 09:17:12.245287 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 09:17:12.661211 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 09:17:12.661211 (MainThread): Tracking: tracking
2020-05-22 09:17:12.661211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DB5BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E409358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E409058>]}
2020-05-22 09:17:12.696328 (MainThread): Partial parsing not enabled
2020-05-22 09:17:12.700256 (MainThread): Parsing macros\core.sql
2020-05-22 09:17:12.712264 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 09:17:12.797635 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 09:17:12.813701 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 09:17:12.817649 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 09:17:12.817649 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 09:17:12.821649 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 09:17:12.825701 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 09:17:12.829655 (MainThread): Parsing macros\etc\query.sql
2020-05-22 09:17:12.829655 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 09:17:12.847824 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 09:17:12.871843 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 09:17:12.875774 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 09:17:12.891780 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 09:17:12.936566 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 09:17:13.010836 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 09:17:13.014788 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 09:17:13.046862 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 09:17:13.058876 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 09:17:13.069002 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 09:17:13.081020 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 09:17:13.084963 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 09:17:13.088963 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 09:17:13.088963 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 09:17:13.093038 (MainThread): Parsing macros\adapters.sql
2020-05-22 09:17:13.126130 (MainThread): Parsing macros\catalog.sql
2020-05-22 09:17:13.130199 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 09:17:13.150229 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 09:17:13.153224 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 09:17:13.157226 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 09:17:13.196336 (MainThread): Partial parsing not enabled
2020-05-22 09:17:13.255745 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:17:13.255745 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:17:13.294091 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:17:13.294091 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:17:13.634142 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 2 sources
2020-05-22 09:17:13.638903 (MainThread): 
2020-05-22 09:17:13.642969 (MainThread): 14:47:13 | Concurrency: 1 threads (target='dev')
2020-05-22 09:17:13.643926 (MainThread): 14:47:13 | 
2020-05-22 09:17:13.654876 (Thread-1): Began running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 09:17:13.655921 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:17:13.655921 (Thread-1): Opening a new connection, currently in state init
2020-05-22 09:17:13.655921 (Thread-1): Compiling model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 09:17:13.725052 (Thread-1): On "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 09:17:13.900101 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:17:13.900101 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: BEGIN
2020-05-22 09:17:15.456750 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 09:17:17.064798 (Thread-1): SQL status: SUCCESS 1 in 3.16 seconds
2020-05-22 09:17:17.064798 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:17:17.068831 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 09:17:18.254911 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2020-05-22 09:17:18.277501 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES_VIEW">]
2020-05-22 09:17:18.285501 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"
2020-05-22 09:17:18.288932 (Thread-1): finished collecting timing info
2020-05-22 09:17:18.288932 (Thread-1): finished collecting timing info
2020-05-22 09:17:18.288932 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: ROLLBACK
2020-05-22 09:17:18.288932 (Thread-1): initiating rollback
2020-05-22 09:17:18.911541 (Thread-1): Finished running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 09:17:18.912538 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 09:17:18.914992 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:17:18.914992 (Thread-1): Re-using an available connection from the pool (formerly model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW).
2020-05-22 09:17:18.914992 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 09:17:18.947063 (Thread-1): On "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 09:17:18.967062 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:17:18.967062 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 09:17:20.138118 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2020-05-22 09:17:20.138118 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:17:20.138118 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 09:17:21.979760 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2020-05-22 09:17:21.987751 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES_VIEW">]
2020-05-22 09:17:21.991749 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 09:17:21.998294 (Thread-1): finished collecting timing info
2020-05-22 09:17:21.998811 (Thread-1): finished collecting timing info
2020-05-22 09:17:21.999850 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: ROLLBACK
2020-05-22 09:17:21.999850 (Thread-1): initiating rollback
2020-05-22 09:17:22.803133 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 09:17:22.804113 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-22 09:17:22.804113 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 09:17:22.805130 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 09:17:23.838810 (MainThread): 14:47:23 | Done.
2020-05-22 09:17:23.838810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E462370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F091E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F091070>]}
2020-05-22 09:17:23.840104 (MainThread): Flushing usage events
2020-05-22 09:19:12.686045 (MainThread): Running with dbt=0.16.1
2020-05-22 09:19:12.951657 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 09:19:13.325128 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_REPORTING_CHANGES_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-22 09:19:13.329123 (MainThread): Tracking: tracking
2020-05-22 09:19:13.329123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D69BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF49400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF49190>]}
2020-05-22 09:19:13.359382 (MainThread): Partial parsing not enabled
2020-05-22 09:19:13.363380 (MainThread): Parsing macros\core.sql
2020-05-22 09:19:13.372677 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 09:19:13.438016 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 09:19:13.454099 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 09:19:13.454099 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 09:19:13.454099 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 09:19:13.458093 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 09:19:13.462113 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 09:19:13.466101 (MainThread): Parsing macros\etc\query.sql
2020-05-22 09:19:13.466101 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 09:19:13.481305 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 09:19:13.499685 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 09:19:13.505869 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 09:19:13.513898 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 09:19:13.550250 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 09:19:13.598681 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 09:19:13.602709 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 09:19:13.628969 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 09:19:13.641012 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 09:19:13.649054 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 09:19:13.659276 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 09:19:13.663277 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 09:19:13.663277 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 09:19:13.667297 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 09:19:13.671321 (MainThread): Parsing macros\adapters.sql
2020-05-22 09:19:13.699402 (MainThread): Parsing macros\catalog.sql
2020-05-22 09:19:13.699402 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 09:19:13.715516 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 09:19:13.719491 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 09:19:13.723489 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 09:19:13.753812 (MainThread): Partial parsing not enabled
2020-05-22 09:19:13.804173 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:19:13.804173 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:19:13.836297 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:13.836297 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:19:14.260325 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 2 sources
2020-05-22 09:19:14.263383 (MainThread): 
2020-05-22 09:19:14.263383 (MainThread): Acquiring new snowflake connection "master".
2020-05-22 09:19:14.263383 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:19:14.281836 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 09:19:14.281836 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-22 09:19:14.511176 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 09:19:14.511274 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-22 09:19:16.984873 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 09:19:18.540734 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.03 seconds
2020-05-22 09:19:18.595091 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 09:19:18.597128 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-22 09:19:18.606349 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 09:19:18.606349 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-22 09:19:21.995837 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.39 seconds
2020-05-22 09:19:21.995837 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 09:19:21.995837 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 09:19:23.429541 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.43 seconds
2020-05-22 09:19:23.435140 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-22 09:19:23.435140 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-22 09:19:24.062874 (MainThread): Using snowflake connection "master".
2020-05-22 09:19:24.063875 (MainThread): On master: BEGIN
2020-05-22 09:19:27.015007 (MainThread): SQL status: SUCCESS 1 in 2.95 seconds
2020-05-22 09:19:27.016182 (MainThread): On master: COMMIT
2020-05-22 09:19:27.017271 (MainThread): Using snowflake connection "master".
2020-05-22 09:19:27.017271 (MainThread): On master: COMMIT
2020-05-22 09:19:27.600651 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2020-05-22 09:19:27.600651 (MainThread): 14:49:27 | Concurrency: 1 threads (target='dev')
2020-05-22 09:19:27.604949 (MainThread): 14:49:27 | 
2020-05-22 09:19:27.615137 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 09:19:27.615473 (Thread-1): 14:49:27 | 1 of 1 START incremental model ANALYTICS.TB_REPORTING_CHANGES_VIEW... [RUN]
2020-05-22 09:19:27.618665 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:27.618665 (Thread-1): Opening a new connection, currently in state init
2020-05-22 09:19:27.619660 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 09:19:27.707826 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 09:19:27.711586 (Thread-1): finished collecting timing info
2020-05-22 09:19:27.815901 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:27.815901 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */

    

      create or replace temporary table ZOHO_OA_EDW.ANALYTICS.TB_REPORTING_CHANGES_VIEW__dbt_tmp  as
      (

select 
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Comments"::String as COMMENTS,
    SRC:"New People Manager"::String as NEW_PEOPLE_MANAGER,
    SRC:"Added By"::String as ADDED_BY,
    SRC:"ownerID"::String as OWNER_ID,
    SRC:"ApprovalStatus"::String as APPROVAL_STATUS,
    SRC:"Effective"::Date as EFFECTIVE,
    SRC:"recordId"::String as RECORDID,
    SRC:"Modified By"::String as MODIFIED_BY,
    SRC:"Current People Manager"::String as CURRENT_PEOPLE_MANAGER,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"createdTime"::String as CREATED_TIME_INT    
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_REPORTING_CHANGES_VIEW


    where MODIFIED_TIME > ( select max(MODIFIED_TIME) from ZOHO_OA_EDW.ANALYTICS.TB_REPORTING_CHANGES_VIEW )

      );
2020-05-22 09:19:32.236726 (Thread-1): SQL status: SUCCESS 1 in 4.42 seconds
2020-05-22 09:19:32.256813 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:32.256813 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: BEGIN
2020-05-22 09:19:32.849288 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-22 09:19:32.849288 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:32.849288 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_REPORTING_CHANGES_VIEW__dbt_tmp'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-22 09:19:34.693787 (Thread-1): SQL status: SUCCESS 14 in 1.84 seconds
2020-05-22 09:19:34.705967 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:34.705967 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_REPORTING_CHANGES_VIEW'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-22 09:19:35.838287 (Thread-1): SQL status: SUCCESS 14 in 1.13 seconds
2020-05-22 09:19:35.860658 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:35.860658 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_REPORTING_CHANGES_VIEW'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-22 09:19:37.356273 (Thread-1): SQL status: SUCCESS 14 in 1.50 seconds
2020-05-22 09:19:37.464366 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"
2020-05-22 09:19:37.470603 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:37.470603 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW"} */

        
        
    

    merge into ZOHO_OA_EDW.ANALYTICS.TB_REPORTING_CHANGES_VIEW as DBT_INTERNAL_DEST
        using ZOHO_OA_EDW.ANALYTICS.TB_REPORTING_CHANGES_VIEW__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.RECORDID = DBT_INTERNAL_DEST.RECORDID
        

    
    when matched then update set
        "MODIFIED_TIME_INT" = DBT_INTERNAL_SOURCE."MODIFIED_TIME_INT","ASSOCIATE_ID" = DBT_INTERNAL_SOURCE."ASSOCIATE_ID","COMMENTS" = DBT_INTERNAL_SOURCE."COMMENTS","NEW_PEOPLE_MANAGER" = DBT_INTERNAL_SOURCE."NEW_PEOPLE_MANAGER","ADDED_BY" = DBT_INTERNAL_SOURCE."ADDED_BY","OWNER_ID" = DBT_INTERNAL_SOURCE."OWNER_ID","APPROVAL_STATUS" = DBT_INTERNAL_SOURCE."APPROVAL_STATUS","EFFECTIVE" = DBT_INTERNAL_SOURCE."EFFECTIVE","RECORDID" = DBT_INTERNAL_SOURCE."RECORDID","MODIFIED_BY" = DBT_INTERNAL_SOURCE."MODIFIED_BY","CURRENT_PEOPLE_MANAGER" = DBT_INTERNAL_SOURCE."CURRENT_PEOPLE_MANAGER","MODIFIED_TIME" = DBT_INTERNAL_SOURCE."MODIFIED_TIME","OWNER_NAME" = DBT_INTERNAL_SOURCE."OWNER_NAME","CREATED_TIME_INT" = DBT_INTERNAL_SOURCE."CREATED_TIME_INT"
    

    when not matched then insert
        ("MODIFIED_TIME_INT", "ASSOCIATE_ID", "COMMENTS", "NEW_PEOPLE_MANAGER", "ADDED_BY", "OWNER_ID", "APPROVAL_STATUS", "EFFECTIVE", "RECORDID", "MODIFIED_BY", "CURRENT_PEOPLE_MANAGER", "MODIFIED_TIME", "OWNER_NAME", "CREATED_TIME_INT")
    values
        ("MODIFIED_TIME_INT", "ASSOCIATE_ID", "COMMENTS", "NEW_PEOPLE_MANAGER", "ADDED_BY", "OWNER_ID", "APPROVAL_STATUS", "EFFECTIVE", "RECORDID", "MODIFIED_BY", "CURRENT_PEOPLE_MANAGER", "MODIFIED_TIME", "OWNER_NAME", "CREATED_TIME_INT")
2020-05-22 09:19:38.585039 (Thread-1): SQL status: SUCCESS 0 in 1.11 seconds
2020-05-22 09:19:38.589209 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: COMMIT
2020-05-22 09:19:38.589209 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:19:38.589209 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: COMMIT
2020-05-22 09:19:39.241787 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2020-05-22 09:19:39.249786 (Thread-1): finished collecting timing info
2020-05-22 09:19:39.253786 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ded7ba70-6fb1-46a7-9d2b-5e0671ae06a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1373E8>]}
2020-05-22 09:19:39.253786 (Thread-1): 14:49:39 | 1 of 1 OK created incremental model ANALYTICS.TB_REPORTING_CHANGES_VIEW [SUCCESS 0 in 11.64s]
2020-05-22 09:19:39.259192 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW
2020-05-22 09:19:39.263288 (MainThread): Using snowflake connection "master".
2020-05-22 09:19:39.264325 (MainThread): On master: BEGIN
2020-05-22 09:19:39.814055 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2020-05-22 09:19:39.814055 (MainThread): On master: COMMIT
2020-05-22 09:19:39.814055 (MainThread): Using snowflake connection "master".
2020-05-22 09:19:39.814055 (MainThread): On master: COMMIT
2020-05-22 09:19:40.674408 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2020-05-22 09:19:40.680032 (MainThread): 14:49:40 | 
2020-05-22 09:19:40.681069 (MainThread): 14:49:40 | Finished running 1 incremental model in 26.42s.
2020-05-22 09:19:40.682381 (MainThread): Connection 'master' was left open.
2020-05-22 09:19:40.682381 (MainThread): On master: Close
2020-05-22 09:19:41.656542 (MainThread): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.43.142', 51281), raddr=('52.184.166.117', 443)>
2020-05-22 09:19:41.660729 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-22 09:19:41.660729 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-22 09:19:42.682759 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-22 09:19:42.682759 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-22 09:19:43.707789 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was left open.
2020-05-22 09:19:43.707789 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW: Close
2020-05-22 09:19:44.617015 (MainThread): 
2020-05-22 09:19:44.618243 (MainThread): Completed successfully
2020-05-22 09:19:44.621106 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-22 09:19:44.622141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1372F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E137310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E137118>]}
2020-05-22 09:19:44.622141 (MainThread): Flushing usage events
2020-05-22 09:21:51.896392 (MainThread): Running with dbt=0.16.1
2020-05-22 09:21:52.139688 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 09:21:52.495204 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_LEAVE_APPROVER_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-22 09:21:52.495204 (MainThread): Tracking: tracking
2020-05-22 09:21:52.495204 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E2FDA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBA9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBA9178>]}
2020-05-22 09:21:52.521465 (MainThread): Partial parsing not enabled
2020-05-22 09:21:52.529485 (MainThread): Parsing macros\core.sql
2020-05-22 09:21:52.533573 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 09:21:52.595651 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 09:21:52.608976 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 09:21:52.608976 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 09:21:52.608976 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 09:21:52.612980 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 09:21:52.617075 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 09:21:52.621018 (MainThread): Parsing macros\etc\query.sql
2020-05-22 09:21:52.621018 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 09:21:52.633059 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 09:21:52.651307 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 09:21:52.655250 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 09:21:52.663334 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 09:21:52.693505 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 09:21:52.741965 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 09:21:52.741965 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 09:21:52.770001 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 09:21:52.782039 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 09:21:52.790107 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 09:21:52.798085 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 09:21:52.802117 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 09:21:52.802117 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 09:21:52.806130 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 09:21:52.810128 (MainThread): Parsing macros\adapters.sql
2020-05-22 09:21:52.836388 (MainThread): Parsing macros\catalog.sql
2020-05-22 09:21:52.840405 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 09:21:52.852448 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 09:21:52.856711 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 09:21:52.862883 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 09:21:52.892201 (MainThread): Partial parsing not enabled
2020-05-22 09:21:52.933279 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:21:52.933279 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:21:52.963487 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 09:21:52.963487 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:21:53.224855 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 2 sources
2020-05-22 09:21:53.228433 (MainThread): 
2020-05-22 09:21:53.228433 (MainThread): Acquiring new snowflake connection "master".
2020-05-22 09:21:53.228433 (MainThread): Opening a new connection, currently in state init
2020-05-22 09:21:53.244091 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 09:21:53.244601 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-22 09:21:53.449239 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 09:21:53.449239 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-22 09:21:55.438508 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 09:21:56.633514 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.18 seconds
2020-05-22 09:21:56.653583 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 09:21:56.653583 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-22 09:21:56.656910 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 09:21:56.656910 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-22 09:21:58.958614 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.30 seconds
2020-05-22 09:21:58.959105 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 09:21:58.959105 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 09:22:00.013310 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.05 seconds
2020-05-22 09:22:00.021428 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-22 09:22:00.022738 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-22 09:22:00.830473 (MainThread): Using snowflake connection "master".
2020-05-22 09:22:00.830473 (MainThread): On master: BEGIN
2020-05-22 09:22:03.994918 (MainThread): SQL status: SUCCESS 1 in 3.16 seconds
2020-05-22 09:22:03.994918 (MainThread): On master: COMMIT
2020-05-22 09:22:03.994918 (MainThread): Using snowflake connection "master".
2020-05-22 09:22:03.994918 (MainThread): On master: COMMIT
2020-05-22 09:22:04.865877 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2020-05-22 09:22:04.865877 (MainThread): 14:52:04 | Concurrency: 1 threads (target='dev')
2020-05-22 09:22:04.865877 (MainThread): 14:52:04 | 
2020-05-22 09:22:04.881526 (Thread-1): Began running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 09:22:04.882482 (Thread-1): 14:52:04 | 1 of 1 START incremental model ANALYTICS.TB_LEAVE_APPROVER_VIEW...... [RUN]
2020-05-22 09:22:04.918303 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:22:04.919297 (Thread-1): Opening a new connection, currently in state init
2020-05-22 09:22:04.919297 (Thread-1): Compiling model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 09:22:05.017622 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"
2020-05-22 09:22:05.017622 (Thread-1): finished collecting timing info
2020-05-22 09:22:05.136060 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"
2020-05-22 09:22:05.140358 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:22:05.140358 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: BEGIN
2020-05-22 09:22:07.886012 (Thread-1): SQL status: SUCCESS 1 in 2.75 seconds
2020-05-22 09:22:07.887009 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 09:22:07.887009 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_LEAVE_APPROVER_VIEW  as
      (

select 
    SRC:"ApprovalStatus"::String as APPROVAL_STATUS,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Explain Reason for leave"::String as EXPLAIN_REASON_FOR_LEAVE,  
    SRC:"From (mm/dd/yyyy)"::Date as FROM_DATE,  
    SRC:"Leave type"::String as LEAVE_TYPE,
    SRC:"To (mm/dd/yyyy)"::Date as TO_DATE,
    SRC:"createdTime"::String as CREATED_TIME_INT,    
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME
    SRC:"ownerID"::String as OWNER_ID,    
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"recordId"::String as RECORDID,

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_LEAVE_APPROVER_VIEW   


      );
2020-05-22 09:22:08.326162 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 4 unexpected 'SRC'.
2020-05-22 09:22:08.326816 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: ROLLBACK
2020-05-22 09:22:08.327864 (Thread-1): initiating rollback
2020-05-22 09:22:08.912470 (Thread-1): finished collecting timing info
2020-05-22 09:22:08.915536 (Thread-1): Database Error in model TB_LEAVE_APPROVER_VIEW (models\analytics\TB_LEAVE_APPROVER_VIEW.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 4 unexpected 'SRC'.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_LEAVE_APPROVER_VIEW.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 14 at position 4 unexpected 'SRC'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_LEAVE_APPROVER_VIEW (models\analytics\TB_LEAVE_APPROVER_VIEW.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 4 unexpected 'SRC'.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_LEAVE_APPROVER_VIEW.sql
2020-05-22 09:22:08.939269 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38120f18-c42d-4005-bc4c-6cf32550c4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F17EBE0>]}
2020-05-22 09:22:08.939269 (Thread-1): 14:52:08 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_LEAVE_APPROVER_VIEW [ERROR in 4.02s]
2020-05-22 09:22:08.943384 (Thread-1): Finished running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 09:22:08.949979 (MainThread): Using snowflake connection "master".
2020-05-22 09:22:08.949979 (MainThread): On master: BEGIN
2020-05-22 09:22:09.420289 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2020-05-22 09:22:09.420289 (MainThread): On master: COMMIT
2020-05-22 09:22:09.420289 (MainThread): Using snowflake connection "master".
2020-05-22 09:22:09.420289 (MainThread): On master: COMMIT
2020-05-22 09:22:10.139745 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2020-05-22 09:22:10.139745 (MainThread): 14:52:10 | 
2020-05-22 09:22:10.143834 (MainThread): 14:52:10 | Finished running 1 incremental model in 16.91s.
2020-05-22 09:22:10.173432 (MainThread): Connection 'master' was left open.
2020-05-22 09:22:10.173432 (MainThread): On master: Close
2020-05-22 09:22:11.165626 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-22 09:22:11.165626 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-22 09:22:12.337393 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-22 09:22:12.337393 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-22 09:22:13.216503 (MainThread): Connection 'model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW' was left open.
2020-05-22 09:22:13.216503 (MainThread): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: Close
2020-05-22 09:22:14.048542 (MainThread): 
2020-05-22 09:22:14.048542 (MainThread): Completed with 1 error and 0 warnings:
2020-05-22 09:22:14.083630 (MainThread): 
2020-05-22 09:22:14.084637 (MainThread): Database Error in model TB_LEAVE_APPROVER_VIEW (models\analytics\TB_LEAVE_APPROVER_VIEW.sql)
2020-05-22 09:22:14.088342 (MainThread):   001003 (42000): SQL compilation error:
2020-05-22 09:22:14.089342 (MainThread):   syntax error line 14 at position 4 unexpected 'SRC'.
2020-05-22 09:22:14.089342 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_LEAVE_APPROVER_VIEW.sql
2020-05-22 09:22:14.093364 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-22 09:22:14.097807 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F006718>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F165FE8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F165E80>]}
2020-05-22 09:22:14.098805 (MainThread): Flushing usage events
2020-05-22 10:33:25.954176 (MainThread): Running with dbt=0.16.1
2020-05-22 10:33:26.102739 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 10:33:26.373016 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_LEAVE_APPROVER_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-22 10:33:26.374014 (MainThread): Tracking: tracking
2020-05-22 10:33:26.374014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D74C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFF9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFF90B8>]}
2020-05-22 10:33:26.396953 (MainThread): Partial parsing not enabled
2020-05-22 10:33:26.400942 (MainThread): Parsing macros\core.sql
2020-05-22 10:33:26.405929 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 10:33:26.469758 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 10:33:26.482723 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 10:33:26.483721 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 10:33:26.485715 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 10:33:26.487710 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 10:33:26.490702 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 10:33:26.492696 (MainThread): Parsing macros\etc\query.sql
2020-05-22 10:33:26.494691 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 10:33:26.504664 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 10:33:26.524679 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 10:33:26.526625 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 10:33:26.536599 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 10:33:26.568513 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 10:33:26.619377 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 10:33:26.621372 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 10:33:26.644311 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 10:33:26.655282 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 10:33:26.661265 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 10:33:26.670241 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 10:33:26.673233 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 10:33:26.674231 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 10:33:26.676225 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 10:33:26.678220 (MainThread): Parsing macros\adapters.sql
2020-05-22 10:33:26.702156 (MainThread): Parsing macros\catalog.sql
2020-05-22 10:33:26.705148 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 10:33:26.716118 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 10:33:26.718113 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 10:33:26.724097 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 10:33:26.748057 (MainThread): Partial parsing not enabled
2020-05-22 10:33:26.786953 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 10:33:26.786953 (MainThread): Opening a new connection, currently in state init
2020-05-22 10:33:26.812884 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 10:33:26.812884 (MainThread): Opening a new connection, currently in state init
2020-05-22 10:33:27.018356 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 2 sources
2020-05-22 10:33:27.021347 (MainThread): 
2020-05-22 10:33:27.029341 (MainThread): Acquiring new snowflake connection "master".
2020-05-22 10:33:27.029341 (MainThread): Opening a new connection, currently in state init
2020-05-22 10:33:27.036308 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 10:33:27.036308 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-22 10:33:27.127615 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 10:33:27.127615 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-22 10:33:28.636318 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 10:33:29.865643 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.74 seconds
2020-05-22 10:33:29.889308 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 10:33:29.889308 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-22 10:33:29.891305 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 10:33:29.891305 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-22 10:33:32.413607 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.52 seconds
2020-05-22 10:33:32.413607 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 10:33:32.414604 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 10:33:34.402990 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.99 seconds
2020-05-22 10:33:34.404973 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-22 10:33:34.406021 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-22 10:33:35.256030 (MainThread): Using snowflake connection "master".
2020-05-22 10:33:35.257054 (MainThread): On master: BEGIN
2020-05-22 10:33:37.731013 (MainThread): SQL status: SUCCESS 1 in 2.47 seconds
2020-05-22 10:33:37.731013 (MainThread): On master: COMMIT
2020-05-22 10:33:37.732012 (MainThread): Using snowflake connection "master".
2020-05-22 10:33:37.732012 (MainThread): On master: COMMIT
2020-05-22 10:33:38.472554 (MainThread): SQL status: SUCCESS 1 in 0.74 seconds
2020-05-22 10:33:38.473601 (MainThread): 16:03:38 | Concurrency: 1 threads (target='dev')
2020-05-22 10:33:38.475546 (MainThread): 16:03:38 | 
2020-05-22 10:33:38.497469 (Thread-1): Began running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 10:33:38.497469 (Thread-1): 16:03:38 | 1 of 1 START incremental model ANALYTICS.TB_LEAVE_APPROVER_VIEW...... [RUN]
2020-05-22 10:33:38.499499 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 10:33:38.499499 (Thread-1): Opening a new connection, currently in state init
2020-05-22 10:33:38.499499 (Thread-1): Compiling model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 10:33:38.522424 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"
2020-05-22 10:33:38.523396 (Thread-1): finished collecting timing info
2020-05-22 10:33:38.560338 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"
2020-05-22 10:33:38.562356 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 10:33:38.562356 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: BEGIN
2020-05-22 10:33:41.172532 (Thread-1): SQL status: SUCCESS 1 in 2.61 seconds
2020-05-22 10:33:41.173532 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 10:33:41.173532 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_LEAVE_APPROVER_VIEW  as
      (

select 
    SRC:"ApprovalStatus"::String as APPROVAL_STATUS,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Explain Reason for leave"::String as EXPLAIN_REASON_FOR_LEAVE,  
    SRC:"From (mm/dd/yyyy)"::Date as FROM_DATE,  
    SRC:"Leave type"::String as LEAVE_TYPE,
    SRC:"To (mm/dd/yyyy)"::Date as TO_DATE,
    SRC:"createdTime"::String as CREATED_TIME_INT,    
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::String as OWNER_ID,    
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"recordId"::String as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_LEAVE_APPROVER_VIEW   


      );
2020-05-22 10:33:43.796904 (Thread-1): SQL status: SUCCESS 1 in 2.62 seconds
2020-05-22 10:33:43.798902 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: COMMIT
2020-05-22 10:33:43.798902 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 10:33:43.799896 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: COMMIT
2020-05-22 10:33:44.271685 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-05-22 10:33:44.278672 (Thread-1): finished collecting timing info
2020-05-22 10:33:44.281623 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c90b228-d99f-4c50-9fc3-2e1dfee40618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5C21D8>]}
2020-05-22 10:33:44.282656 (Thread-1): 16:03:44 | 1 of 1 OK created incremental model ANALYTICS.TB_LEAVE_APPROVER_VIEW. [SUCCESS 1 in 5.78s]
2020-05-22 10:33:44.286602 (Thread-1): Finished running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 10:33:44.289636 (MainThread): Using snowflake connection "master".
2020-05-22 10:33:44.289636 (MainThread): On master: BEGIN
2020-05-22 10:33:44.853107 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2020-05-22 10:33:44.854102 (MainThread): On master: COMMIT
2020-05-22 10:33:44.854102 (MainThread): Using snowflake connection "master".
2020-05-22 10:33:44.855099 (MainThread): On master: COMMIT
2020-05-22 10:33:45.494487 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-22 10:33:45.495486 (MainThread): 16:03:45 | 
2020-05-22 10:33:45.496439 (MainThread): 16:03:45 | Finished running 1 incremental model in 18.47s.
2020-05-22 10:33:45.499430 (MainThread): Connection 'master' was left open.
2020-05-22 10:33:45.499430 (MainThread): On master: Close
2020-05-22 10:33:46.332396 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-22 10:33:46.332396 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-22 10:33:47.095154 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-22 10:33:47.096158 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-22 10:33:48.053420 (MainThread): Connection 'model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW' was left open.
2020-05-22 10:33:48.053420 (MainThread): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: Close
2020-05-22 10:33:48.840133 (MainThread): 
2020-05-22 10:33:48.841126 (MainThread): Completed successfully
2020-05-22 10:33:48.843120 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-22 10:33:48.854814 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4CD4A8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0537D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1E60B8>]}
2020-05-22 10:33:48.854814 (MainThread): Flushing usage events
2020-05-22 11:14:42.342479 (MainThread): Running with dbt=0.16.1
2020-05-22 11:14:42.480419 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 11:14:42.733777 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_LEAVE_APPROVER_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-22 11:14:42.734773 (MainThread): Tracking: tracking
2020-05-22 11:14:42.734773 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E54BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDF9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDF90D0>]}
2020-05-22 11:14:42.753721 (MainThread): Partial parsing not enabled
2020-05-22 11:14:42.757713 (MainThread): Parsing macros\core.sql
2020-05-22 11:14:42.762658 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 11:14:42.805588 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 11:14:42.814562 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 11:14:42.815560 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 11:14:42.817554 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 11:14:42.819551 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 11:14:42.821544 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 11:14:42.823539 (MainThread): Parsing macros\etc\query.sql
2020-05-22 11:14:42.825532 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 11:14:42.833510 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 11:14:42.846478 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 11:14:42.848471 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 11:14:42.855458 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 11:14:42.876395 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 11:14:42.909310 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 11:14:42.911309 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 11:14:42.928431 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 11:14:42.935411 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 11:14:42.940397 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 11:14:42.947379 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 11:14:42.949372 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 11:14:42.950371 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 11:14:42.952366 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 11:14:42.953362 (MainThread): Parsing macros\adapters.sql
2020-05-22 11:14:42.972312 (MainThread): Parsing macros\catalog.sql
2020-05-22 11:14:42.974307 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 11:14:42.983283 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 11:14:42.985277 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 11:14:42.989268 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 11:14:43.009206 (MainThread): Partial parsing not enabled
2020-05-22 11:14:43.040131 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:14:43.040131 (MainThread): Opening a new connection, currently in state init
2020-05-22 11:14:43.061073 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 11:14:43.062072 (MainThread): Opening a new connection, currently in state init
2020-05-22 11:14:43.237372 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 2 sources
2020-05-22 11:14:43.239886 (MainThread): 
2020-05-22 11:14:43.240883 (MainThread): Acquiring new snowflake connection "master".
2020-05-22 11:14:43.240883 (MainThread): Opening a new connection, currently in state init
2020-05-22 11:14:43.247822 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 11:14:43.247822 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-22 11:14:43.341636 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 11:14:43.341636 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-22 11:14:44.902660 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 11:14:46.262720 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.92 seconds
2020-05-22 11:14:46.278064 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 11:14:46.278064 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-22 11:14:46.280062 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 11:14:46.281058 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-22 11:14:49.091970 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.81 seconds
2020-05-22 11:14:49.091970 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 11:14:49.092967 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 11:14:50.316603 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.22 seconds
2020-05-22 11:14:50.321586 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-22 11:14:50.321586 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-22 11:14:50.945830 (MainThread): Using snowflake connection "master".
2020-05-22 11:14:50.945830 (MainThread): On master: BEGIN
2020-05-22 11:14:53.506500 (MainThread): SQL status: SUCCESS 1 in 2.56 seconds
2020-05-22 11:14:53.506500 (MainThread): On master: COMMIT
2020-05-22 11:14:53.507498 (MainThread): Using snowflake connection "master".
2020-05-22 11:14:53.507498 (MainThread): On master: COMMIT
2020-05-22 11:14:54.155850 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2020-05-22 11:14:54.156849 (MainThread): 16:44:54 | Concurrency: 1 threads (target='dev')
2020-05-22 11:14:54.158801 (MainThread): 16:44:54 | 
2020-05-22 11:14:54.167811 (Thread-1): Began running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 11:14:54.167811 (Thread-1): 16:44:54 | 1 of 1 START incremental model ANALYTICS.TB_LEAVE_APPROVER_VIEW...... [RUN]
2020-05-22 11:14:54.173727 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:14:54.173727 (Thread-1): Opening a new connection, currently in state init
2020-05-22 11:14:54.173727 (Thread-1): Compiling model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 11:14:54.193729 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"
2020-05-22 11:14:54.194673 (Thread-1): finished collecting timing info
2020-05-22 11:14:54.230618 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:14:54.230618 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */

    

      create or replace temporary table ZOHO_OA_EDW.ANALYTICS.TB_LEAVE_APPROVER_VIEW__dbt_tmp  as
      (

select 
    SRC:"ApprovalStatus"::String as APPROVAL_STATUS,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Explain Reason for leave"::String as EXPLAIN_REASON_FOR_LEAVE,  
    SRC:"From (mm/dd/yyyy)"::Date as FROM_DATE,  
    SRC:"Leave type"::String as LEAVE_TYPE,
    SRC:"To (mm/dd/yyyy)"::Date as TO_DATE,
    SRC:"createdTime"::String as CREATED_TIME_INT,    
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::String as OWNER_ID,    
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"recordId"::String as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_LEAVE_APPROVER_VIEW   


    where MODIFIED_TIME > ( select max(MODIFIED_TIME) from ZOHO_OA_EDW.ANALYTICS.TB_LEAVE_APPROVER_VIEW )

      );
2020-05-22 11:14:58.680504 (Thread-1): SQL status: SUCCESS 1 in 4.45 seconds
2020-05-22 11:14:58.686474 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:14:58.686474 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: BEGIN
2020-05-22 11:14:59.280880 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-22 11:14:59.280880 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:14:59.281916 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_LEAVE_APPROVER_VIEW__dbt_tmp'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-22 11:15:00.498603 (Thread-1): SQL status: SUCCESS 12 in 1.22 seconds
2020-05-22 11:15:00.504577 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:15:00.504577 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_LEAVE_APPROVER_VIEW'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-22 11:15:01.767779 (Thread-1): SQL status: SUCCESS 12 in 1.26 seconds
2020-05-22 11:15:01.785729 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:15:01.786725 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_LEAVE_APPROVER_VIEW'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-22 11:15:03.106164 (Thread-1): SQL status: SUCCESS 12 in 1.32 seconds
2020-05-22 11:15:03.131092 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"
2020-05-22 11:15:03.133053 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:15:03.134083 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW"} */

        
        
    

    merge into ZOHO_OA_EDW.ANALYTICS.TB_LEAVE_APPROVER_VIEW as DBT_INTERNAL_DEST
        using ZOHO_OA_EDW.ANALYTICS.TB_LEAVE_APPROVER_VIEW__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.RECORDID = DBT_INTERNAL_DEST.RECORDID
        

    
    when matched then update set
        "APPROVAL_STATUS" = DBT_INTERNAL_SOURCE."APPROVAL_STATUS","ASSOCIATE_ID" = DBT_INTERNAL_SOURCE."ASSOCIATE_ID","EXPLAIN_REASON_FOR_LEAVE" = DBT_INTERNAL_SOURCE."EXPLAIN_REASON_FOR_LEAVE","FROM_DATE" = DBT_INTERNAL_SOURCE."FROM_DATE","LEAVE_TYPE" = DBT_INTERNAL_SOURCE."LEAVE_TYPE","TO_DATE" = DBT_INTERNAL_SOURCE."TO_DATE","CREATED_TIME_INT" = DBT_INTERNAL_SOURCE."CREATED_TIME_INT","MODIFIED_TIME_INT" = DBT_INTERNAL_SOURCE."MODIFIED_TIME_INT","MODIFIED_TIME" = DBT_INTERNAL_SOURCE."MODIFIED_TIME","OWNER_ID" = DBT_INTERNAL_SOURCE."OWNER_ID","OWNER_NAME" = DBT_INTERNAL_SOURCE."OWNER_NAME","RECORDID" = DBT_INTERNAL_SOURCE."RECORDID"
    

    when not matched then insert
        ("APPROVAL_STATUS", "ASSOCIATE_ID", "EXPLAIN_REASON_FOR_LEAVE", "FROM_DATE", "LEAVE_TYPE", "TO_DATE", "CREATED_TIME_INT", "MODIFIED_TIME_INT", "MODIFIED_TIME", "OWNER_ID", "OWNER_NAME", "RECORDID")
    values
        ("APPROVAL_STATUS", "ASSOCIATE_ID", "EXPLAIN_REASON_FOR_LEAVE", "FROM_DATE", "LEAVE_TYPE", "TO_DATE", "CREATED_TIME_INT", "MODIFIED_TIME_INT", "MODIFIED_TIME", "OWNER_ID", "OWNER_NAME", "RECORDID")
2020-05-22 11:15:04.702442 (Thread-1): SQL status: SUCCESS 8 in 1.57 seconds
2020-05-22 11:15:04.704432 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: COMMIT
2020-05-22 11:15:04.704432 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 11:15:04.704432 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: COMMIT
2020-05-22 11:15:05.684712 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2020-05-22 11:15:05.687703 (Thread-1): finished collecting timing info
2020-05-22 11:15:05.688700 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a75ab4-a68b-4a53-9c9a-3933bf2838f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0FD9D9E8>]}
2020-05-22 11:15:05.688700 (Thread-1): 16:45:05 | 1 of 1 OK created incremental model ANALYTICS.TB_LEAVE_APPROVER_VIEW. [SUCCESS 8 in 11.52s]
2020-05-22 11:15:05.690563 (Thread-1): Finished running node model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW
2020-05-22 11:15:05.691546 (MainThread): Using snowflake connection "master".
2020-05-22 11:15:05.691546 (MainThread): On master: BEGIN
2020-05-22 11:15:06.224782 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2020-05-22 11:15:06.224782 (MainThread): On master: COMMIT
2020-05-22 11:15:06.225779 (MainThread): Using snowflake connection "master".
2020-05-22 11:15:06.225779 (MainThread): On master: COMMIT
2020-05-22 11:15:06.945459 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2020-05-22 11:15:06.946457 (MainThread): 16:45:06 | 
2020-05-22 11:15:06.948071 (MainThread): 16:45:06 | Finished running 1 incremental model in 23.71s.
2020-05-22 11:15:06.948071 (MainThread): Connection 'master' was left open.
2020-05-22 11:15:06.949073 (MainThread): On master: Close
2020-05-22 11:15:07.633947 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-22 11:15:07.633947 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-22 11:15:08.547501 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-22 11:15:08.547501 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-22 11:15:09.291486 (MainThread): Connection 'model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW' was left open.
2020-05-22 11:15:09.291486 (MainThread): On model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW: Close
2020-05-22 11:15:10.151247 (MainThread): 
2020-05-22 11:15:10.152277 (MainThread): Completed successfully
2020-05-22 11:15:10.153238 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-22 11:15:10.162210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F444940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFE8F58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFE8F10>]}
2020-05-22 11:15:10.163210 (MainThread): Flushing usage events
2020-05-22 12:17:53.114586 (MainThread): Running with dbt=0.16.1
2020-05-22 12:17:53.252426 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 12:17:53.540919 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_ASSOCIATE_VIEW'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-22 12:17:53.541905 (MainThread): Tracking: tracking
2020-05-22 12:17:53.541905 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DA2BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E2D9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E2D90A0>]}
2020-05-22 12:17:53.561864 (MainThread): Partial parsing not enabled
2020-05-22 12:17:53.565851 (MainThread): Parsing macros\core.sql
2020-05-22 12:17:53.570837 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 12:17:53.613727 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 12:17:53.623698 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 12:17:53.624698 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 12:17:53.626689 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 12:17:53.628682 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 12:17:53.630677 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 12:17:53.632676 (MainThread): Parsing macros\etc\query.sql
2020-05-22 12:17:53.634668 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 12:17:53.642648 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 12:17:53.655612 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 12:17:53.657607 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 12:17:53.664591 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 12:17:53.686530 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 12:17:53.718444 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 12:17:53.720442 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 12:17:53.738396 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 12:17:53.745372 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 12:17:53.750358 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 12:17:53.757340 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 12:17:53.759335 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 12:17:53.760335 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 12:17:53.761330 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 12:17:53.763323 (MainThread): Parsing macros\adapters.sql
2020-05-22 12:17:53.782273 (MainThread): Parsing macros\catalog.sql
2020-05-22 12:17:53.784271 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 12:17:53.793255 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 12:17:53.795250 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 12:17:53.799227 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 12:17:53.819175 (MainThread): Partial parsing not enabled
2020-05-22 12:17:53.850093 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:17:53.850093 (MainThread): Opening a new connection, currently in state init
2020-05-22 12:17:53.871036 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 12:17:53.871036 (MainThread): Opening a new connection, currently in state init
2020-05-22 12:17:53.878016 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 12:17:53.878016 (MainThread): Opening a new connection, currently in state init
2020-05-22 12:17:54.059531 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 3 sources
2020-05-22 12:17:54.062524 (MainThread): 
2020-05-22 12:17:54.063478 (MainThread): 17:47:54 | Concurrency: 1 threads (target='dev')
2020-05-22 12:17:54.065473 (MainThread): 17:47:54 | 
2020-05-22 12:17:54.069479 (Thread-1): Began running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-22 12:17:54.069479 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:17:54.069479 (Thread-1): Opening a new connection, currently in state init
2020-05-22 12:17:54.070517 (Thread-1): Compiling model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-22 12:17:54.084474 (Thread-1): On "model.vbi_zoho_people.TB_ASSOCIATE_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-22 12:17:54.180228 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:17:54.180228 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: BEGIN
2020-05-22 12:17:55.566743 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 12:17:56.983561 (Thread-1): SQL status: SUCCESS 1 in 2.80 seconds
2020-05-22 12:17:56.984560 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:17:56.985556 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 12:17:58.333144 (Thread-1): SQL status: SUCCESS 2 in 1.35 seconds
2020-05-22 12:17:58.341114 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER_VIEW">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES_VIEW">]
2020-05-22 12:17:58.342114 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-22 12:17:58.343114 (Thread-1): finished collecting timing info
2020-05-22 12:17:58.344062 (Thread-1): finished collecting timing info
2020-05-22 12:17:58.344062 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: ROLLBACK
2020-05-22 12:17:58.344062 (Thread-1): initiating rollback
2020-05-22 12:17:58.964706 (Thread-1): Finished running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-22 12:17:58.968280 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-22 12:17:58.969334 (MainThread): Connection 'model.vbi_zoho_people.TB_ASSOCIATE_VIEW' was left open.
2020-05-22 12:17:58.969334 (MainThread): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: Close
2020-05-22 12:17:59.694440 (MainThread): 17:47:59 | Done.
2020-05-22 12:17:59.695396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDC25F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDC2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDC2A60>]}
2020-05-22 12:17:59.695396 (MainThread): Flushing usage events
2020-05-22 12:18:33.770325 (MainThread): Running with dbt=0.16.1
2020-05-22 12:18:33.900929 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-22 12:18:34.143345 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_ASSOCIATE_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-22 12:18:34.144340 (MainThread): Tracking: tracking
2020-05-22 12:18:34.144340 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFBBB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E86A040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E86A088>]}
2020-05-22 12:18:34.163286 (MainThread): Partial parsing not enabled
2020-05-22 12:18:34.166279 (MainThread): Parsing macros\core.sql
2020-05-22 12:18:34.171265 (MainThread): Parsing macros\adapters\common.sql
2020-05-22 12:18:34.214150 (MainThread): Parsing macros\etc\datetime.sql
2020-05-22 12:18:34.223127 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-22 12:18:34.225123 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-22 12:18:34.226120 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-22 12:18:34.228113 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-22 12:18:34.230109 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-22 12:18:34.232102 (MainThread): Parsing macros\etc\query.sql
2020-05-22 12:18:34.233111 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-22 12:18:34.241079 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-22 12:18:34.255042 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-22 12:18:34.257037 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-22 12:18:34.263027 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-22 12:18:34.284961 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-22 12:18:34.316875 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-22 12:18:34.319871 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-22 12:18:34.336822 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-22 12:18:34.343806 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-22 12:18:34.348792 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-22 12:18:34.355771 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-22 12:18:34.357766 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-22 12:18:34.358764 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-22 12:18:34.360760 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-22 12:18:34.361756 (MainThread): Parsing macros\adapters.sql
2020-05-22 12:18:34.380716 (MainThread): Parsing macros\catalog.sql
2020-05-22 12:18:34.382700 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-22 12:18:34.391676 (MainThread): Parsing macros\materializations\merge.sql
2020-05-22 12:18:34.393671 (MainThread): Parsing macros\materializations\table.sql
2020-05-22 12:18:34.397660 (MainThread): Parsing macros\materializations\view.sql
2020-05-22 12:18:34.417608 (MainThread): Partial parsing not enabled
2020-05-22 12:18:34.448523 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:18:34.448523 (MainThread): Opening a new connection, currently in state init
2020-05-22 12:18:34.469469 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-22 12:18:34.469469 (MainThread): Opening a new connection, currently in state init
2020-05-22 12:18:34.475457 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-22 12:18:34.475457 (MainThread): Opening a new connection, currently in state init
2020-05-22 12:18:34.659940 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 3 sources
2020-05-22 12:18:34.662931 (MainThread): 
2020-05-22 12:18:34.670988 (MainThread): Acquiring new snowflake connection "master".
2020-05-22 12:18:34.670988 (MainThread): Opening a new connection, currently in state init
2020-05-22 12:18:34.677306 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 12:18:34.677306 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-22 12:18:34.769062 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-22 12:18:34.769062 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-22 12:18:36.227181 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-22 12:18:37.530605 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.76 seconds
2020-05-22 12:18:37.547520 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 12:18:37.547520 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-22 12:18:37.550551 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 12:18:37.550551 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-22 12:18:39.930627 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.38 seconds
2020-05-22 12:18:39.931636 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-22 12:18:39.932603 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-22 12:18:41.212126 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.28 seconds
2020-05-22 12:18:41.217093 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-22 12:18:41.217093 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-22 12:18:41.866215 (MainThread): Using snowflake connection "master".
2020-05-22 12:18:41.866215 (MainThread): On master: BEGIN
2020-05-22 12:18:44.091754 (MainThread): SQL status: SUCCESS 1 in 2.22 seconds
2020-05-22 12:18:44.091754 (MainThread): On master: COMMIT
2020-05-22 12:18:44.092751 (MainThread): Using snowflake connection "master".
2020-05-22 12:18:44.092751 (MainThread): On master: COMMIT
2020-05-22 12:18:44.674253 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2020-05-22 12:18:44.676249 (MainThread): 17:48:44 | Concurrency: 1 threads (target='dev')
2020-05-22 12:18:44.678194 (MainThread): 17:48:44 | 
2020-05-22 12:18:44.687168 (Thread-1): Began running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-22 12:18:44.687168 (Thread-1): 17:48:44 | 1 of 1 START incremental model ANALYTICS.TB_ASSOCIATE_VIEW........... [RUN]
2020-05-22 12:18:44.692691 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:18:44.692691 (Thread-1): Opening a new connection, currently in state init
2020-05-22 12:18:44.692691 (Thread-1): Compiling model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-22 12:18:44.710681 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-22 12:18:44.711675 (Thread-1): finished collecting timing info
2020-05-22 12:18:44.748125 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-22 12:18:44.750154 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:18:44.750154 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: BEGIN
2020-05-22 12:18:47.099819 (Thread-1): SQL status: SUCCESS 1 in 2.35 seconds
2020-05-22 12:18:47.099819 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-22 12:18:47.100818 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_ASSOCIATE_VIEW  as
      (


Select 
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Associate type"::String as ASSOCIATE_TYPE,
    SRC:"Date of joining (dd-MMM-yyyy)"::Date as DATE_OF_JOINING,
    SRC:"Department"::String as DEPARTMENT,
    SRC:"Designation"::String as DESIGNATION,
    SRC:"Email ID"::String as EMAIL_ID,
    SRC:"First Name"::String as FIRST_NAME,
    SRC:"Last Name"::String as LAST_NAME,
    SRC:"Location"::String as LOCATION,
    SRC:"People Manager"::String as PEOPLE_MANAGER,
    SRC:"Photo"::String as PHOTO,
    SRC:"Photo_downloadUrl"::String as PHOTO_DOWNLOAD_URL,
    SRC:"Work phone"::String as WORK_PHONE,
    SRC:"createdTime"::String as CREATED_TIME_INT, 
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::String as OWNER_ID,    
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"recordId"::String as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_ASSOCIATE_VIEW


      );
2020-05-22 12:18:48.922657 (Thread-1): Snowflake error: 100040 (22007): Date '' is not recognized
2020-05-22 12:18:48.923654 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: ROLLBACK
2020-05-22 12:18:48.923654 (Thread-1): initiating rollback
2020-05-22 12:18:49.321154 (Thread-1): finished collecting timing info
2020-05-22 12:18:49.322144 (Thread-1): Database Error in model TB_ASSOCIATE_VIEW (models\analytics\TB_ASSOCIATE_VIEW.sql)
  100040 (22007): Date '' is not recognized
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_ASSOCIATE_VIEW.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 100040 (22007): Date '' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_ASSOCIATE_VIEW (models\analytics\TB_ASSOCIATE_VIEW.sql)
  100040 (22007): Date '' is not recognized
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_ASSOCIATE_VIEW.sql
2020-05-22 12:18:49.327133 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b31755-6cb9-47f1-b48f-b8dff8705308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE1EF28>]}
2020-05-22 12:18:49.327133 (Thread-1): 17:48:49 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_ASSOCIATE_VIEW.. [ERROR in 4.64s]
2020-05-22 12:18:49.329083 (Thread-1): Finished running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-22 12:18:49.330080 (MainThread): Using snowflake connection "master".
2020-05-22 12:18:49.330080 (MainThread): On master: BEGIN
2020-05-22 12:18:49.851382 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2020-05-22 12:18:49.852387 (MainThread): On master: COMMIT
2020-05-22 12:18:49.852387 (MainThread): Using snowflake connection "master".
2020-05-22 12:18:49.853383 (MainThread): On master: COMMIT
2020-05-22 12:18:50.650769 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2020-05-22 12:18:50.652767 (MainThread): 17:48:50 | 
2020-05-22 12:18:50.654416 (MainThread): 17:48:50 | Finished running 1 incremental model in 15.98s.
2020-05-22 12:18:50.654416 (MainThread): Connection 'master' was left open.
2020-05-22 12:18:50.654416 (MainThread): On master: Close
2020-05-22 12:18:51.531654 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-22 12:18:51.531654 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-22 12:18:52.373040 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-22 12:18:52.373040 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-22 12:18:53.171861 (MainThread): Connection 'model.vbi_zoho_people.TB_ASSOCIATE_VIEW' was left open.
2020-05-22 12:18:53.171861 (MainThread): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: Close
2020-05-22 12:18:53.861569 (MainThread): 
2020-05-22 12:18:53.862528 (MainThread): Completed with 1 error and 0 warnings:
2020-05-22 12:18:53.863525 (MainThread): 
2020-05-22 12:18:53.871504 (MainThread): Database Error in model TB_ASSOCIATE_VIEW (models\analytics\TB_ASSOCIATE_VIEW.sql)
2020-05-22 12:18:53.872503 (MainThread):   100040 (22007): Date '' is not recognized
2020-05-22 12:18:53.873536 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_ASSOCIATE_VIEW.sql
2020-05-22 12:18:53.874496 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-22 12:18:53.875493 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE06EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE0E388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE0E070>]}
2020-05-22 12:18:53.875493 (MainThread): Flushing usage events
2020-05-24 06:20:14.182477 (MainThread): Running with dbt=0.16.1
2020-05-24 06:20:14.552611 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 06:20:15.131167 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_ASSOCIATE_VIEW'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-24 06:20:15.131167 (MainThread): Tracking: tracking
2020-05-24 06:20:15.131167 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E2ABB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EB59040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EB590A0>]}
2020-05-24 06:20:15.165261 (MainThread): Partial parsing not enabled
2020-05-24 06:20:15.173261 (MainThread): Parsing macros\core.sql
2020-05-24 06:20:15.182468 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 06:20:15.368053 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 06:20:15.420530 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 06:20:15.426843 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 06:20:15.431912 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 06:20:15.443911 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 06:20:15.451913 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 06:20:15.465166 (MainThread): Parsing macros\etc\query.sql
2020-05-24 06:20:15.470238 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 06:20:15.499864 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 06:20:15.525541 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 06:20:15.526538 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 06:20:15.542692 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 06:20:15.575734 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 06:20:15.632854 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 06:20:15.640426 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 06:20:15.673480 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 06:20:15.685480 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 06:20:15.695893 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 06:20:15.708894 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 06:20:15.712980 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 06:20:15.713977 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 06:20:15.718026 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 06:20:15.722275 (MainThread): Parsing macros\adapters.sql
2020-05-24 06:20:15.755620 (MainThread): Parsing macros\catalog.sql
2020-05-24 06:20:15.759626 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 06:20:15.775625 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 06:20:15.779626 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 06:20:15.783626 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 06:20:15.818573 (MainThread): Partial parsing not enabled
2020-05-24 06:20:15.893517 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:20:15.893517 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:20:15.989227 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 06:20:15.989227 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:20:16.011962 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 06:20:16.011962 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:20:16.503790 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 3 sources
2020-05-24 06:20:16.511635 (MainThread): 
2020-05-24 06:20:16.511635 (MainThread): 11:50:16 | Concurrency: 1 threads (target='dev')
2020-05-24 06:20:16.512915 (MainThread): 11:50:16 | 
2020-05-24 06:20:16.533594 (Thread-1): Began running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:20:16.534630 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:20:16.534630 (Thread-1): Opening a new connection, currently in state init
2020-05-24 06:20:16.534630 (Thread-1): Compiling model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:20:16.597565 (Thread-1): On "model.vbi_zoho_people.TB_ASSOCIATE_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-24 06:20:16.830483 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:20:16.830483 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: BEGIN
2020-05-24 06:20:19.198919 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 06:20:21.941219 (Thread-1): SQL status: SUCCESS 1 in 5.11 seconds
2020-05-24 06:20:21.941219 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:20:21.941219 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 06:20:24.934945 (Thread-1): SQL status: SUCCESS 2 in 2.99 seconds
2020-05-24 06:20:24.957765 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER_VIEW">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES_VIEW">]
2020-05-24 06:20:24.965768 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-24 06:20:24.969910 (Thread-1): finished collecting timing info
2020-05-24 06:20:24.970963 (Thread-1): finished collecting timing info
2020-05-24 06:20:24.970963 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: ROLLBACK
2020-05-24 06:20:24.970963 (Thread-1): initiating rollback
2020-05-24 06:20:25.754120 (Thread-1): Finished running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:20:25.760439 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-24 06:20:25.760439 (MainThread): Connection 'model.vbi_zoho_people.TB_ASSOCIATE_VIEW' was left open.
2020-05-24 06:20:25.761435 (MainThread): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: Close
2020-05-24 06:20:26.545192 (MainThread): 11:50:26 | Done.
2020-05-24 06:20:26.546739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBB3CE8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED2B670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED2BA18>]}
2020-05-24 06:20:26.546739 (MainThread): Flushing usage events
2020-05-24 06:21:20.468656 (MainThread): Running with dbt=0.16.1
2020-05-24 06:21:20.706575 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 06:21:21.093637 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_ASSOCIATE_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-24 06:21:21.093637 (MainThread): Tracking: tracking
2020-05-24 06:21:21.093637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE7BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E729040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7290A0>]}
2020-05-24 06:21:21.125734 (MainThread): Partial parsing not enabled
2020-05-24 06:21:21.133758 (MainThread): Parsing macros\core.sql
2020-05-24 06:21:21.139950 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 06:21:21.211786 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 06:21:21.227882 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 06:21:21.231874 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 06:21:21.231874 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 06:21:21.238026 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 06:21:21.239020 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 06:21:21.243061 (MainThread): Parsing macros\etc\query.sql
2020-05-24 06:21:21.247062 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 06:21:21.261097 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 06:21:21.282179 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 06:21:21.284390 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 06:21:21.296362 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 06:21:21.330941 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 06:21:21.385617 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 06:21:21.389556 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 06:21:21.421025 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 06:21:21.432986 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 06:21:21.442281 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 06:21:21.452762 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 06:21:21.456792 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 06:21:21.457790 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 06:21:21.460453 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 06:21:21.463577 (MainThread): Parsing macros\adapters.sql
2020-05-24 06:21:21.491675 (MainThread): Parsing macros\catalog.sql
2020-05-24 06:21:21.495711 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 06:21:21.511763 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 06:21:21.515759 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 06:21:21.521932 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 06:21:21.551383 (MainThread): Partial parsing not enabled
2020-05-24 06:21:21.602274 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:21:21.602274 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:21:21.636668 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 06:21:21.640610 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:21:21.648669 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 06:21:21.648669 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:21:21.940333 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 3 sources
2020-05-24 06:21:21.947273 (MainThread): 
2020-05-24 06:21:21.947406 (MainThread): Acquiring new snowflake connection "master".
2020-05-24 06:21:21.948403 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:21:21.961948 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 06:21:21.964664 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-24 06:21:22.188325 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 06:21:22.188325 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-24 06:21:23.888633 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 06:21:27.115330 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.93 seconds
2020-05-24 06:21:27.227802 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 06:21:27.229386 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-24 06:21:27.238510 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 06:21:27.238510 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-24 06:21:30.470646 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.23 seconds
2020-05-24 06:21:30.470646 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 06:21:30.470646 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 06:21:32.160990 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.69 seconds
2020-05-24 06:21:32.172225 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-24 06:21:32.172225 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-24 06:21:32.933621 (MainThread): Using snowflake connection "master".
2020-05-24 06:21:32.933621 (MainThread): On master: BEGIN
2020-05-24 06:21:35.591796 (MainThread): SQL status: SUCCESS 1 in 2.66 seconds
2020-05-24 06:21:35.591796 (MainThread): On master: COMMIT
2020-05-24 06:21:35.591796 (MainThread): Using snowflake connection "master".
2020-05-24 06:21:35.591796 (MainThread): On master: COMMIT
2020-05-24 06:21:36.206958 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2020-05-24 06:21:36.206958 (MainThread): 11:51:36 | Concurrency: 1 threads (target='dev')
2020-05-24 06:21:36.211400 (MainThread): 11:51:36 | 
2020-05-24 06:21:36.221672 (Thread-1): Began running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:21:36.222630 (Thread-1): 11:51:36 | 1 of 1 START incremental model ANALYTICS.TB_ASSOCIATE_VIEW........... [RUN]
2020-05-24 06:21:36.224904 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:21:36.224904 (Thread-1): Opening a new connection, currently in state init
2020-05-24 06:21:36.225900 (Thread-1): Compiling model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:21:36.318708 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-24 06:21:36.323931 (Thread-1): finished collecting timing info
2020-05-24 06:21:36.457099 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-24 06:21:36.466191 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:21:36.467180 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: BEGIN
2020-05-24 06:21:39.379875 (Thread-1): SQL status: SUCCESS 1 in 2.91 seconds
2020-05-24 06:21:39.379875 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:21:39.379875 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_ASSOCIATE_VIEW  as
      (

Select 
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Associate type"::String as ASSOCIATE_TYPE,
    SRC:"Date of joining (dd-MMM-yyyy)"::Date as DATE_OF_JOINING,
    SRC:"Department"::String as DEPARTMENT,
    SRC:"Designation"::String as DESIGNATION,
    SRC:"Email ID"::String as EMAIL_ID,
    SRC:"First Name"::String as FIRST_NAME,
    SRC:"Last Name"::String as LAST_NAME,
    SRC:"Location"::String as LOCATION,
    SRC:"People Manager"::String as PEOPLE_MANAGER,
    SRC:"Photo"::String as PHOTO,
    SRC:"Photo_downloadUrl"::String as PHOTO_DOWNLOAD_URL,
    SRC:"Work phone"::String as WORK_PHONE,
    SRC:"createdTime"::String as CREATED_TIME_INT, 
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::String as OWNER_ID,    
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"recordId"::String as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_ASSOCIATE_VIEW


      );
2020-05-24 06:21:41.836979 (Thread-1): Snowflake error: 100040 (22007): Date '00-00-0000' is not recognized
2020-05-24 06:21:41.836979 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: ROLLBACK
2020-05-24 06:21:41.836979 (Thread-1): initiating rollback
2020-05-24 06:21:42.276774 (Thread-1): finished collecting timing info
2020-05-24 06:21:42.281011 (Thread-1): Database Error in model TB_ASSOCIATE_VIEW (models\analytics\TB_ASSOCIATE_VIEW.sql)
  100040 (22007): Date '00-00-0000' is not recognized
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_ASSOCIATE_VIEW.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 100040 (22007): Date '00-00-0000' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_ASSOCIATE_VIEW (models\analytics\TB_ASSOCIATE_VIEW.sql)
  100040 (22007): Date '00-00-0000' is not recognized
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_ASSOCIATE_VIEW.sql
2020-05-24 06:21:42.353057 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f82e3d8-4d67-4fcb-ac43-fdd007fd539e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBFAAC0>]}
2020-05-24 06:21:42.353057 (Thread-1): 11:51:42 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_ASSOCIATE_VIEW.. [ERROR in 6.13s]
2020-05-24 06:21:42.358315 (Thread-1): Finished running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:21:42.362594 (MainThread): Using snowflake connection "master".
2020-05-24 06:21:42.363799 (MainThread): On master: BEGIN
2020-05-24 06:21:42.962996 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-24 06:21:42.967047 (MainThread): On master: COMMIT
2020-05-24 06:21:42.967047 (MainThread): Using snowflake connection "master".
2020-05-24 06:21:42.967047 (MainThread): On master: COMMIT
2020-05-24 06:21:43.579302 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-24 06:21:43.579302 (MainThread): 11:51:43 | 
2020-05-24 06:21:43.584307 (MainThread): 11:51:43 | Finished running 1 incremental model in 21.63s.
2020-05-24 06:21:43.586302 (MainThread): Connection 'master' was left open.
2020-05-24 06:21:43.587300 (MainThread): On master: Close
2020-05-24 06:21:44.810738 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-24 06:21:44.810738 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-24 06:21:45.640898 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-24 06:21:45.640898 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-24 06:21:46.539209 (MainThread): Connection 'model.vbi_zoho_people.TB_ASSOCIATE_VIEW' was left open.
2020-05-24 06:21:46.539209 (MainThread): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: Close
2020-05-24 06:21:47.480472 (MainThread): 
2020-05-24 06:21:47.482626 (MainThread): Completed with 1 error and 0 warnings:
2020-05-24 06:21:47.516570 (MainThread): 
2020-05-24 06:21:47.519563 (MainThread): Database Error in model TB_ASSOCIATE_VIEW (models\analytics\TB_ASSOCIATE_VIEW.sql)
2020-05-24 06:21:47.522691 (MainThread):   100040 (22007): Date '00-00-0000' is not recognized
2020-05-24 06:21:47.525347 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_ASSOCIATE_VIEW.sql
2020-05-24 06:21:47.597334 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-24 06:21:47.601837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E947C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E947040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9478B0>]}
2020-05-24 06:21:47.602836 (MainThread): Flushing usage events
2020-05-24 06:23:52.391485 (MainThread): Running with dbt=0.16.1
2020-05-24 06:23:52.715454 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 06:23:53.162129 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_ASSOCIATE_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-24 06:23:53.162129 (MainThread): Tracking: tracking
2020-05-24 06:23:53.162129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E51BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDC9028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDC9088>]}
2020-05-24 06:23:53.210202 (MainThread): Partial parsing not enabled
2020-05-24 06:23:53.220386 (MainThread): Parsing macros\core.sql
2020-05-24 06:23:53.234629 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 06:23:53.319160 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 06:23:53.335231 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 06:23:53.335231 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 06:23:53.339231 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 06:23:53.341465 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 06:23:53.345505 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 06:23:53.349491 (MainThread): Parsing macros\etc\query.sql
2020-05-24 06:23:53.349491 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 06:23:53.363832 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 06:23:53.386192 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 06:23:53.386192 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 06:23:53.398233 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 06:23:53.430907 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 06:23:53.483724 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 06:23:53.487754 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 06:23:53.517332 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 06:23:53.527701 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 06:23:53.535850 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 06:23:53.549042 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 06:23:53.553060 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 06:23:53.553060 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 06:23:53.557089 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 06:23:53.561086 (MainThread): Parsing macros\adapters.sql
2020-05-24 06:23:53.587384 (MainThread): Parsing macros\catalog.sql
2020-05-24 06:23:53.591409 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 06:23:53.609671 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 06:23:53.610706 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 06:23:53.614757 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 06:23:53.649322 (MainThread): Partial parsing not enabled
2020-05-24 06:23:53.697871 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:23:53.697871 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:23:53.732127 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 06:23:53.732127 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:23:53.742344 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 06:23:53.742344 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:23:54.039278 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 3 sources
2020-05-24 06:23:54.042311 (MainThread): 
2020-05-24 06:23:54.044439 (MainThread): Acquiring new snowflake connection "master".
2020-05-24 06:23:54.044439 (MainThread): Opening a new connection, currently in state init
2020-05-24 06:23:54.059383 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 06:23:54.060386 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-24 06:23:54.245857 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 06:23:54.249943 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-24 06:23:56.119662 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 06:23:57.622884 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.37 seconds
2020-05-24 06:23:57.692097 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 06:23:57.693143 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-24 06:23:57.700440 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 06:23:57.700440 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-24 06:24:00.796032 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.10 seconds
2020-05-24 06:24:00.796032 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 06:24:00.796032 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 06:24:02.026884 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.23 seconds
2020-05-24 06:24:02.034951 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-24 06:24:02.034951 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-24 06:24:02.618995 (MainThread): Using snowflake connection "master".
2020-05-24 06:24:02.623259 (MainThread): On master: BEGIN
2020-05-24 06:24:05.603545 (MainThread): SQL status: SUCCESS 1 in 2.98 seconds
2020-05-24 06:24:05.603545 (MainThread): On master: COMMIT
2020-05-24 06:24:05.603545 (MainThread): Using snowflake connection "master".
2020-05-24 06:24:05.603545 (MainThread): On master: COMMIT
2020-05-24 06:24:06.216706 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-24 06:24:06.216706 (MainThread): 11:54:06 | Concurrency: 1 threads (target='dev')
2020-05-24 06:24:06.222080 (MainThread): 11:54:06 | 
2020-05-24 06:24:06.234736 (Thread-1): Began running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:24:06.234736 (Thread-1): 11:54:06 | 1 of 1 START incremental model ANALYTICS.TB_ASSOCIATE_VIEW........... [RUN]
2020-05-24 06:24:06.262968 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:24:06.263962 (Thread-1): Opening a new connection, currently in state init
2020-05-24 06:24:06.263962 (Thread-1): Compiling model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:24:06.361958 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-24 06:24:06.399125 (Thread-1): finished collecting timing info
2020-05-24 06:24:06.522647 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"
2020-05-24 06:24:06.526482 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:24:06.526482 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: BEGIN
2020-05-24 06:24:10.015054 (Thread-1): SQL status: SUCCESS 1 in 3.49 seconds
2020-05-24 06:24:10.016111 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:24:10.017228 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_ASSOCIATE_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_ASSOCIATE_VIEW  as
      (

Select 
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    SRC:"Associate ID"::String as ASSOCIATE_ID,
    SRC:"Associate type"::String as ASSOCIATE_TYPE,
    SRC:"Date of joining (dd-MMM-yyyy)"::Date as DATE_OF_JOINING,
    SRC:"Department"::String as DEPARTMENT,
    SRC:"Designation"::String as DESIGNATION,
    SRC:"Email ID"::String as EMAIL_ID,
    SRC:"First Name"::String as FIRST_NAME,
    SRC:"Last Name"::String as LAST_NAME,
    SRC:"Location"::String as LOCATION,
    SRC:"People Manager"::String as PEOPLE_MANAGER,
    SRC:"Photo"::String as PHOTO,
    SRC:"Photo_downloadUrl"::String as PHOTO_DOWNLOAD_URL,
    SRC:"Work phone"::String as WORK_PHONE,
    SRC:"createdTime"::String as CREATED_TIME_INT, 
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::String as OWNER_ID,    
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"recordId"::String as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_ASSOCIATE_VIEW


      );
2020-05-24 06:24:12.880729 (Thread-1): SQL status: SUCCESS 1 in 2.86 seconds
2020-05-24 06:24:12.884807 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: COMMIT
2020-05-24 06:24:12.884807 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 06:24:12.884807 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: COMMIT
2020-05-24 06:24:13.288242 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2020-05-24 06:24:13.296448 (Thread-1): finished collecting timing info
2020-05-24 06:24:13.296448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafbbb90-c533-4a4d-8998-8984e796c6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F365C40>]}
2020-05-24 06:24:13.300452 (Thread-1): 11:54:13 | 1 of 1 OK created incremental model ANALYTICS.TB_ASSOCIATE_VIEW...... [SUCCESS 1 in 7.03s]
2020-05-24 06:24:13.305649 (Thread-1): Finished running node model.vbi_zoho_people.TB_ASSOCIATE_VIEW
2020-05-24 06:24:13.310015 (MainThread): Using snowflake connection "master".
2020-05-24 06:24:13.310443 (MainThread): On master: BEGIN
2020-05-24 06:24:13.904854 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-24 06:24:13.904854 (MainThread): On master: COMMIT
2020-05-24 06:24:13.904854 (MainThread): Using snowflake connection "master".
2020-05-24 06:24:13.904854 (MainThread): On master: COMMIT
2020-05-24 06:24:14.519533 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-24 06:24:14.519533 (MainThread): 11:54:14 | 
2020-05-24 06:24:14.523857 (MainThread): 11:54:14 | Finished running 1 incremental model in 20.48s.
2020-05-24 06:24:14.525857 (MainThread): Connection 'master' was left open.
2020-05-24 06:24:14.525857 (MainThread): On master: Close
2020-05-24 06:24:15.750443 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-24 06:24:15.750443 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-24 06:24:16.774022 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-24 06:24:16.774022 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-24 06:24:18.003537 (MainThread): Connection 'model.vbi_zoho_people.TB_ASSOCIATE_VIEW' was left open.
2020-05-24 06:24:18.003537 (MainThread): On model.vbi_zoho_people.TB_ASSOCIATE_VIEW: Close
2020-05-24 06:24:19.023191 (MainThread): 
2020-05-24 06:24:19.024601 (MainThread): Completed successfully
2020-05-24 06:24:19.028591 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-24 06:24:19.061413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F28C658>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFDD928>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EFDDB50>]}
2020-05-24 06:24:19.063556 (MainThread): Flushing usage events
2020-05-24 08:03:18.494047 (MainThread): Running with dbt=0.16.1
2020-05-24 08:03:18.814016 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 08:03:19.631810 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_EMPLOYEE_VIEW'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-24 08:03:19.632847 (MainThread): Tracking: tracking
2020-05-24 08:03:19.632847 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E32BB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBDA430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBDA220>]}
2020-05-24 08:03:19.665804 (MainThread): Partial parsing not enabled
2020-05-24 08:03:19.669808 (MainThread): Parsing macros\core.sql
2020-05-24 08:03:19.685808 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 08:03:19.784394 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 08:03:19.800439 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 08:03:19.800439 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 08:03:19.804439 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 08:03:19.808439 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 08:03:19.812439 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 08:03:19.816438 (MainThread): Parsing macros\etc\query.sql
2020-05-24 08:03:19.816438 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 08:03:19.828439 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 08:03:19.849740 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 08:03:19.853740 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 08:03:19.865739 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 08:03:19.898702 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 08:03:19.974073 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 08:03:19.978105 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 08:03:20.020853 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 08:03:20.031824 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 08:03:20.041055 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 08:03:20.055034 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 08:03:20.059033 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 08:03:20.059033 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 08:03:20.063033 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 08:03:20.067068 (MainThread): Parsing macros\adapters.sql
2020-05-24 08:03:20.096490 (MainThread): Parsing macros\catalog.sql
2020-05-24 08:03:20.100534 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 08:03:20.116683 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 08:03:20.124678 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 08:03:20.132715 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 08:03:20.180716 (MainThread): Partial parsing not enabled
2020-05-24 08:03:20.253826 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 08:03:20.253826 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:03:20.289847 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 08:03:20.289847 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:03:20.301854 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:03:20.301854 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:03:20.317862 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 08:03:20.317862 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:03:20.675845 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 4 sources
2020-05-24 08:03:20.677878 (MainThread): 
2020-05-24 08:03:20.682457 (MainThread): 13:33:20 | Concurrency: 1 threads (target='dev')
2020-05-24 08:03:20.693137 (MainThread): 13:33:20 | 
2020-05-24 08:03:20.699945 (Thread-1): Began running node model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW
2020-05-24 08:03:20.699945 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:03:20.700988 (Thread-1): Opening a new connection, currently in state init
2020-05-24 08:03:20.700988 (Thread-1): Compiling model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW
2020-05-24 08:03:20.739936 (Thread-1): On "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-24 08:03:20.943582 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:03:20.944091 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: BEGIN
2020-05-24 08:03:23.055525 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 08:03:24.914362 (Thread-1): SQL status: SUCCESS 1 in 3.97 seconds
2020-05-24 08:03:24.914362 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:03:24.914362 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 08:03:26.913242 (Thread-1): SQL status: SUCCESS 3 in 1.99 seconds
2020-05-24 08:03:26.945436 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE_VIEW">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER_VIEW">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES_VIEW">]
2020-05-24 08:03:26.949437 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW"
2020-05-24 08:03:26.954804 (Thread-1): finished collecting timing info
2020-05-24 08:03:26.955865 (Thread-1): finished collecting timing info
2020-05-24 08:03:26.955865 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: ROLLBACK
2020-05-24 08:03:26.955865 (Thread-1): initiating rollback
2020-05-24 08:03:27.937543 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW
2020-05-24 08:03:27.944006 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-24 08:03:27.945004 (MainThread): Connection 'model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW' was left open.
2020-05-24 08:03:27.945004 (MainThread): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: Close
2020-05-24 08:03:28.821617 (MainThread): 13:33:28 | Done.
2020-05-24 08:03:28.823717 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED808E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED3F9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED3F898>]}
2020-05-24 08:03:28.824313 (MainThread): Flushing usage events
2020-05-24 08:04:00.436461 (MainThread): Running with dbt=0.16.1
2020-05-24 08:04:00.686490 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 08:04:01.071337 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_EMPLOYEE_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-24 08:04:01.072355 (MainThread): Tracking: tracking
2020-05-24 08:04:01.072355 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DCDC850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E58A340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E58A0B8>]}
2020-05-24 08:04:01.098611 (MainThread): Partial parsing not enabled
2020-05-24 08:04:01.106712 (MainThread): Parsing macros\core.sql
2020-05-24 08:04:01.114718 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 08:04:01.189657 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 08:04:01.206183 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 08:04:01.206183 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 08:04:01.211247 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 08:04:01.214414 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 08:04:01.216555 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 08:04:01.220499 (MainThread): Parsing macros\etc\query.sql
2020-05-24 08:04:01.220499 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 08:04:01.235981 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 08:04:01.257021 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 08:04:01.261038 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 08:04:01.269064 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 08:04:01.303302 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 08:04:01.353716 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 08:04:01.357718 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 08:04:01.386153 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 08:04:01.400426 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 08:04:01.408445 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 08:04:01.418637 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 08:04:01.422590 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 08:04:01.426590 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 08:04:01.428861 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 08:04:01.432810 (MainThread): Parsing macros\adapters.sql
2020-05-24 08:04:01.461187 (MainThread): Parsing macros\catalog.sql
2020-05-24 08:04:01.465145 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 08:04:01.481227 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 08:04:01.483367 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 08:04:01.487321 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 08:04:01.521525 (MainThread): Partial parsing not enabled
2020-05-24 08:04:01.568352 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 08:04:01.572295 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:04:01.606815 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 08:04:01.606815 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:04:01.616021 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:04:01.616021 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:04:01.629263 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 08:04:01.629263 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:04:01.980538 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 4 sources
2020-05-24 08:04:01.985548 (MainThread): 
2020-05-24 08:04:01.995879 (MainThread): Acquiring new snowflake connection "master".
2020-05-24 08:04:01.995879 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:04:02.011803 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 08:04:02.011803 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-24 08:04:02.212202 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 08:04:02.212202 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-24 08:04:03.812121 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 08:04:05.178871 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.97 seconds
2020-05-24 08:04:05.260275 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 08:04:05.261732 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-24 08:04:05.266937 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 08:04:05.270946 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-24 08:04:08.590715 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.32 seconds
2020-05-24 08:04:08.590715 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 08:04:08.590715 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 08:04:10.300760 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.71 seconds
2020-05-24 08:04:10.316841 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-24 08:04:10.316841 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-24 08:04:10.957258 (MainThread): Using snowflake connection "master".
2020-05-24 08:04:10.958259 (MainThread): On master: BEGIN
2020-05-24 08:04:14.427893 (MainThread): SQL status: SUCCESS 1 in 3.47 seconds
2020-05-24 08:04:14.427893 (MainThread): On master: COMMIT
2020-05-24 08:04:14.427893 (MainThread): Using snowflake connection "master".
2020-05-24 08:04:14.427893 (MainThread): On master: COMMIT
2020-05-24 08:04:15.247048 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2020-05-24 08:04:15.247048 (MainThread): 13:34:15 | Concurrency: 1 threads (target='dev')
2020-05-24 08:04:15.252314 (MainThread): 13:34:15 | 
2020-05-24 08:04:15.293585 (Thread-1): Began running node model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW
2020-05-24 08:04:15.294647 (Thread-1): 13:34:15 | 1 of 1 START incremental model ANALYTICS.TB_P_EMPLOYEE_VIEW.......... [RUN]
2020-05-24 08:04:15.320771 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:04:15.321761 (Thread-1): Opening a new connection, currently in state init
2020-05-24 08:04:15.322654 (Thread-1): Compiling model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW
2020-05-24 08:04:15.402895 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW"
2020-05-24 08:04:15.405246 (Thread-1): finished collecting timing info
2020-05-24 08:04:15.469183 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW"
2020-05-24 08:04:15.472324 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:04:15.472324 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: BEGIN
2020-05-24 08:04:19.755243 (Thread-1): SQL status: SUCCESS 1 in 4.28 seconds
2020-05-24 08:04:19.756247 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:04:19.756247 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_EMPLOYEE_VIEW  as
      (

Select 
    SRC:"Added By"::String as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    SRC:"Date of joining"::Date as DATE_OF_JOINING,
    SRC:"Department"::String as DEPARTMENT,
    SRC:"Email ID"::String as EMAIL_ID,
    SRC:"Employee Status"::String as EMPLOYEE_STATUS,
    SRC:"Employee Type"::String as EMPLOYEE_TYPE,
    SRC:"EmployeeID"::String as EMPLOYEE_ID,
    SRC:"First Name"::String as FIRST_NAME,
    SRC:"Last Name"::String as LAST_NAME,
    SRC:"Modified By"::String as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    SRC:"People Manager"::String as PEOPLE_MANAGER,
    SRC:"Photo"::String as PHOTO,
    SRC:"Photo_downloadUrl"::String as PHOTO_DOWNLOAD_URL,
    SRC:"Project"::String as PROJECT,
    SRC:"Title"::String as TITLE,
    SRC:"createdTime"::String as CREATED_TIME_INT,
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    SRC:"ownerID"::String as OWNER_ID,
    SRC:"ownerName"::String as OWNER_NAME,
    SRC:"recordId"::String as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_EMPLOYEEVIEW


      );
2020-05-24 08:04:22.621293 (Thread-1): SQL status: SUCCESS 1 in 2.86 seconds
2020-05-24 08:04:22.623811 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: COMMIT
2020-05-24 08:04:22.623811 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:04:22.623811 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: COMMIT
2020-05-24 08:04:23.097754 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-05-24 08:04:23.108628 (Thread-1): finished collecting timing info
2020-05-24 08:04:23.108628 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcaee52-8cc3-48f2-92e8-01d08493468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBA8418>]}
2020-05-24 08:04:23.108628 (Thread-1): 13:34:23 | 1 of 1 OK created incremental model ANALYTICS.TB_P_EMPLOYEE_VIEW..... [SUCCESS 1 in 7.79s]
2020-05-24 08:04:23.116462 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW
2020-05-24 08:04:23.120541 (MainThread): Using snowflake connection "master".
2020-05-24 08:04:23.121534 (MainThread): On master: BEGIN
2020-05-24 08:04:23.742097 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2020-05-24 08:04:23.742097 (MainThread): On master: COMMIT
2020-05-24 08:04:23.742097 (MainThread): Using snowflake connection "master".
2020-05-24 08:04:23.742097 (MainThread): On master: COMMIT
2020-05-24 08:04:24.464988 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2020-05-24 08:04:24.467572 (MainThread): 13:34:24 | 
2020-05-24 08:04:24.469155 (MainThread): 13:34:24 | Finished running 1 incremental model in 22.47s.
2020-05-24 08:04:24.530745 (MainThread): Connection 'master' was left open.
2020-05-24 08:04:24.532741 (MainThread): On master: Close
2020-05-24 08:04:25.695716 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-24 08:04:25.695716 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-24 08:04:26.724886 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-24 08:04:26.726246 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-24 08:04:27.737927 (MainThread): Connection 'model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW' was left open.
2020-05-24 08:04:27.738924 (MainThread): On model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW: Close
2020-05-24 08:04:28.538749 (MainThread): 
2020-05-24 08:04:28.542777 (MainThread): Completed successfully
2020-05-24 08:04:28.545774 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-24 08:04:28.573000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA29A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6841F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6F14D8>]}
2020-05-24 08:04:28.573998 (MainThread): Flushing usage events
2020-05-24 08:23:32.006684 (MainThread): Running with dbt=0.16.1
2020-05-24 08:23:32.251851 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 08:23:32.651429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_EMPLOYEEINACTIVE_VIEW'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-24 08:23:32.651429 (MainThread): Tracking: tracking
2020-05-24 08:23:32.651429 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E42BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ECDA028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ECDA088>]}
2020-05-24 08:23:32.686034 (MainThread): Partial parsing not enabled
2020-05-24 08:23:32.691120 (MainThread): Parsing macros\core.sql
2020-05-24 08:23:32.697084 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 08:23:32.773901 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 08:23:32.788677 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 08:23:32.788677 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 08:23:32.792695 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 08:23:32.796718 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 08:23:32.802888 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 08:23:32.802888 (MainThread): Parsing macros\etc\query.sql
2020-05-24 08:23:32.806836 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 08:23:32.821060 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 08:23:32.845146 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 08:23:32.847432 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 08:23:32.859404 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 08:23:32.898767 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 08:23:32.951099 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 08:23:32.954290 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 08:23:32.980719 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 08:23:32.992762 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 08:23:33.000785 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 08:23:33.014961 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 08:23:33.018961 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 08:23:33.018961 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 08:23:33.022996 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 08:23:33.022996 (MainThread): Parsing macros\adapters.sql
2020-05-24 08:23:33.060680 (MainThread): Parsing macros\catalog.sql
2020-05-24 08:23:33.064679 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 08:23:33.091135 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 08:23:33.095126 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 08:23:33.105320 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 08:23:33.152023 (MainThread): Partial parsing not enabled
2020-05-24 08:23:33.250666 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 08:23:33.250666 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:23:33.295065 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:23:33.295065 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:23:33.311971 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 08:23:33.311971 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:23:33.325338 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:23:33.325338 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:23:33.341528 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 08:23:33.341528 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:23:33.483478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EEA1D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EEA1C28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE581D8>]}
2020-05-24 08:23:33.483478 (MainThread): Flushing usage events
2020-05-24 08:23:35.458123 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-24 08:23:35.458123 (MainThread): Encountered an error:
2020-05-24 08:23:35.462826 (MainThread): Compilation Error in model TB_EMPLOYEEINACTIVE_VIEW (models\analytics\TB_EMPLOYEEINACTIVE_VIEW.sql)
  Model 'model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW' (models\analytics\TB_EMPLOYEEINACTIVE_VIEW.sql) depends on source 'ZOHO_PEOPLE_VIEW.TB_HIST_EMPLOYEEINACTIVEVIEW' which was not found
2020-05-24 08:23:35.552584 (MainThread): Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\main.py", line 212, in run_from_args
    results = task.run()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 351, in run
    self._runtime_initialize()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 107, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 75, in _runtime_initialize
    self.load_manifest()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\task\runnable.py", line 63, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 646, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 338, in load_all
    manifest = loader.create_manifest()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 323, in create_manifest
    self.process_manifest(manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 301, in process_manifest
    process_sources(manifest, project_name)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 587, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\parser\manifest.py", line 572, in _process_sources_for_node
    dbt.utils.invalid_source_fail_unless_test(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\utils.py", line 347, in invalid_source_fail_unless_test
    dbt.exceptions.source_target_not_found(node, target_name,
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\exceptions.py", line 502, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\exceptions.py", line 363, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model TB_EMPLOYEEINACTIVE_VIEW (models\analytics\TB_EMPLOYEEINACTIVE_VIEW.sql)
  Model 'model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW' (models\analytics\TB_EMPLOYEEINACTIVE_VIEW.sql) depends on source 'ZOHO_PEOPLE_VIEW.TB_HIST_EMPLOYEEINACTIVEVIEW' which was not found

2020-05-24 08:24:03.892103 (MainThread): Running with dbt=0.16.1
2020-05-24 08:24:04.172870 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 08:24:04.568440 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_EMPLOYEEINACTIVE_VIEW'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-24 08:24:04.568440 (MainThread): Tracking: tracking
2020-05-24 08:24:04.572387 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3ABBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC590B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC590E8>]}
2020-05-24 08:24:04.602818 (MainThread): Partial parsing not enabled
2020-05-24 08:24:04.606764 (MainThread): Parsing macros\core.sql
2020-05-24 08:24:04.614783 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 08:24:04.684719 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 08:24:04.700705 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 08:24:04.704707 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 08:24:04.707056 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 08:24:04.708012 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 08:24:04.712138 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 08:24:04.716139 (MainThread): Parsing macros\etc\query.sql
2020-05-24 08:24:04.718457 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 08:24:04.734460 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 08:24:04.752854 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 08:24:04.756789 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 08:24:04.770141 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 08:24:04.802602 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 08:24:04.855240 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 08:24:04.859235 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 08:24:04.893750 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 08:24:04.912041 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 08:24:04.928099 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 08:24:04.942104 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 08:24:04.951576 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 08:24:04.951576 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 08:24:04.955575 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 08:24:04.963633 (MainThread): Parsing macros\adapters.sql
2020-05-24 08:24:05.001940 (MainThread): Parsing macros\catalog.sql
2020-05-24 08:24:05.005983 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 08:24:05.020267 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 08:24:05.020267 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 08:24:05.026487 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 08:24:05.060679 (MainThread): Partial parsing not enabled
2020-05-24 08:24:05.114501 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 08:24:05.114501 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:05.143525 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:05.143525 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:05.155568 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 08:24:05.155568 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:05.166643 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:24:05.166643 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:05.177002 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 08:24:05.177002 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:05.491382 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 5 sources
2020-05-24 08:24:05.501052 (MainThread): 
2020-05-24 08:24:05.516537 (MainThread): 13:54:05 | Concurrency: 1 threads (target='dev')
2020-05-24 08:24:05.518532 (MainThread): 13:54:05 | 
2020-05-24 08:24:05.524664 (Thread-1): Began running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW
2020-05-24 08:24:05.525618 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:05.525618 (Thread-1): Opening a new connection, currently in state init
2020-05-24 08:24:05.525618 (Thread-1): Compiling model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW
2020-05-24 08:24:05.570650 (Thread-1): On "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-24 08:24:05.751445 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:05.751445 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: BEGIN
2020-05-24 08:24:07.547072 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 08:24:08.904495 (Thread-1): SQL status: SUCCESS 1 in 3.15 seconds
2020-05-24 08:24:08.904495 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:08.908566 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 08:24:10.272858 (Thread-1): SQL status: SUCCESS 4 in 1.36 seconds
2020-05-24 08:24:10.305031 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE_VIEW">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER_VIEW">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_EMPLOYEE_VIEW">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES_VIEW">]
2020-05-24 08:24:10.313035 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW"
2020-05-24 08:24:10.360118 (Thread-1): finished collecting timing info
2020-05-24 08:24:10.362371 (Thread-1): finished collecting timing info
2020-05-24 08:24:10.362371 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: ROLLBACK
2020-05-24 08:24:10.362371 (Thread-1): initiating rollback
2020-05-24 08:24:11.038457 (Thread-1): Finished running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW
2020-05-24 08:24:11.043605 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW' was properly closed.
2020-05-24 08:24:11.044603 (MainThread): Connection 'model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW' was left open.
2020-05-24 08:24:11.044603 (MainThread): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: Close
2020-05-24 08:24:11.928655 (MainThread): 13:54:11 | Done.
2020-05-24 08:24:11.931502 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE02EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDC8E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDC8EC8>]}
2020-05-24 08:24:11.932624 (MainThread): Flushing usage events
2020-05-24 08:24:29.418711 (MainThread): Running with dbt=0.16.1
2020-05-24 08:24:29.860713 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 08:24:30.376926 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_EMPLOYEEINACTIVE_VIEW'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-24 08:24:30.376926 (MainThread): Tracking: tracking
2020-05-24 08:24:30.376926 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFABA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E869358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E869058>]}
2020-05-24 08:24:30.410057 (MainThread): Partial parsing not enabled
2020-05-24 08:24:30.417722 (MainThread): Parsing macros\core.sql
2020-05-24 08:24:30.427148 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 08:24:30.499268 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 08:24:30.517146 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 08:24:30.521148 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 08:24:30.523467 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 08:24:30.528493 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 08:24:30.531637 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 08:24:30.533776 (MainThread): Parsing macros\etc\query.sql
2020-05-24 08:24:30.537728 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 08:24:30.553008 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 08:24:30.576954 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 08:24:30.581084 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 08:24:30.595420 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 08:24:30.637703 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 08:24:30.689701 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 08:24:30.692733 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 08:24:30.722272 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 08:24:30.732510 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 08:24:30.739721 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 08:24:30.749264 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 08:24:30.757274 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 08:24:30.757274 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 08:24:30.761375 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 08:24:30.761375 (MainThread): Parsing macros\adapters.sql
2020-05-24 08:24:30.790931 (MainThread): Parsing macros\catalog.sql
2020-05-24 08:24:30.796132 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 08:24:30.810403 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 08:24:30.813550 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 08:24:30.819642 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 08:24:30.848501 (MainThread): Partial parsing not enabled
2020-05-24 08:24:30.902198 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE_VIEW".
2020-05-24 08:24:30.902198 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:30.936028 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:30.936028 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:30.947350 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER_VIEW".
2020-05-24 08:24:30.947350 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:30.963106 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE_VIEW".
2020-05-24 08:24:30.963106 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:30.985990 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES_VIEW".
2020-05-24 08:24:30.985990 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:31.408029 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 5 sources
2020-05-24 08:24:31.421556 (MainThread): 
2020-05-24 08:24:31.431550 (MainThread): Acquiring new snowflake connection "master".
2020-05-24 08:24:31.432547 (MainThread): Opening a new connection, currently in state init
2020-05-24 08:24:31.449573 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 08:24:31.450572 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-24 08:24:31.704577 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 08:24:31.708646 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-24 08:24:33.184525 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 08:24:34.643853 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.93 seconds
2020-05-24 08:24:34.698553 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 08:24:34.698782 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-24 08:24:34.707506 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 08:24:34.707506 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-24 08:24:38.028278 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.32 seconds
2020-05-24 08:24:38.028278 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 08:24:38.028278 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 08:24:39.213244 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.18 seconds
2020-05-24 08:24:39.229424 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-24 08:24:39.229424 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-24 08:24:39.869614 (MainThread): Using snowflake connection "master".
2020-05-24 08:24:39.869614 (MainThread): On master: BEGIN
2020-05-24 08:24:43.041300 (MainThread): SQL status: SUCCESS 1 in 3.17 seconds
2020-05-24 08:24:43.041300 (MainThread): On master: COMMIT
2020-05-24 08:24:43.041300 (MainThread): Using snowflake connection "master".
2020-05-24 08:24:43.041300 (MainThread): On master: COMMIT
2020-05-24 08:24:43.757659 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2020-05-24 08:24:43.757659 (MainThread): 13:54:43 | Concurrency: 1 threads (target='dev')
2020-05-24 08:24:43.762805 (MainThread): 13:54:43 | 
2020-05-24 08:24:43.797490 (Thread-1): Began running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW
2020-05-24 08:24:43.797490 (Thread-1): 13:54:43 | 1 of 1 START incremental model ANALYTICS.TB_EMPLOYEEINACTIVE_VIEW.... [RUN]
2020-05-24 08:24:43.801502 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:43.804656 (Thread-1): Opening a new connection, currently in state init
2020-05-24 08:24:43.805696 (Thread-1): Compiling model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW
2020-05-24 08:24:43.889603 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW"
2020-05-24 08:24:43.889603 (Thread-1): finished collecting timing info
2020-05-24 08:24:43.982473 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW"
2020-05-24 08:24:44.030946 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:44.030946 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: BEGIN
2020-05-24 08:24:46.748490 (Thread-1): SQL status: SUCCESS 1 in 2.72 seconds
2020-05-24 08:24:46.748490 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:46.752579 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_EMPLOYEEINACTIVE_VIEW  as
      (

Select 
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    SRC:"Date of joining (dd-MMM-yyyy)"::Date as DATE_OF_JOINING,
    SRC:"Department"::String as DEPARTMENT,
    SRC:"Email ID"::String as EMAIL_ID,
    SRC:"Employee Status"::String as EMPLOYEE_STATUS,
    SRC:"EmployeeID"::String as EMPLOYEE_ID,
    SRC:"First Name"::String as FIRST_NAME,
    SRC:"Last Name"::String as LAST_NAME,
    SRC:"Reporting To"::String as REPORTING_TO,
    SRC:"Title"::String as TITLE,
    SRC:"createdTime"::String as CREATED_TIME_INT,
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::String as OWNERID,
    SRC:"ownerName"::String as OWNERNAME,
    SRC:"recordId"::String as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_EMPLOYEEINACTIVEVIEW


      );
2020-05-24 08:24:48.686523 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2020-05-24 08:24:48.687520 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: COMMIT
2020-05-24 08:24:48.687520 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW".
2020-05-24 08:24:48.691612 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: COMMIT
2020-05-24 08:24:49.102546 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-05-24 08:24:49.111093 (Thread-1): finished collecting timing info
2020-05-24 08:24:49.116370 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb6061b6-582b-4b27-a3b7-4bfa3b16c211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDF2D00>]}
2020-05-24 08:24:49.117258 (Thread-1): 13:54:49 | 1 of 1 OK created incremental model ANALYTICS.TB_EMPLOYEEINACTIVE_VIEW [SUCCESS 1 in 5.31s]
2020-05-24 08:24:49.122586 (Thread-1): Finished running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW
2020-05-24 08:24:49.126133 (MainThread): Using snowflake connection "master".
2020-05-24 08:24:49.126133 (MainThread): On master: BEGIN
2020-05-24 08:24:49.620960 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2020-05-24 08:24:49.620960 (MainThread): On master: COMMIT
2020-05-24 08:24:49.621957 (MainThread): Using snowflake connection "master".
2020-05-24 08:24:49.621957 (MainThread): On master: COMMIT
2020-05-24 08:24:50.352951 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2020-05-24 08:24:50.354953 (MainThread): 13:54:50 | 
2020-05-24 08:24:50.355946 (MainThread): 13:54:50 | Finished running 1 incremental model in 18.92s.
2020-05-24 08:24:50.355946 (MainThread): Connection 'master' was left open.
2020-05-24 08:24:50.355946 (MainThread): On master: Close
2020-05-24 08:24:51.096324 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-24 08:24:51.097412 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-24 08:24:51.850145 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-24 08:24:51.850145 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-24 08:24:52.575042 (MainThread): Connection 'model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW' was left open.
2020-05-24 08:24:52.575042 (MainThread): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE_VIEW: Close
2020-05-24 08:24:53.666520 (MainThread): 
2020-05-24 08:24:53.668716 (MainThread): Completed successfully
2020-05-24 08:24:53.671750 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-24 08:24:53.705826 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA32C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA32E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA32F10>]}
2020-05-24 08:24:53.706823 (MainThread): Flushing usage events
2020-05-24 11:05:22.600907 (MainThread): Running with dbt=0.16.1
2020-05-24 11:05:22.901407 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 11:05:23.528928 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-24 11:05:23.530648 (MainThread): Tracking: tracking
2020-05-24 11:05:23.530648 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E43BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ECE9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ECE90A0>]}
2020-05-24 11:05:23.570272 (MainThread): Partial parsing not enabled
2020-05-24 11:05:23.580589 (MainThread): Parsing macros\core.sql
2020-05-24 11:05:23.591751 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 11:05:23.687615 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 11:05:23.703613 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 11:05:23.707602 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 11:05:23.707602 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 11:05:23.711661 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 11:05:23.715644 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 11:05:23.719644 (MainThread): Parsing macros\etc\query.sql
2020-05-24 11:05:23.719644 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 11:05:23.735779 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 11:05:23.755780 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 11:05:23.761017 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 11:05:23.771217 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 11:05:23.802555 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 11:05:23.869049 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 11:05:23.873082 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 11:05:23.907608 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 11:05:23.923663 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 11:05:23.939745 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 11:05:23.963858 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 11:05:23.967854 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 11:05:23.971963 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 11:05:23.975919 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 11:05:23.979921 (MainThread): Parsing macros\adapters.sql
2020-05-24 11:05:24.029271 (MainThread): Parsing macros\catalog.sql
2020-05-24 11:05:24.033361 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 11:05:24.052171 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 11:05:24.055364 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 11:05:24.063755 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 11:05:24.097391 (MainThread): Partial parsing not enabled
2020-05-24 11:05:24.149655 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-24 11:05:24.149655 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:24.185752 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-24 11:05:24.185752 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:24.197050 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-24 11:05:24.197050 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:24.209195 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:05:24.209195 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:24.219391 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-24 11:05:24.219391 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:24.231438 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-24 11:05:24.231438 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:24.625245 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-24 11:05:24.639331 (MainThread): 
2020-05-24 11:05:24.646993 (MainThread): 16:35:24 | Concurrency: 1 threads (target='dev')
2020-05-24 11:05:24.648994 (MainThread): 16:35:24 | 
2020-05-24 11:05:24.655195 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:05:24.656240 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:05:24.656240 (Thread-1): Opening a new connection, currently in state init
2020-05-24 11:05:24.656240 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:05:24.710420 (Thread-1): On "model.vbi_zoho_people.TB_P_APPLY_LEAVE": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-24 11:05:24.938209 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:05:24.938209 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-24 11:05:27.465161 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 11:05:29.060196 (Thread-1): SQL status: SUCCESS 1 in 4.12 seconds
2020-05-24 11:05:29.060196 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:05:29.060196 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 11:05:31.311884 (Thread-1): SQL status: SUCCESS 5 in 2.25 seconds
2020-05-24 11:05:31.363192 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_EMPLOYEEINACTIVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_EMPLOYEE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES">]
2020-05-24 11:05:31.367191 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:05:31.374219 (Thread-1): finished collecting timing info
2020-05-24 11:05:31.375223 (Thread-1): finished collecting timing info
2020-05-24 11:05:31.375223 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-24 11:05:31.375223 (Thread-1): initiating rollback
2020-05-24 11:05:32.111343 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:05:32.118178 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES' was properly closed.
2020-05-24 11:05:32.118178 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-24 11:05:32.119174 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-24 11:05:33.173185 (MainThread): 16:35:33 | Done.
2020-05-24 11:05:33.175180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE8E448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDCF700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDCFFE8>]}
2020-05-24 11:05:33.176224 (MainThread): Flushing usage events
2020-05-24 11:05:57.628043 (MainThread): Running with dbt=0.16.1
2020-05-24 11:05:57.915607 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 11:05:58.314426 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-24 11:05:58.314426 (MainThread): Tracking: tracking
2020-05-24 11:05:58.314426 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D70BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFBA328>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFBA058>]}
2020-05-24 11:05:58.346943 (MainThread): Partial parsing not enabled
2020-05-24 11:05:58.350898 (MainThread): Parsing macros\core.sql
2020-05-24 11:05:58.358944 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 11:05:58.430261 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 11:05:58.444048 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 11:05:58.447998 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 11:05:58.447998 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 11:05:58.451999 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 11:05:58.456106 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 11:05:58.460038 (MainThread): Parsing macros\etc\query.sql
2020-05-24 11:05:58.460038 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 11:05:58.474254 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 11:05:58.494337 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 11:05:58.498340 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 11:05:58.510393 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 11:05:58.544187 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 11:05:58.593507 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 11:05:58.598333 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 11:05:58.623624 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 11:05:58.635667 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 11:05:58.643622 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 11:05:58.655673 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 11:05:58.659699 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 11:05:58.659699 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 11:05:58.659699 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 11:05:58.663717 (MainThread): Parsing macros\adapters.sql
2020-05-24 11:05:58.692349 (MainThread): Parsing macros\catalog.sql
2020-05-24 11:05:58.699400 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 11:05:58.714587 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 11:05:58.714587 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 11:05:58.722627 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 11:05:58.755847 (MainThread): Partial parsing not enabled
2020-05-24 11:05:58.806583 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-24 11:05:58.806583 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:58.839614 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-24 11:05:58.839614 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:58.847746 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-24 11:05:58.847746 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:58.859790 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:05:58.859790 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:58.871837 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-24 11:05:58.871837 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:58.883877 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-24 11:05:58.883877 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:59.210194 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-24 11:05:59.215239 (MainThread): 
2020-05-24 11:05:59.218896 (MainThread): Acquiring new snowflake connection "master".
2020-05-24 11:05:59.218896 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:05:59.234081 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 11:05:59.235073 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-24 11:05:59.403565 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 11:05:59.403565 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-24 11:06:01.286801 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 11:06:02.850334 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.45 seconds
2020-05-24 11:06:02.980116 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:06:02.982151 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-24 11:06:02.991269 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:06:02.991269 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-24 11:06:06.129132 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.14 seconds
2020-05-24 11:06:06.129132 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:06:06.129132 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 11:06:07.767639 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.64 seconds
2020-05-24 11:06:07.791723 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-24 11:06:07.791723 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-24 11:06:08.384913 (MainThread): Using snowflake connection "master".
2020-05-24 11:06:08.384913 (MainThread): On master: BEGIN
2020-05-24 11:06:11.232367 (MainThread): SQL status: SUCCESS 1 in 2.85 seconds
2020-05-24 11:06:11.232367 (MainThread): On master: COMMIT
2020-05-24 11:06:11.232367 (MainThread): Using snowflake connection "master".
2020-05-24 11:06:11.232367 (MainThread): On master: COMMIT
2020-05-24 11:06:11.863581 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2020-05-24 11:06:11.864622 (MainThread): 16:36:11 | Concurrency: 1 threads (target='dev')
2020-05-24 11:06:11.867041 (MainThread): 16:36:11 | 
2020-05-24 11:06:11.878934 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:06:11.878934 (Thread-1): 16:36:11 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-24 11:06:11.906565 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:06:11.907832 (Thread-1): Opening a new connection, currently in state init
2020-05-24 11:06:11.908831 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:06:11.999563 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:06:12.004665 (Thread-1): finished collecting timing info
2020-05-24 11:06:12.096952 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:06:12.103453 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:06:12.143312 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-24 11:06:15.141615 (Thread-1): SQL status: SUCCESS 1 in 3.00 seconds
2020-05-24 11:06:15.142334 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:06:15.142334 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (
select
    SRC:"Added By"::String as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    TRY_CAST(SRC:"ApprovalTime"::String as timestamp) as APPROVED_TIME,
    --TO_TIMESTAMP((SRC:"ApprovalTime")::String, 'DD-MON-YYYY HH12:MI AM') as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    TRY_CAST(SRC:"DOR"::String as Date) as DATE_OF_RESIGNATION,
    TRY_CAST(SRC:"Date - Time for WFH"::String  as timestamp) as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::String as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::String as LEAVE_TYPE,
    SRC:"Medical certificate"::String,
    SRC:"Medical certificate_downloadUrl"::String,
    SRC:"Modified By"::String as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::String as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::String as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::String as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::String as CREATED_TIME_INT,
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    SRC:"ownerID"::String as OWNERID,
    SRC:"ownerName"::String as OWNERNAME,
    SRC:"recordId"::String as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-24 11:06:15.719835 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.43.142', 61656), raddr=('52.184.166.117', 443)>
2020-05-24 11:06:15.722374 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2020-05-24 11:06:15.723372 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-24 11:06:15.723372 (Thread-1): initiating rollback
2020-05-24 11:06:17.508014 (Thread-1): finished collecting timing info
2020-05-24 11:06:17.512085 (Thread-1): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-24 11:06:17.532374 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60d116e-7add-4143-8228-d6861d9d7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0A80B8>]}
2020-05-24 11:06:17.536618 (Thread-1): 16:36:17 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLY_LEAVE... [ERROR in 5.63s]
2020-05-24 11:06:17.540432 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:06:17.545752 (MainThread): Using snowflake connection "master".
2020-05-24 11:06:17.545752 (MainThread): On master: BEGIN
2020-05-24 11:06:18.020074 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2020-05-24 11:06:18.020074 (MainThread): On master: COMMIT
2020-05-24 11:06:18.020074 (MainThread): Using snowflake connection "master".
2020-05-24 11:06:18.020074 (MainThread): On master: COMMIT
2020-05-24 11:06:18.589162 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2020-05-24 11:06:18.590160 (MainThread): 16:36:18 | 
2020-05-24 11:06:18.595127 (MainThread): 16:36:18 | Finished running 1 incremental model in 19.37s.
2020-05-24 11:06:18.598112 (MainThread): Connection 'master' was left open.
2020-05-24 11:06:18.599111 (MainThread): On master: Close
2020-05-24 11:06:19.424201 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-24 11:06:19.424201 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-24 11:06:20.262278 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-24 11:06:20.262278 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-24 11:06:21.080322 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-24 11:06:21.084329 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-24 11:06:21.917052 (MainThread): 
2020-05-24 11:06:21.917052 (MainThread): Completed with 1 error and 0 warnings:
2020-05-24 11:06:21.946532 (MainThread): 
2020-05-24 11:06:21.952351 (MainThread): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
2020-05-24 11:06:21.953392 (MainThread):   002022 (42601): SQL compilation error:
2020-05-24 11:06:21.988998 (MainThread):   Missing column specification
2020-05-24 11:06:21.992275 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-24 11:06:21.994766 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-24 11:06:21.996968 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E52E6B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E52E5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E52E610>]}
2020-05-24 11:06:21.996968 (MainThread): Flushing usage events
2020-05-24 11:07:39.261849 (MainThread): Running with dbt=0.16.1
2020-05-24 11:07:39.567147 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 11:07:40.000401 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-24 11:07:40.000401 (MainThread): Tracking: tracking
2020-05-24 11:07:40.000401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE6BB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E71A430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E71A160>]}
2020-05-24 11:07:40.038588 (MainThread): Partial parsing not enabled
2020-05-24 11:07:40.044987 (MainThread): Parsing macros\core.sql
2020-05-24 11:07:40.054224 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 11:07:40.156147 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 11:07:40.174557 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 11:07:40.178510 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 11:07:40.178510 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 11:07:40.182510 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 11:07:40.186578 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 11:07:40.190517 (MainThread): Parsing macros\etc\query.sql
2020-05-24 11:07:40.194517 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 11:07:40.208451 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 11:07:40.240417 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 11:07:40.244501 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 11:07:40.257520 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 11:07:40.306040 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 11:07:40.390524 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 11:07:40.394538 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 11:07:40.424853 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 11:07:40.440808 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 11:07:40.448896 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 11:07:40.463063 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 11:07:40.467064 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 11:07:40.467064 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 11:07:40.471078 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 11:07:40.475070 (MainThread): Parsing macros\adapters.sql
2020-05-24 11:07:40.522157 (MainThread): Parsing macros\catalog.sql
2020-05-24 11:07:40.526404 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 11:07:40.545501 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 11:07:40.545501 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 11:07:40.555793 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 11:07:40.593751 (MainThread): Partial parsing not enabled
2020-05-24 11:07:40.656267 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-24 11:07:40.657264 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:07:40.691407 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-24 11:07:40.691407 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:07:40.706905 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-24 11:07:40.707908 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:07:40.720035 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:07:40.721084 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:07:40.733933 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-24 11:07:40.733933 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:07:40.748040 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-24 11:07:40.748040 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:07:41.096566 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-24 11:07:41.105152 (MainThread): 
2020-05-24 11:07:41.115652 (MainThread): 16:37:41 | Concurrency: 1 threads (target='dev')
2020-05-24 11:07:41.116646 (MainThread): 16:37:41 | 
2020-05-24 11:07:41.123530 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:07:41.123530 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:07:41.123530 (Thread-1): Opening a new connection, currently in state init
2020-05-24 11:07:41.123530 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:07:41.162444 (Thread-1): On "model.vbi_zoho_people.TB_P_APPLY_LEAVE": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-24 11:07:41.408975 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:07:41.408975 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-24 11:07:43.348491 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 11:07:44.670539 (Thread-1): SQL status: SUCCESS 1 in 3.26 seconds
2020-05-24 11:07:44.670539 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:07:44.670539 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 11:07:46.069883 (Thread-1): SQL status: SUCCESS 5 in 1.40 seconds
2020-05-24 11:07:46.109441 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_EMPLOYEEINACTIVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_EMPLOYEE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES">]
2020-05-24 11:07:46.117441 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:07:46.119819 (Thread-1): finished collecting timing info
2020-05-24 11:07:46.121164 (Thread-1): finished collecting timing info
2020-05-24 11:07:46.122203 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-24 11:07:46.122203 (Thread-1): initiating rollback
2020-05-24 11:07:46.891679 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:07:46.896780 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES' was properly closed.
2020-05-24 11:07:46.897818 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-24 11:07:46.897818 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-24 11:07:48.140253 (MainThread): 16:37:48 | Done.
2020-05-24 11:07:48.141355 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8CDB98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7FEDD8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7FEE68>]}
2020-05-24 11:07:48.142668 (MainThread): Flushing usage events
2020-05-24 11:08:00.087304 (MainThread): Running with dbt=0.16.1
2020-05-24 11:08:00.365435 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 11:08:00.769360 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-24 11:08:00.769360 (MainThread): Tracking: tracking
2020-05-24 11:08:00.769360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DC8BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E539070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5390D0>]}
2020-05-24 11:08:00.820131 (MainThread): Partial parsing not enabled
2020-05-24 11:08:00.832122 (MainThread): Parsing macros\core.sql
2020-05-24 11:08:00.845742 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 11:08:00.916874 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 11:08:00.932916 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 11:08:00.937044 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 11:08:00.937044 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 11:08:00.940961 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 11:08:00.944958 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 11:08:00.947212 (MainThread): Parsing macros\etc\query.sql
2020-05-24 11:08:00.951285 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 11:08:00.961591 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 11:08:00.981689 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 11:08:00.985684 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 11:08:00.997722 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 11:08:01.030161 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 11:08:01.109434 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 11:08:01.113432 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 11:08:01.141968 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 11:08:01.154832 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 11:08:01.162618 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 11:08:01.172827 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 11:08:01.211643 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 11:08:01.215714 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 11:08:01.219705 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 11:08:01.227707 (MainThread): Parsing macros\adapters.sql
2020-05-24 11:08:01.298347 (MainThread): Parsing macros\catalog.sql
2020-05-24 11:08:01.310355 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 11:08:01.336991 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 11:08:01.340993 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 11:08:01.344982 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 11:08:01.379194 (MainThread): Partial parsing not enabled
2020-05-24 11:08:01.431828 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-24 11:08:01.431828 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:08:01.468531 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-24 11:08:01.468531 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:08:01.476574 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-24 11:08:01.476574 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:08:01.488686 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:08:01.488686 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:08:01.498972 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-24 11:08:01.502934 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:08:01.511001 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-24 11:08:01.511001 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:08:01.890416 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-24 11:08:01.896970 (MainThread): 
2020-05-24 11:08:01.907296 (MainThread): Acquiring new snowflake connection "master".
2020-05-24 11:08:01.908293 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:08:01.925629 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 11:08:01.926804 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-24 11:08:02.140005 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 11:08:02.140005 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-24 11:08:03.715454 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 11:08:05.365459 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.23 seconds
2020-05-24 11:08:05.469240 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:08:05.471808 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-24 11:08:05.476928 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:08:05.476928 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-24 11:08:08.396675 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.92 seconds
2020-05-24 11:08:08.396675 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:08:08.396675 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 11:08:09.624502 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.23 seconds
2020-05-24 11:08:09.644670 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-24 11:08:09.644670 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-24 11:08:10.652880 (MainThread): Using snowflake connection "master".
2020-05-24 11:08:10.652880 (MainThread): On master: BEGIN
2020-05-24 11:08:13.337739 (MainThread): SQL status: SUCCESS 1 in 2.68 seconds
2020-05-24 11:08:13.337739 (MainThread): On master: COMMIT
2020-05-24 11:08:13.338744 (MainThread): Using snowflake connection "master".
2020-05-24 11:08:13.338744 (MainThread): On master: COMMIT
2020-05-24 11:08:13.937302 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-24 11:08:13.937302 (MainThread): 16:38:13 | Concurrency: 1 threads (target='dev')
2020-05-24 11:08:13.941344 (MainThread): 16:38:13 | 
2020-05-24 11:08:13.953204 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:08:13.954203 (Thread-1): 16:38:13 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-24 11:08:13.986060 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:08:13.987067 (Thread-1): Opening a new connection, currently in state init
2020-05-24 11:08:13.987067 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:08:14.084063 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:08:14.090499 (Thread-1): finished collecting timing info
2020-05-24 11:08:14.191948 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:08:14.194338 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:08:14.194338 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-24 11:08:17.585056 (Thread-1): SQL status: SUCCESS 1 in 3.39 seconds
2020-05-24 11:08:17.585056 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:08:17.585056 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (
select
    SRC:"Added By"::String as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    TRY_CAST(SRC:"ApprovalTime"::String as timestamp) as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    TRY_CAST(SRC:"DOR"::String as Date) as DATE_OF_RESIGNATION,
    TRY_CAST(SRC:"Date - Time for WFH"::String  as timestamp) as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::String as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::String as LEAVE_TYPE,
    SRC:"Medical certificate"::String,
    SRC:"Medical certificate_downloadUrl"::String,
    SRC:"Modified By"::String as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::String as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::String as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::String as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::String as CREATED_TIME_INT,
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    SRC:"ownerID"::String as OWNERID,
    SRC:"ownerName"::String as OWNERNAME,
    SRC:"recordId"::String as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-24 11:08:18.228323 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2020-05-24 11:08:18.228323 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-24 11:08:18.228323 (Thread-1): initiating rollback
2020-05-24 11:08:18.839519 (Thread-1): finished collecting timing info
2020-05-24 11:08:18.843590 (Thread-1): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-24 11:08:18.863593 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d8a6ace-158e-407f-8f2c-baada5b6f831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EAAF688>]}
2020-05-24 11:08:18.863593 (Thread-1): 16:38:18 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLY_LEAVE... [ERROR in 4.87s]
2020-05-24 11:08:18.868924 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:08:18.873604 (MainThread): Using snowflake connection "master".
2020-05-24 11:08:18.916320 (MainThread): On master: BEGIN
2020-05-24 11:08:19.388616 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2020-05-24 11:08:19.388616 (MainThread): On master: COMMIT
2020-05-24 11:08:19.388616 (MainThread): Using snowflake connection "master".
2020-05-24 11:08:19.388616 (MainThread): On master: COMMIT
2020-05-24 11:08:20.275872 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2020-05-24 11:08:20.279540 (MainThread): 16:38:20 | 
2020-05-24 11:08:20.281666 (MainThread): 16:38:20 | Finished running 1 incremental model in 18.37s.
2020-05-24 11:08:20.283287 (MainThread): Connection 'master' was left open.
2020-05-24 11:08:20.284285 (MainThread): On master: Close
2020-05-24 11:08:21.378614 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-24 11:08:21.378614 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-24 11:08:22.530295 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-24 11:08:22.530295 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-24 11:08:23.760493 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-24 11:08:23.760493 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-24 11:08:25.008040 (MainThread): 
2020-05-24 11:08:25.009174 (MainThread): Completed with 1 error and 0 warnings:
2020-05-24 11:08:25.013219 (MainThread): 
2020-05-24 11:08:25.014672 (MainThread): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
2020-05-24 11:08:25.017919 (MainThread):   002022 (42601): SQL compilation error:
2020-05-24 11:08:25.020517 (MainThread):   Missing column specification
2020-05-24 11:08:25.089625 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-24 11:08:25.144570 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-24 11:08:25.148266 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6B28F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6A4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6A49E8>]}
2020-05-24 11:08:25.149297 (MainThread): Flushing usage events
2020-05-24 11:20:46.663033 (MainThread): Running with dbt=0.16.1
2020-05-24 11:20:46.936970 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-24 11:20:47.370687 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-24 11:20:47.370687 (MainThread): Tracking: tracking
2020-05-24 11:20:47.370687 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DDABAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E659040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E659070>]}
2020-05-24 11:20:47.422433 (MainThread): Partial parsing not enabled
2020-05-24 11:20:47.434442 (MainThread): Parsing macros\core.sql
2020-05-24 11:20:47.446495 (MainThread): Parsing macros\adapters\common.sql
2020-05-24 11:20:47.546428 (MainThread): Parsing macros\etc\datetime.sql
2020-05-24 11:20:47.562472 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-24 11:20:47.566487 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-24 11:20:47.566487 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-24 11:20:47.570514 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-24 11:20:47.574514 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-24 11:20:47.576746 (MainThread): Parsing macros\etc\query.sql
2020-05-24 11:20:47.580774 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-24 11:20:47.592823 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-24 11:20:47.612146 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-24 11:20:47.616197 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-24 11:20:47.628241 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-24 11:20:47.670818 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-24 11:20:47.755327 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-24 11:20:47.758466 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-24 11:20:47.793188 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-24 11:20:47.809245 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-24 11:20:47.823495 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-24 11:20:47.839584 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-24 11:20:47.847613 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-24 11:20:47.851647 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-24 11:20:47.855649 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-24 11:20:47.857891 (MainThread): Parsing macros\adapters.sql
2020-05-24 11:20:47.896307 (MainThread): Parsing macros\catalog.sql
2020-05-24 11:20:47.900306 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-24 11:20:47.916364 (MainThread): Parsing macros\materializations\merge.sql
2020-05-24 11:20:47.916364 (MainThread): Parsing macros\materializations\table.sql
2020-05-24 11:20:47.926432 (MainThread): Parsing macros\materializations\view.sql
2020-05-24 11:20:47.957843 (MainThread): Partial parsing not enabled
2020-05-24 11:20:48.010330 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-24 11:20:48.010330 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:20:48.044714 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-24 11:20:48.044714 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:20:48.056760 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-24 11:20:48.056760 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:20:48.064781 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:20:48.064781 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:20:48.076142 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-24 11:20:48.076142 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:20:48.088214 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-24 11:20:48.088214 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:20:48.428652 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-24 11:20:48.436211 (MainThread): 
2020-05-24 11:20:48.448440 (MainThread): Acquiring new snowflake connection "master".
2020-05-24 11:20:48.448440 (MainThread): Opening a new connection, currently in state init
2020-05-24 11:20:48.462851 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 11:20:48.462851 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-24 11:20:48.662171 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-24 11:20:48.662171 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-24 11:20:49.896204 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-24 11:20:51.109235 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.45 seconds
2020-05-24 11:20:51.232525 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:20:51.233524 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-24 11:20:51.237577 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:20:51.237577 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-24 11:20:53.607725 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.37 seconds
2020-05-24 11:20:53.607725 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-24 11:20:53.609863 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-24 11:20:55.792832 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 2.18 seconds
2020-05-24 11:20:55.817006 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-24 11:20:55.817006 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-24 11:20:56.612109 (MainThread): Using snowflake connection "master".
2020-05-24 11:20:56.616417 (MainThread): On master: BEGIN
2020-05-24 11:20:59.481064 (MainThread): SQL status: SUCCESS 1 in 2.86 seconds
2020-05-24 11:20:59.482174 (MainThread): On master: COMMIT
2020-05-24 11:20:59.482174 (MainThread): Using snowflake connection "master".
2020-05-24 11:20:59.483291 (MainThread): On master: COMMIT
2020-05-24 11:21:00.502648 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2020-05-24 11:21:00.502648 (MainThread): 16:51:00 | Concurrency: 1 threads (target='dev')
2020-05-24 11:21:00.504642 (MainThread): 16:51:00 | 
2020-05-24 11:21:00.510703 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:21:00.510703 (Thread-1): 16:51:00 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-24 11:21:00.524692 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:21:00.524692 (Thread-1): Opening a new connection, currently in state init
2020-05-24 11:21:00.524692 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:21:00.576257 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:21:00.576257 (Thread-1): finished collecting timing info
2020-05-24 11:21:00.672062 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-24 11:21:00.676125 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:21:00.676125 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-24 11:21:03.996225 (Thread-1): SQL status: SUCCESS 1 in 3.32 seconds
2020-05-24 11:21:03.996225 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:21:03.996225 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (
select
    SRC:"Added By"::String as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    TRY_CAST(SRC:"ApprovalTime"::String as timestamp) as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    TRY_CAST(SRC:"DOR"::String as Date) as DATE_OF_RESIGNATION,
    TRY_CAST(SRC:"Date - Time for WFH"::String  as timestamp) as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::String as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::String as LEAVE_TYPE,
    SRC:"Medical certificate"::String as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::String as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::String as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::String as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::String as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::String as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::String as CREATED_TIME_INT,
    SRC:"modifiedTime"::String as MODIFIED_TIME_INT,
    SRC:"ownerID"::String as OWNERID,
    SRC:"ownerName"::String as OWNERNAME,
    SRC:"recordId"::String as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-24 11:21:07.070328 (Thread-1): SQL status: SUCCESS 1 in 3.07 seconds
2020-05-24 11:21:07.074314 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-24 11:21:07.074314 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-24 11:21:07.074314 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-24 11:21:07.667390 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-24 11:21:07.675419 (Thread-1): finished collecting timing info
2020-05-24 11:21:07.678410 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a53f8091-6e1a-40ef-9874-a4fdcf39e6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBCFC88>]}
2020-05-24 11:21:07.679408 (Thread-1): 16:51:07 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLY_LEAVE....... [SUCCESS 1 in 7.16s]
2020-05-24 11:21:07.683931 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-24 11:21:07.687800 (MainThread): Using snowflake connection "master".
2020-05-24 11:21:07.688875 (MainThread): On master: BEGIN
2020-05-24 11:21:08.490404 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2020-05-24 11:21:08.490404 (MainThread): On master: COMMIT
2020-05-24 11:21:08.490404 (MainThread): Using snowflake connection "master".
2020-05-24 11:21:08.490404 (MainThread): On master: COMMIT
2020-05-24 11:21:09.096805 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-24 11:21:09.100753 (MainThread): 16:51:09 | 
2020-05-24 11:21:09.102517 (MainThread): 16:51:09 | Finished running 1 incremental model in 20.65s.
2020-05-24 11:21:09.105225 (MainThread): Connection 'master' was left open.
2020-05-24 11:21:09.106229 (MainThread): On master: Close
2020-05-24 11:21:09.883173 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-24 11:21:09.887170 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-24 11:21:10.950959 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-24 11:21:10.950959 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-24 11:21:11.976211 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-24 11:21:11.976211 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-24 11:21:12.808592 (MainThread): 
2020-05-24 11:21:12.812552 (MainThread): Completed successfully
2020-05-24 11:21:12.816551 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-24 11:21:12.845305 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E760E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7C4898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7C4988>]}
2020-05-24 11:21:12.847398 (MainThread): Flushing usage events
2020-05-28 09:57:45.360837 (MainThread): Running with dbt=0.16.1
2020-05-28 09:57:45.775813 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 09:57:46.830514 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-28 09:57:46.834521 (MainThread): Tracking: tracking
2020-05-28 09:57:46.834521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE6BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E719028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E719058>]}
2020-05-28 09:57:46.868191 (MainThread): Partial parsing not enabled
2020-05-28 09:57:46.874652 (MainThread): Parsing macros\core.sql
2020-05-28 09:57:46.885813 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 09:57:46.957772 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 09:57:46.972348 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 09:57:46.977813 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 09:57:46.980275 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 09:57:46.984166 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 09:57:46.985164 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 09:57:46.989214 (MainThread): Parsing macros\etc\query.sql
2020-05-28 09:57:46.993215 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 09:57:47.005214 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 09:57:47.026322 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 09:57:47.030323 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 09:57:47.044317 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 09:57:47.077450 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 09:57:47.135673 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 09:57:47.140757 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 09:57:47.176803 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 09:57:47.188803 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 09:57:47.200803 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 09:57:47.215214 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 09:57:47.219218 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 09:57:47.219218 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 09:57:47.223218 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 09:57:47.227218 (MainThread): Parsing macros\adapters.sql
2020-05-28 09:57:47.260294 (MainThread): Parsing macros\catalog.sql
2020-05-28 09:57:47.264340 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 09:57:47.284340 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 09:57:47.288340 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 09:57:47.296340 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 09:57:47.329271 (MainThread): Partial parsing not enabled
2020-05-28 09:57:47.476187 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 09:57:47.476187 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:57:47.629922 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 09:57:47.630966 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:57:47.663030 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 09:57:47.663030 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:57:47.695031 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:57:47.695031 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:57:47.726984 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 09:57:47.726984 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:57:47.758984 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 09:57:47.758984 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:57:48.250406 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 09:57:48.261902 (MainThread): 
2020-05-28 09:57:48.263088 (MainThread): 15:27:48 | Concurrency: 1 threads (target='dev')
2020-05-28 09:57:48.263088 (MainThread): 15:27:48 | 
2020-05-28 09:57:48.275508 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 09:57:48.276506 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:57:48.276506 (Thread-1): Opening a new connection, currently in state init
2020-05-28 09:57:48.276506 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 09:57:48.322752 (Thread-1): On "model.vbi_zoho_people.TB_P_APPLY_LEAVE": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-28 09:57:48.520090 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:57:48.521078 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 09:57:50.874688 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 09:57:53.174647 (Thread-1): SQL status: SUCCESS 1 in 4.65 seconds
2020-05-28 09:57:53.174647 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:57:53.175645 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 09:57:54.413028 (Thread-1): SQL status: SUCCESS 6 in 1.24 seconds
2020-05-28 09:57:54.454376 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_EMPLOYEEINACTIVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_APPLY_LEAVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_EMPLOYEE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES">]
2020-05-28 09:57:54.458494 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 09:57:54.465556 (Thread-1): finished collecting timing info
2020-05-28 09:57:54.466073 (Thread-1): finished collecting timing info
2020-05-28 09:57:54.467125 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-28 09:57:54.467125 (Thread-1): initiating rollback
2020-05-28 09:57:55.435987 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 09:57:55.442309 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES' was properly closed.
2020-05-28 09:57:55.442309 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 09:57:55.443310 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 09:57:56.683614 (MainThread): 15:27:56 | Done.
2020-05-28 09:57:56.684843 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E828118>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E808538>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E808C40>]}
2020-05-28 09:57:56.685970 (MainThread): Flushing usage events
2020-05-28 09:58:48.071806 (MainThread): Running with dbt=0.16.1
2020-05-28 09:58:48.324770 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 09:58:48.710307 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 09:58:48.710307 (MainThread): Tracking: tracking
2020-05-28 09:58:48.710307 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DAFBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3A9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3A90D0>]}
2020-05-28 09:58:48.740566 (MainThread): Partial parsing not enabled
2020-05-28 09:58:48.744576 (MainThread): Parsing macros\core.sql
2020-05-28 09:58:48.754248 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 09:58:48.818822 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 09:58:48.830868 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 09:58:48.834868 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 09:58:48.837031 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 09:58:48.837031 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 09:58:48.841063 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 09:58:48.845059 (MainThread): Parsing macros\etc\query.sql
2020-05-28 09:58:48.845059 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 09:58:48.861114 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 09:58:48.877182 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 09:58:48.881183 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 09:58:48.891390 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 09:58:48.921686 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 09:58:48.968043 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 09:58:48.972041 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 09:58:48.994204 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 09:58:49.006288 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 09:58:49.014336 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 09:58:49.022354 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 09:58:49.026380 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 09:58:49.026380 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 09:58:49.030383 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 09:58:49.034411 (MainThread): Parsing macros\adapters.sql
2020-05-28 09:58:49.058478 (MainThread): Parsing macros\catalog.sql
2020-05-28 09:58:49.062509 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 09:58:49.072702 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 09:58:49.076700 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 09:58:49.080715 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 09:58:49.110997 (MainThread): Partial parsing not enabled
2020-05-28 09:58:49.151569 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 09:58:49.151569 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:58:49.181852 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 09:58:49.181852 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:58:49.193889 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 09:58:49.193889 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:58:49.201916 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:58:49.201916 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:58:49.209961 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 09:58:49.209961 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:58:49.221297 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 09:58:49.221297 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:58:49.525090 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 09:58:49.531616 (MainThread): 
2020-05-28 09:58:49.539616 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 09:58:49.539616 (MainThread): Opening a new connection, currently in state init
2020-05-28 09:58:49.553229 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 09:58:49.554279 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 09:58:49.766020 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 09:58:49.766020 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 09:58:52.417638 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 09:58:54.215197 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.45 seconds
2020-05-28 09:58:54.376010 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 09:58:54.376010 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 09:58:54.384691 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 09:58:54.384691 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 09:58:57.695082 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.31 seconds
2020-05-28 09:58:57.695082 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 09:58:57.695082 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 09:58:58.921604 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.23 seconds
2020-05-28 09:58:58.949678 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 09:58:58.949678 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 09:59:00.045782 (MainThread): Using snowflake connection "master".
2020-05-28 09:59:00.045782 (MainThread): On master: BEGIN
2020-05-28 09:59:03.430589 (MainThread): SQL status: SUCCESS 1 in 3.38 seconds
2020-05-28 09:59:03.430589 (MainThread): On master: COMMIT
2020-05-28 09:59:03.430589 (MainThread): Using snowflake connection "master".
2020-05-28 09:59:03.430589 (MainThread): On master: COMMIT
2020-05-28 09:59:04.456392 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2020-05-28 09:59:04.492329 (MainThread): 15:29:04 | Concurrency: 1 threads (target='dev')
2020-05-28 09:59:04.494624 (MainThread): 15:29:04 | 
2020-05-28 09:59:04.522108 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 09:59:04.523115 (Thread-1): 15:29:04 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-28 09:59:04.526160 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:04.526160 (Thread-1): Opening a new connection, currently in state init
2020-05-28 09:59:04.527500 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 09:59:04.623173 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 09:59:04.629076 (Thread-1): finished collecting timing info
2020-05-28 09:59:04.726249 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:04.726249 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */

    

      create or replace temporary table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE__dbt_tmp  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
     case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    CASE
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    CASE
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::String as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(80) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


    where MODIFIED_TIME > ( select max(MODIFIED_TIME) from ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE )

      );
2020-05-28 09:59:08.588666 (Thread-1): SQL status: SUCCESS 1 in 3.86 seconds
2020-05-28 09:59:08.604843 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:08.604843 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 09:59:09.363019 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2020-05-28 09:59:09.363019 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:09.363019 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_P_APPLY_LEAVE__dbt_tmp'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-28 09:59:10.803303 (Thread-1): SQL status: SUCCESS 29 in 1.44 seconds
2020-05-28 09:59:10.829219 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:10.829219 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_P_APPLY_LEAVE'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-28 09:59:12.996374 (Thread-1): SQL status: SUCCESS 29 in 2.17 seconds
2020-05-28 09:59:13.008137 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:13.008137 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_P_APPLY_LEAVE'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-28 09:59:14.295257 (Thread-1): SQL status: SUCCESS 29 in 1.29 seconds
2020-05-28 09:59:14.417534 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 09:59:14.425549 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:14.425549 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */

        
        
    

    merge into ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE as DBT_INTERNAL_DEST
        using ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.RECORDID = DBT_INTERNAL_DEST.RECORDID
        

    
    when matched then update set
        "ADDED_BY" = DBT_INTERNAL_SOURCE."ADDED_BY","ADDED_TIME" = DBT_INTERNAL_SOURCE."ADDED_TIME","APPROVALSTATUS" = DBT_INTERNAL_SOURCE."APPROVALSTATUS","APPROVED_TIME" = DBT_INTERNAL_SOURCE."APPROVED_TIME","COMMENTS_FOR_CANCELLATION_BY_ADMIN" = DBT_INTERNAL_SOURCE."COMMENTS_FOR_CANCELLATION_BY_ADMIN","DATE_OF_RESIGNATION" = DBT_INTERNAL_SOURCE."DATE_OF_RESIGNATION","DATE_TIME_FOR_WFH" = DBT_INTERNAL_SOURCE."DATE_TIME_FOR_WFH","DATE_OF_REQUEST" = DBT_INTERNAL_SOURCE."DATE_OF_REQUEST","DAYS_TAKEN" = DBT_INTERNAL_SOURCE."DAYS_TAKEN","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","FRIDAY_FLAG" = DBT_INTERNAL_SOURCE."FRIDAY_FLAG","FROM_DATE" = DBT_INTERNAL_SOURCE."FROM_DATE","LATE_FLAG" = DBT_INTERNAL_SOURCE."LATE_FLAG","LEAVE_TYPE" = DBT_INTERNAL_SOURCE."LEAVE_TYPE","MEDICAL_CERTIFICATE" = DBT_INTERNAL_SOURCE."MEDICAL_CERTIFICATE","MEDICAL_CERTIFICATE_DOWNLOAD_URL" = DBT_INTERNAL_SOURCE."MEDICAL_CERTIFICATE_DOWNLOAD_URL","MODIFIED_BY" = DBT_INTERNAL_SOURCE."MODIFIED_BY","MODIFIED_TIME" = DBT_INTERNAL_SOURCE."MODIFIED_TIME","NOTICE_PERIOD" = DBT_INTERNAL_SOURCE."NOTICE_PERIOD","NO_OF_DAYS" = DBT_INTERNAL_SOURCE."NO_OF_DAYS","REASON_FOR_LEAVE_1" = DBT_INTERNAL_SOURCE."REASON_FOR_LEAVE_1","REASON_FOR_LEAVE_2" = DBT_INTERNAL_SOURCE."REASON_FOR_LEAVE_2","TO_DATE" = DBT_INTERNAL_SOURCE."TO_DATE","WAS_IT_A_LATE_APPLICATION" = DBT_INTERNAL_SOURCE."WAS_IT_A_LATE_APPLICATION","CREATED_TIME_INT" = DBT_INTERNAL_SOURCE."CREATED_TIME_INT","MODIFIED_TIME_INT" = DBT_INTERNAL_SOURCE."MODIFIED_TIME_INT","OWNERID" = DBT_INTERNAL_SOURCE."OWNERID","OWNERNAME" = DBT_INTERNAL_SOURCE."OWNERNAME","RECORDID" = DBT_INTERNAL_SOURCE."RECORDID"
    

    when not matched then insert
        ("ADDED_BY", "ADDED_TIME", "APPROVALSTATUS", "APPROVED_TIME", "COMMENTS_FOR_CANCELLATION_BY_ADMIN", "DATE_OF_RESIGNATION", "DATE_TIME_FOR_WFH", "DATE_OF_REQUEST", "DAYS_TAKEN", "EMPLOYEE_ID", "FRIDAY_FLAG", "FROM_DATE", "LATE_FLAG", "LEAVE_TYPE", "MEDICAL_CERTIFICATE", "MEDICAL_CERTIFICATE_DOWNLOAD_URL", "MODIFIED_BY", "MODIFIED_TIME", "NOTICE_PERIOD", "NO_OF_DAYS", "REASON_FOR_LEAVE_1", "REASON_FOR_LEAVE_2", "TO_DATE", "WAS_IT_A_LATE_APPLICATION", "CREATED_TIME_INT", "MODIFIED_TIME_INT", "OWNERID", "OWNERNAME", "RECORDID")
    values
        ("ADDED_BY", "ADDED_TIME", "APPROVALSTATUS", "APPROVED_TIME", "COMMENTS_FOR_CANCELLATION_BY_ADMIN", "DATE_OF_RESIGNATION", "DATE_TIME_FOR_WFH", "DATE_OF_REQUEST", "DAYS_TAKEN", "EMPLOYEE_ID", "FRIDAY_FLAG", "FROM_DATE", "LATE_FLAG", "LEAVE_TYPE", "MEDICAL_CERTIFICATE", "MEDICAL_CERTIFICATE_DOWNLOAD_URL", "MODIFIED_BY", "MODIFIED_TIME", "NOTICE_PERIOD", "NO_OF_DAYS", "REASON_FOR_LEAVE_1", "REASON_FOR_LEAVE_2", "TO_DATE", "WAS_IT_A_LATE_APPLICATION", "CREATED_TIME_INT", "MODIFIED_TIME_INT", "OWNERID", "OWNERNAME", "RECORDID")
2020-05-28 09:59:16.010060 (Thread-1): SQL status: SUCCESS 0 in 1.58 seconds
2020-05-28 09:59:16.011569 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-28 09:59:16.012600 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 09:59:16.012600 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-28 09:59:16.625382 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 09:59:16.632313 (Thread-1): finished collecting timing info
2020-05-28 09:59:16.635202 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3253dd5c-4e93-49ad-9577-eff6fc0c4658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E525250>]}
2020-05-28 09:59:16.636702 (Thread-1): 15:29:16 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLY_LEAVE....... [SUCCESS 0 in 12.11s]
2020-05-28 09:59:16.641939 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 09:59:16.647368 (MainThread): Using snowflake connection "master".
2020-05-28 09:59:16.648941 (MainThread): On master: BEGIN
2020-05-28 09:59:17.219132 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 09:59:17.220808 (MainThread): On master: COMMIT
2020-05-28 09:59:17.220808 (MainThread): Using snowflake connection "master".
2020-05-28 09:59:17.220808 (MainThread): On master: COMMIT
2020-05-28 09:59:17.823293 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 09:59:17.824294 (MainThread): 15:29:17 | 
2020-05-28 09:59:17.825951 (MainThread): 15:29:17 | Finished running 1 incremental model in 28.28s.
2020-05-28 09:59:17.828054 (MainThread): Connection 'master' was left open.
2020-05-28 09:59:17.828054 (MainThread): On master: Close
2020-05-28 09:59:18.792459 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 09:59:18.792459 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 09:59:19.860910 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 09:59:19.860910 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 09:59:20.595100 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 09:59:20.595100 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 09:59:21.435422 (MainThread): 
2020-05-28 09:59:21.435422 (MainThread): Completed successfully
2020-05-28 09:59:21.439427 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 09:59:21.466944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F2EEB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F2EE0E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F2EE5F8>]}
2020-05-28 09:59:21.467941 (MainThread): Flushing usage events
2020-05-28 10:01:36.681279 (MainThread): Running with dbt=0.16.1
2020-05-28 10:01:36.942982 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 10:01:37.332846 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 10:01:37.332846 (MainThread): Tracking: tracking
2020-05-28 10:01:37.332846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DCEBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5A9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5A90D0>]}
2020-05-28 10:01:37.363303 (MainThread): Partial parsing not enabled
2020-05-28 10:01:37.367366 (MainThread): Parsing macros\core.sql
2020-05-28 10:01:37.375345 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 10:01:37.439930 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 10:01:37.455973 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 10:01:37.455973 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 10:01:37.460063 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 10:01:37.464017 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 10:01:37.467976 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 10:01:37.467976 (MainThread): Parsing macros\etc\query.sql
2020-05-28 10:01:37.472125 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 10:01:37.484111 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 10:01:37.508441 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 10:01:37.508441 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 10:01:37.520477 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 10:01:37.554983 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 10:01:37.606380 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 10:01:37.610331 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 10:01:37.636633 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 10:01:37.648679 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 10:01:37.654901 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 10:01:37.666942 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 10:01:37.671153 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 10:01:37.673278 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 10:01:37.674316 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 10:01:37.678443 (MainThread): Parsing macros\adapters.sql
2020-05-28 10:01:37.704706 (MainThread): Parsing macros\catalog.sql
2020-05-28 10:01:37.708733 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 10:01:37.724128 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 10:01:37.724128 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 10:01:37.732166 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 10:01:37.760265 (MainThread): Partial parsing not enabled
2020-05-28 10:01:37.808752 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 10:01:37.808752 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:01:37.839064 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:01:37.839064 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:01:37.850707 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 10:01:37.850707 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:01:37.862967 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:01:37.862967 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:01:37.872140 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:01:37.872140 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:01:37.880182 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 10:01:37.880182 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:01:38.207466 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 10:01:38.214354 (MainThread): 
2020-05-28 10:01:38.219958 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 10:01:38.219958 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:01:38.232431 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:01:38.233430 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 10:01:38.412841 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:01:38.416874 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 10:01:40.533743 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 10:01:42.593404 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.18 seconds
2020-05-28 10:01:42.703233 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:01:42.704777 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 10:01:42.713476 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:01:42.713476 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 10:01:45.634633 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.92 seconds
2020-05-28 10:01:45.634633 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:01:45.634633 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 10:01:46.863731 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.23 seconds
2020-05-28 10:01:46.891815 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 10:01:46.891815 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 10:01:47.687196 (MainThread): Using snowflake connection "master".
2020-05-28 10:01:47.687196 (MainThread): On master: BEGIN
2020-05-28 10:01:50.756668 (MainThread): SQL status: SUCCESS 1 in 3.07 seconds
2020-05-28 10:01:50.756778 (MainThread): On master: COMMIT
2020-05-28 10:01:50.757782 (MainThread): Using snowflake connection "master".
2020-05-28 10:01:50.758389 (MainThread): On master: COMMIT
2020-05-28 10:01:51.471585 (MainThread): SQL status: SUCCESS 1 in 0.71 seconds
2020-05-28 10:01:51.471585 (MainThread): 15:31:51 | Concurrency: 1 threads (target='dev')
2020-05-28 10:01:51.476870 (MainThread): 15:31:51 | 
2020-05-28 10:01:51.487844 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 10:01:51.487844 (Thread-1): 15:31:51 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-28 10:01:51.503376 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:01:51.504377 (Thread-1): Opening a new connection, currently in state init
2020-05-28 10:01:51.504377 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 10:01:51.594728 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 10:01:51.597305 (Thread-1): finished collecting timing info
2020-05-28 10:01:51.660062 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 10:01:51.663741 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:01:51.663741 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 10:01:54.851872 (Thread-1): SQL status: SUCCESS 1 in 3.19 seconds
2020-05-28 10:01:54.852877 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:01:54.853485 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
     case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    CASE
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    CASE
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::String as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(80) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 10:03:25.578801 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7271760.
2020-05-28 10:03:25.578801 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-28 10:03:25.578801 (Thread-1): initiating rollback
2020-05-28 10:03:26.002766 (Thread-1): finished collecting timing info
2020-05-28 10:03:26.004942 (Thread-1): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7271760.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7271760.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7271760.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 10:03:26.069963 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fa6988-7095-4c5c-93b5-1434d3ff0e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F4ECF28>]}
2020-05-28 10:03:26.069963 (Thread-1): 15:33:26 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLY_LEAVE... [ERROR in 94.57s]
2020-05-28 10:03:26.075267 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 10:03:26.081416 (MainThread): Using snowflake connection "master".
2020-05-28 10:03:26.081416 (MainThread): On master: BEGIN
2020-05-28 10:03:26.807352 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2020-05-28 10:03:26.807352 (MainThread): On master: COMMIT
2020-05-28 10:03:26.807352 (MainThread): Using snowflake connection "master".
2020-05-28 10:03:26.807352 (MainThread): On master: COMMIT
2020-05-28 10:03:27.478152 (MainThread): SQL status: SUCCESS 1 in 0.66 seconds
2020-05-28 10:03:27.478152 (MainThread): 15:33:27 | 
2020-05-28 10:03:27.481885 (MainThread): 15:33:27 | Finished running 1 incremental model in 109.26s.
2020-05-28 10:03:27.484258 (MainThread): Connection 'master' was left open.
2020-05-28 10:03:27.484485 (MainThread): On master: Close
2020-05-28 10:03:28.447814 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 10:03:28.447814 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 10:03:29.677251 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 10:03:29.677251 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 10:03:30.486696 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 10:03:30.486696 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 10:03:31.169196 (MainThread): 
2020-05-28 10:03:31.171037 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 10:03:31.174501 (MainThread): 
2020-05-28 10:03:31.199081 (MainThread): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
2020-05-28 10:03:31.202799 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 10:03:31.204235 (MainThread):   Processing aborted due to error 300010:3898809911; incident 7271760.
2020-05-28 10:03:31.272188 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 10:03:31.309027 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 10:03:31.311646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBA70E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EBA7C58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EB284F0>]}
2020-05-28 10:03:31.312647 (MainThread): Flushing usage events
2020-05-28 10:06:59.533756 (MainThread): Running with dbt=0.16.1
2020-05-28 10:06:59.874335 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 10:07:00.265373 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 10:07:00.265373 (MainThread): Tracking: tracking
2020-05-28 10:07:00.265373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DA9BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E34A358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E34A0D0>]}
2020-05-28 10:07:00.295400 (MainThread): Partial parsing not enabled
2020-05-28 10:07:00.299491 (MainThread): Parsing macros\core.sql
2020-05-28 10:07:00.307449 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 10:07:00.369222 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 10:07:00.387616 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 10:07:00.387616 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 10:07:00.391575 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 10:07:00.395579 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 10:07:00.399598 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 10:07:00.403626 (MainThread): Parsing macros\etc\query.sql
2020-05-28 10:07:00.403626 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 10:07:00.419674 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 10:07:00.442183 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 10:07:00.446279 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 10:07:00.456248 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 10:07:00.494618 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 10:07:00.546299 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 10:07:00.550330 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 10:07:00.579205 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 10:07:00.587248 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 10:07:00.595348 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 10:07:00.606170 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 10:07:00.610165 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 10:07:00.610165 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 10:07:00.614165 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 10:07:00.614165 (MainThread): Parsing macros\adapters.sql
2020-05-28 10:07:00.642337 (MainThread): Parsing macros\catalog.sql
2020-05-28 10:07:00.646299 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 10:07:00.658331 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 10:07:00.662331 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 10:07:00.664325 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 10:07:00.694261 (MainThread): Partial parsing not enabled
2020-05-28 10:07:00.736662 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 10:07:00.736662 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:07:00.766973 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:07:00.766973 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:07:00.774982 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 10:07:00.774982 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:07:00.787028 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:07:00.787028 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:07:00.797287 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:07:00.797287 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:07:00.805334 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 10:07:00.805334 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:07:01.095654 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 10:07:01.103969 (MainThread): 
2020-05-28 10:07:01.109780 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 10:07:01.110777 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:07:01.124288 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:07:01.125187 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 10:07:01.319530 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:07:01.319530 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 10:07:03.346174 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 10:07:05.331114 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.01 seconds
2020-05-28 10:07:05.446817 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:07:05.448207 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 10:07:05.457342 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:07:05.457342 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 10:07:08.303954 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.85 seconds
2020-05-28 10:07:08.303954 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:07:08.303954 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 10:07:09.492313 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.19 seconds
2020-05-28 10:07:09.516413 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 10:07:09.516413 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 10:07:10.202659 (MainThread): Using snowflake connection "master".
2020-05-28 10:07:10.202659 (MainThread): On master: BEGIN
2020-05-28 10:07:12.908465 (MainThread): SQL status: SUCCESS 1 in 2.70 seconds
2020-05-28 10:07:12.908465 (MainThread): On master: COMMIT
2020-05-28 10:07:12.908465 (MainThread): Using snowflake connection "master".
2020-05-28 10:07:12.908465 (MainThread): On master: COMMIT
2020-05-28 10:07:13.489941 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2020-05-28 10:07:13.489941 (MainThread): 15:37:13 | Concurrency: 1 threads (target='dev')
2020-05-28 10:07:13.495095 (MainThread): 15:37:13 | 
2020-05-28 10:07:13.505988 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 10:07:13.506987 (Thread-1): 15:37:13 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-28 10:07:13.523345 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:07:13.523345 (Thread-1): Opening a new connection, currently in state init
2020-05-28 10:07:13.523345 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 10:07:13.608916 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 10:07:13.614755 (Thread-1): finished collecting timing info
2020-05-28 10:07:13.684983 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 10:07:13.687114 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:07:13.687114 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 10:07:16.686887 (Thread-1): SQL status: SUCCESS 1 in 3.00 seconds
2020-05-28 10:07:16.686887 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:07:16.691047 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
     case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    CASE
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    CASE
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::String as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(80) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 10:08:41.997923 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 1799083.
2020-05-28 10:08:41.997923 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-28 10:08:41.997923 (Thread-1): initiating rollback
2020-05-28 10:08:42.505677 (Thread-1): finished collecting timing info
2020-05-28 10:08:42.508675 (Thread-1): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 1799083.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 1799083.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 1799083.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 10:08:42.527620 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50647c79-bd8b-4f8f-8174-b49497821bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E444898>]}
2020-05-28 10:08:42.528662 (Thread-1): 15:38:42 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLY_LEAVE... [ERROR in 89.00s]
2020-05-28 10:08:42.532831 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 10:08:42.536525 (MainThread): Using snowflake connection "master".
2020-05-28 10:08:42.537522 (MainThread): On master: BEGIN
2020-05-28 10:08:43.058496 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2020-05-28 10:08:43.058496 (MainThread): On master: COMMIT
2020-05-28 10:08:43.058496 (MainThread): Using snowflake connection "master".
2020-05-28 10:08:43.058496 (MainThread): On master: COMMIT
2020-05-28 10:08:44.048161 (MainThread): SQL status: SUCCESS 1 in 0.99 seconds
2020-05-28 10:08:44.048161 (MainThread): 15:38:44 | 
2020-05-28 10:08:44.052320 (MainThread): 15:38:44 | Finished running 1 incremental model in 102.94s.
2020-05-28 10:08:44.054083 (MainThread): Connection 'master' was left open.
2020-05-28 10:08:44.055122 (MainThread): On master: Close
2020-05-28 10:08:45.278096 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 10:08:45.278096 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 10:08:46.303827 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 10:08:46.303827 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 10:08:47.121708 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 10:08:47.121708 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 10:08:48.164939 (MainThread): 
2020-05-28 10:08:48.167128 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 10:08:48.193560 (MainThread): 
2020-05-28 10:08:48.196549 (MainThread): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
2020-05-28 10:08:48.199598 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 10:08:48.201312 (MainThread):   Processing aborted due to error 300010:3898809911; incident 1799083.
2020-05-28 10:08:48.203199 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 10:08:48.205975 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 10:08:48.208749 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8BF580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8BF508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4ABC70>]}
2020-05-28 10:08:48.210203 (MainThread): Flushing usage events
2020-05-28 10:26:44.685264 (MainThread): Running with dbt=0.16.1
2020-05-28 10:26:44.921743 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 10:26:45.401730 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_EMPLOYEEINACTIVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 10:26:45.401730 (MainThread): Tracking: tracking
2020-05-28 10:26:45.401730 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DA7B9B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E319100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E319130>]}
2020-05-28 10:26:45.428988 (MainThread): Partial parsing not enabled
2020-05-28 10:26:45.432967 (MainThread): Parsing macros\core.sql
2020-05-28 10:26:45.440980 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 10:26:45.501086 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 10:26:45.513129 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 10:26:45.517127 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 10:26:45.517127 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 10:26:45.521143 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 10:26:45.525173 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 10:26:45.525173 (MainThread): Parsing macros\etc\query.sql
2020-05-28 10:26:45.530297 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 10:26:45.540392 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 10:26:45.559529 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 10:26:45.563529 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 10:26:45.569752 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 10:26:45.605093 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 10:26:45.681877 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 10:26:45.689909 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 10:26:45.722057 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 10:26:45.734105 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 10:26:45.742116 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 10:26:45.750146 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 10:26:45.754377 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 10:26:45.756658 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 10:26:45.756658 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 10:26:45.760913 (MainThread): Parsing macros\adapters.sql
2020-05-28 10:26:45.787096 (MainThread): Parsing macros\catalog.sql
2020-05-28 10:26:45.787096 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 10:26:45.801364 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 10:26:45.805370 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 10:26:45.809377 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 10:26:45.837766 (MainThread): Partial parsing not enabled
2020-05-28 10:26:45.881107 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 10:26:45.881107 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:26:45.911330 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:26:45.911330 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:26:45.919353 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 10:26:45.919353 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:26:45.931399 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:26:45.931399 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:26:45.939436 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:26:45.939436 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:26:45.949662 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 10:26:45.949662 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:26:46.239114 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 10:26:46.245677 (MainThread): 
2020-05-28 10:26:46.252188 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 10:26:46.252188 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:26:46.262666 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:26:46.263037 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 10:26:46.468546 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:26:46.469107 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 10:26:48.087515 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 10:26:49.502590 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.03 seconds
2020-05-28 10:26:49.607072 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:26:49.608126 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 10:26:49.616206 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:26:49.616206 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 10:26:52.368997 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.75 seconds
2020-05-28 10:26:52.368997 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:26:52.373067 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 10:26:53.602227 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.23 seconds
2020-05-28 10:26:53.622286 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 10:26:53.622286 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 10:26:54.422404 (MainThread): Using snowflake connection "master".
2020-05-28 10:26:54.422404 (MainThread): On master: BEGIN
2020-05-28 10:26:57.898677 (MainThread): SQL status: SUCCESS 1 in 3.48 seconds
2020-05-28 10:26:57.898677 (MainThread): On master: COMMIT
2020-05-28 10:26:57.902851 (MainThread): Using snowflake connection "master".
2020-05-28 10:26:57.902851 (MainThread): On master: COMMIT
2020-05-28 10:26:58.513220 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 10:26:58.517233 (MainThread): 15:56:58 | Concurrency: 1 threads (target='dev')
2020-05-28 10:26:58.518869 (MainThread): 15:56:58 | 
2020-05-28 10:26:58.531071 (Thread-1): Began running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:26:58.532066 (Thread-1): 15:56:58 | 1 of 1 START incremental model ANALYTICS.TB_EMPLOYEEINACTIVE......... [RUN]
2020-05-28 10:26:58.550659 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:26:58.552037 (Thread-1): Opening a new connection, currently in state init
2020-05-28 10:26:58.552490 (Thread-1): Compiling model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:26:58.644654 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"
2020-05-28 10:26:58.648182 (Thread-1): finished collecting timing info
2020-05-28 10:26:58.774591 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"
2020-05-28 10:26:58.779036 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:26:58.779036 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: BEGIN
2020-05-28 10:27:01.961574 (Thread-1): SQL status: SUCCESS 1 in 3.18 seconds
2020-05-28 10:27:01.961574 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:27:01.961574 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_EMPLOYEEINACTIVE  as
      (

Select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVALSTATUS,
    case 
        when length(SRC:"Date of joining (dd-MMM-yyyy)") = 0 then
            to_date('01-Jan-0001', 'DD-Mon-YYYY')
        else
            to_date(SRC:"Date of joining (dd-MMM-yyyy)"::String , 'DD-Mon-YYYY')
    end
    as DATE_OF_JOINING,
    
    --SRC:"Date of joining (dd-MMM-yyyy)"::Date as DATE_OF_JOINING,
    SRC:"Department"::varchar(30) as DEPARTMENT,
    SRC:"Email ID"::varchar(40) as EMAIL_ID,
    SRC:"Employee Status"::varchar(25) as EMPLOYEE_STATUS,
    SRC:"EmployeeID"::varchar(15) as EMPLOYEE_ID,
    SRC:"First Name"::varchar(50) as FIRST_NAME,
    SRC:"Last Name"::varchar(50) as LAST_NAME,
    SRC:"Reporting To"::varchar(80) as REPORTING_TO,
    SRC:"Title"::String as TITLE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(80) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_EMPLOYEEINACTIVEVIEW


      );
2020-05-28 10:27:03.636066 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2020-05-28 10:27:03.641287 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: COMMIT
2020-05-28 10:27:03.641287 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:27:03.642280 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: COMMIT
2020-05-28 10:27:04.052165 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-05-28 10:27:04.061894 (Thread-1): finished collecting timing info
2020-05-28 10:27:04.062932 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '328d0afd-64c2-4f0a-85e9-3849b3bbd52d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F25D538>]}
2020-05-28 10:27:04.062932 (Thread-1): 15:57:04 | 1 of 1 OK created incremental model ANALYTICS.TB_EMPLOYEEINACTIVE.... [SUCCESS 1 in 5.51s]
2020-05-28 10:27:04.069723 (Thread-1): Finished running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:27:04.074386 (MainThread): Using snowflake connection "master".
2020-05-28 10:27:04.074386 (MainThread): On master: BEGIN
2020-05-28 10:27:04.506254 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2020-05-28 10:27:04.506254 (MainThread): On master: COMMIT
2020-05-28 10:27:04.506254 (MainThread): Using snowflake connection "master".
2020-05-28 10:27:04.506254 (MainThread): On master: COMMIT
2020-05-28 10:27:05.274568 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2020-05-28 10:27:05.280199 (MainThread): 15:57:05 | 
2020-05-28 10:27:05.282692 (MainThread): 15:57:05 | Finished running 1 incremental model in 19.03s.
2020-05-28 10:27:05.306426 (MainThread): Connection 'master' was left open.
2020-05-28 10:27:05.307424 (MainThread): On master: Close
2020-05-28 10:27:06.505895 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 10:27:06.505895 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 10:27:07.355043 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 10:27:07.355043 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 10:27:08.486225 (MainThread): Connection 'model.vbi_zoho_people.TB_EMPLOYEEINACTIVE' was left open.
2020-05-28 10:27:08.486225 (MainThread): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: Close
2020-05-28 10:27:09.801687 (MainThread): 
2020-05-28 10:27:09.804201 (MainThread): Completed successfully
2020-05-28 10:27:09.807132 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 10:27:09.829106 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E409C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E49CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E88EC70>]}
2020-05-28 10:27:09.831101 (MainThread): Flushing usage events
2020-05-28 10:28:25.394091 (MainThread): Running with dbt=0.16.1
2020-05-28 10:28:25.682726 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 10:28:26.105716 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_EMPLOYEEINACTIVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 10:28:26.105716 (MainThread): Tracking: tracking
2020-05-28 10:28:26.105716 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4ABA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED5A3E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED5A1D8>]}
2020-05-28 10:28:26.133929 (MainThread): Partial parsing not enabled
2020-05-28 10:28:26.140123 (MainThread): Parsing macros\core.sql
2020-05-28 10:28:26.148073 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 10:28:26.215887 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 10:28:26.227927 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 10:28:26.231929 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 10:28:26.234213 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 10:28:26.238164 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 10:28:26.242164 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 10:28:26.242164 (MainThread): Parsing macros\etc\query.sql
2020-05-28 10:28:26.246220 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 10:28:26.256384 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 10:28:26.280406 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 10:28:26.280406 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 10:28:26.290664 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 10:28:26.326794 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 10:28:26.377294 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 10:28:26.381298 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 10:28:26.407499 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 10:28:26.419471 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 10:28:26.427493 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 10:28:26.435535 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 10:28:26.441730 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 10:28:26.441730 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 10:28:26.445680 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 10:28:26.445680 (MainThread): Parsing macros\adapters.sql
2020-05-28 10:28:26.479109 (MainThread): Parsing macros\catalog.sql
2020-05-28 10:28:26.483110 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 10:28:26.497401 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 10:28:26.501490 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 10:28:26.505443 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 10:28:26.535739 (MainThread): Partial parsing not enabled
2020-05-28 10:28:26.586362 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 10:28:26.586362 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:28:26.622492 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:28:26.622492 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:28:26.630594 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 10:28:26.630594 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:28:26.644687 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:28:26.644687 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:28:26.652706 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:28:26.652706 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:28:26.664754 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 10:28:26.664754 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:28:26.984259 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 10:28:26.996643 (MainThread): 
2020-05-28 10:28:27.001413 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 10:28:27.001413 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:28:27.016646 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:28:27.016646 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 10:28:27.168237 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:28:27.168237 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 10:28:29.094539 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 10:28:30.674642 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.51 seconds
2020-05-28 10:28:30.802398 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:28:30.802398 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 10:28:30.807424 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:28:30.807424 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 10:28:33.320579 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.51 seconds
2020-05-28 10:28:33.320579 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:28:33.320579 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 10:28:34.567253 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.24 seconds
2020-05-28 10:28:34.587458 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 10:28:34.587458 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 10:28:35.595206 (MainThread): Using snowflake connection "master".
2020-05-28 10:28:35.595206 (MainThread): On master: BEGIN
2020-05-28 10:28:38.649870 (MainThread): SQL status: SUCCESS 1 in 3.05 seconds
2020-05-28 10:28:38.649870 (MainThread): On master: COMMIT
2020-05-28 10:28:38.651777 (MainThread): Using snowflake connection "master".
2020-05-28 10:28:38.652781 (MainThread): On master: COMMIT
2020-05-28 10:28:39.449919 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2020-05-28 10:28:39.454009 (MainThread): 15:58:39 | Concurrency: 1 threads (target='dev')
2020-05-28 10:28:39.455732 (MainThread): 15:58:39 | 
2020-05-28 10:28:39.467732 (Thread-1): Began running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:28:39.468730 (Thread-1): 15:58:39 | 1 of 1 START incremental model ANALYTICS.TB_EMPLOYEEINACTIVE......... [RUN]
2020-05-28 10:28:39.484301 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:28:39.485293 (Thread-1): Opening a new connection, currently in state init
2020-05-28 10:28:39.485438 (Thread-1): Compiling model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:28:39.570909 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"
2020-05-28 10:28:39.577335 (Thread-1): finished collecting timing info
2020-05-28 10:28:39.638378 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"
2020-05-28 10:28:39.644407 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:28:39.644407 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: BEGIN
2020-05-28 10:28:42.657409 (Thread-1): SQL status: SUCCESS 1 in 3.01 seconds
2020-05-28 10:28:42.657409 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:28:42.657409 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_EMPLOYEEINACTIVE  as
      (

Select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVALSTATUS,
    case 
        when length(SRC:"Date of joining (dd-MMM-yyyy)") = 0 then
            to_date('01-Jan-0001', 'DD-Mon-YYYY')
        else
            to_date(SRC:"Date of joining (dd-MMM-yyyy)"::String , 'DD-Mon-YYYY')
    end
    as DATE_OF_JOINING,
    
    --SRC:"Date of joining (dd-MMM-yyyy)"::Date as DATE_OF_JOINING,
    SRC:"Department"::varchar(30) as DEPARTMENT,
    SRC:"Email ID"::varchar(40) as EMAIL_ID,
    SRC:"Employee Status"::varchar(25) as EMPLOYEE_STATUS,
    SRC:"EmployeeID"::varchar(15) as EMPLOYEE_ID,
    SRC:"First Name"::varchar(50) as FIRST_NAME,
    SRC:"Last Name"::varchar(50) as LAST_NAME,
    SRC:"Reporting To"::varchar(80) as REPORTING_TO,
    SRC:"Title"::varchar(80) as TITLE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(80) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_EMPLOYEEINACTIVEVIEW


      );
2020-05-28 10:28:44.397038 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2020-05-28 10:28:44.401036 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: COMMIT
2020-05-28 10:28:44.401036 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:28:44.405036 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: COMMIT
2020-05-28 10:28:45.011188 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 10:28:45.025913 (Thread-1): finished collecting timing info
2020-05-28 10:28:45.025913 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '270d3490-cdbe-4f32-a259-0d5063ee9a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE65538>]}
2020-05-28 10:28:45.025913 (Thread-1): 15:58:45 | 1 of 1 OK created incremental model ANALYTICS.TB_EMPLOYEEINACTIVE.... [SUCCESS 1 in 5.54s]
2020-05-28 10:28:45.034304 (Thread-1): Finished running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:28:45.038338 (MainThread): Using snowflake connection "master".
2020-05-28 10:28:45.038338 (MainThread): On master: BEGIN
2020-05-28 10:28:46.036210 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2020-05-28 10:28:46.036210 (MainThread): On master: COMMIT
2020-05-28 10:28:46.036210 (MainThread): Using snowflake connection "master".
2020-05-28 10:28:46.036210 (MainThread): On master: COMMIT
2020-05-28 10:28:47.060265 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2020-05-28 10:28:47.060265 (MainThread): 15:58:47 | 
2020-05-28 10:28:47.066362 (MainThread): 15:58:47 | Finished running 1 incremental model in 20.06s.
2020-05-28 10:28:47.067998 (MainThread): Connection 'master' was left open.
2020-05-28 10:28:47.069078 (MainThread): On master: Close
2020-05-28 10:28:48.086959 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 10:28:48.086959 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 10:28:49.110812 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 10:28:49.110812 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 10:28:49.957438 (MainThread): Connection 'model.vbi_zoho_people.TB_EMPLOYEEINACTIVE' was left open.
2020-05-28 10:28:49.962245 (MainThread): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: Close
2020-05-28 10:28:50.705707 (MainThread): 
2020-05-28 10:28:50.705707 (MainThread): Completed successfully
2020-05-28 10:28:50.710976 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 10:28:50.711973 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F2CEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F2CEB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EEC2BF8>]}
2020-05-28 10:28:50.711973 (MainThread): Flushing usage events
2020-05-28 10:52:26.393346 (MainThread): Running with dbt=0.16.1
2020-05-28 10:52:26.613135 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 10:52:27.206593 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_EMPLOYEEINACTIVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 10:52:27.206593 (MainThread): Tracking: tracking
2020-05-28 10:52:27.206593 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D85BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E109088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1090B8>]}
2020-05-28 10:52:27.238769 (MainThread): Partial parsing not enabled
2020-05-28 10:52:27.246720 (MainThread): Parsing macros\core.sql
2020-05-28 10:52:27.253012 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 10:52:27.322008 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 10:52:27.335893 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 10:52:27.339894 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 10:52:27.339894 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 10:52:27.343940 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 10:52:27.347955 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 10:52:27.351951 (MainThread): Parsing macros\etc\query.sql
2020-05-28 10:52:27.351951 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 10:52:27.366851 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 10:52:27.388857 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 10:52:27.388857 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 10:52:27.400899 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 10:52:27.435379 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 10:52:27.491410 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 10:52:27.495461 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 10:52:27.523556 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 10:52:27.531665 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 10:52:27.539608 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 10:52:27.551647 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 10:52:27.555737 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 10:52:27.555737 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 10:52:27.559691 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 10:52:27.563689 (MainThread): Parsing macros\adapters.sql
2020-05-28 10:52:27.590171 (MainThread): Parsing macros\catalog.sql
2020-05-28 10:52:27.594098 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 10:52:27.608046 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 10:52:27.612067 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 10:52:27.620092 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 10:52:27.648221 (MainThread): Partial parsing not enabled
2020-05-28 10:52:27.698617 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 10:52:27.698617 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:52:27.732685 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:52:27.732685 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:52:27.742822 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 10:52:27.742822 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:52:27.754151 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:52:27.754151 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:52:27.765507 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:52:27.765507 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:52:27.776021 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 10:52:27.776021 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:52:28.144311 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 10:52:28.152085 (MainThread): 
2020-05-28 10:52:28.160646 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 10:52:28.161647 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:52:28.172456 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:52:28.175943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 10:52:28.365634 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:52:28.365634 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 10:52:29.876752 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 10:52:32.823937 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.46 seconds
2020-05-28 10:52:32.936523 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:52:32.937575 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 10:52:32.945990 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:52:32.945990 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 10:52:36.379994 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.43 seconds
2020-05-28 10:52:36.379994 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:52:36.379994 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 10:52:37.608619 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.23 seconds
2020-05-28 10:52:37.632710 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 10:52:37.632710 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 10:52:38.432954 (MainThread): Using snowflake connection "master".
2020-05-28 10:52:38.432954 (MainThread): On master: BEGIN
2020-05-28 10:52:41.294190 (MainThread): SQL status: SUCCESS 1 in 2.86 seconds
2020-05-28 10:52:41.294190 (MainThread): On master: COMMIT
2020-05-28 10:52:41.298263 (MainThread): Using snowflake connection "master".
2020-05-28 10:52:41.298263 (MainThread): On master: COMMIT
2020-05-28 10:52:41.911744 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 10:52:41.913364 (MainThread): 16:22:41 | Concurrency: 1 threads (target='dev')
2020-05-28 10:52:41.915612 (MainThread): 16:22:41 | 
2020-05-28 10:52:41.939086 (Thread-1): Began running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:52:41.939677 (Thread-1): 16:22:41 | 1 of 1 START incremental model ANALYTICS.TB_EMPLOYEEINACTIVE......... [RUN]
2020-05-28 10:52:41.943140 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:52:41.944202 (Thread-1): Opening a new connection, currently in state init
2020-05-28 10:52:41.944317 (Thread-1): Compiling model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:52:42.027968 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"
2020-05-28 10:52:42.033764 (Thread-1): finished collecting timing info
2020-05-28 10:52:42.096749 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"
2020-05-28 10:52:42.101205 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:52:42.101205 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: BEGIN
2020-05-28 10:52:44.981788 (Thread-1): SQL status: SUCCESS 1 in 2.88 seconds
2020-05-28 10:52:44.981788 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:52:44.981788 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_EMPLOYEEINACTIVE  as
      (

Select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVALSTATUS,
    case 
        when length(SRC:"Date of joining (dd-MMM-yyyy)") = 0 then
            to_date('01-Jan-0001', 'DD-Mon-YYYY')
        else
            to_date(SRC:"Date of joining (dd-MMM-yyyy)"::String , 'DD-Mon-YYYY')
    end
    as DATE_OF_JOINING,
    SRC:"Department"::varchar(30) as DEPARTMENT,
    SRC:"Email ID"::varchar(40) as EMAIL_ID,
    SRC:"Employee Status"::varchar(25) as EMPLOYEE_STATUS,
    SRC:"EmployeeID"::varchar(15) as EMPLOYEE_ID,
    SRC:"First Name"::varchar(50) as FIRST_NAME,
    SRC:"Last Name"::varchar(50) as LAST_NAME,
    SRC:"Reporting To"::varchar(80) as REPORTING_TO,
    SRC:"Title"::varchar(80) as TITLE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_EMPLOYEEINACTIVEVIEW


      );
2020-05-28 10:52:46.621870 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2020-05-28 10:52:46.626044 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: COMMIT
2020-05-28 10:52:46.626044 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:52:46.627183 (Thread-1): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: COMMIT
2020-05-28 10:52:47.644328 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2020-05-28 10:52:47.652423 (Thread-1): finished collecting timing info
2020-05-28 10:52:47.656422 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc674fdf-d93f-455d-9287-28600244687c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F04BB50>]}
2020-05-28 10:52:47.656422 (Thread-1): 16:22:47 | 1 of 1 OK created incremental model ANALYTICS.TB_EMPLOYEEINACTIVE.... [SUCCESS 1 in 5.71s]
2020-05-28 10:52:47.662937 (Thread-1): Finished running node model.vbi_zoho_people.TB_EMPLOYEEINACTIVE
2020-05-28 10:52:47.667628 (MainThread): Using snowflake connection "master".
2020-05-28 10:52:47.668663 (MainThread): On master: BEGIN
2020-05-28 10:52:48.149690 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2020-05-28 10:52:48.149690 (MainThread): On master: COMMIT
2020-05-28 10:52:48.149690 (MainThread): Using snowflake connection "master".
2020-05-28 10:52:48.149690 (MainThread): On master: COMMIT
2020-05-28 10:52:48.752615 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 10:52:48.752615 (MainThread): 16:22:48 | 
2020-05-28 10:52:48.756601 (MainThread): 16:22:48 | Finished running 1 incremental model in 20.59s.
2020-05-28 10:52:48.759196 (MainThread): Connection 'master' was left open.
2020-05-28 10:52:48.760234 (MainThread): On master: Close
2020-05-28 10:52:49.899608 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 10:52:49.899608 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 10:52:50.758061 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 10:52:50.758061 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 10:52:51.542123 (MainThread): Connection 'model.vbi_zoho_people.TB_EMPLOYEEINACTIVE' was left open.
2020-05-28 10:52:51.542123 (MainThread): On model.vbi_zoho_people.TB_EMPLOYEEINACTIVE: Close
2020-05-28 10:52:52.778175 (MainThread): 
2020-05-28 10:52:52.778175 (MainThread): Completed successfully
2020-05-28 10:52:52.782203 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 10:52:52.785615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E685628>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E685460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E280D48>]}
2020-05-28 10:52:52.786743 (MainThread): Flushing usage events
2020-05-28 10:53:28.774411 (MainThread): Running with dbt=0.16.1
2020-05-28 10:53:29.039408 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 10:53:29.424504 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_EMPLOYEE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 10:53:29.424504 (MainThread): Tracking: tracking
2020-05-28 10:53:29.424504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D78BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E039088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E039100>]}
2020-05-28 10:53:29.452624 (MainThread): Partial parsing not enabled
2020-05-28 10:53:29.458980 (MainThread): Parsing macros\core.sql
2020-05-28 10:53:29.467015 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 10:53:29.536481 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 10:53:29.550714 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 10:53:29.550714 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 10:53:29.554740 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 10:53:29.554740 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 10:53:29.558743 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 10:53:29.562763 (MainThread): Parsing macros\etc\query.sql
2020-05-28 10:53:29.566786 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 10:53:29.577027 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 10:53:29.601111 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 10:53:29.605114 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 10:53:29.615566 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 10:53:29.649777 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 10:53:29.701959 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 10:53:29.705989 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 10:53:29.731236 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 10:53:29.743283 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 10:53:29.751324 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 10:53:29.764308 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 10:53:29.767588 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 10:53:29.768549 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 10:53:29.771755 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 10:53:29.772793 (MainThread): Parsing macros\adapters.sql
2020-05-28 10:53:29.805642 (MainThread): Parsing macros\catalog.sql
2020-05-28 10:53:29.809642 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 10:53:29.823616 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 10:53:29.824656 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 10:53:29.832708 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 10:53:29.860812 (MainThread): Partial parsing not enabled
2020-05-28 10:53:29.913221 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 10:53:29.913221 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:53:29.943526 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 10:53:29.943526 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:53:29.955565 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 10:53:29.955565 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:53:29.963583 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 10:53:29.963583 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:53:29.973808 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:53:29.973808 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:53:29.985857 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 10:53:29.985857 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:53:30.303374 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 10:53:30.309305 (MainThread): 
2020-05-28 10:53:30.315647 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 10:53:30.316645 (MainThread): Opening a new connection, currently in state init
2020-05-28 10:53:30.330177 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:53:30.331476 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 10:53:30.565041 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 10:53:30.565041 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 10:53:32.001670 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 10:53:33.540466 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.98 seconds
2020-05-28 10:53:33.642886 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:53:33.644314 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 10:53:33.649375 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:53:33.653374 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 10:53:37.206678 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.55 seconds
2020-05-28 10:53:37.206678 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 10:53:37.207671 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 10:53:38.364986 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.16 seconds
2020-05-28 10:53:38.386567 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 10:53:38.386567 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 10:53:38.983606 (MainThread): Using snowflake connection "master".
2020-05-28 10:53:38.983606 (MainThread): On master: BEGIN
2020-05-28 10:53:42.429249 (MainThread): SQL status: SUCCESS 1 in 3.44 seconds
2020-05-28 10:53:42.429249 (MainThread): On master: COMMIT
2020-05-28 10:53:42.429249 (MainThread): Using snowflake connection "master".
2020-05-28 10:53:42.429249 (MainThread): On master: COMMIT
2020-05-28 10:53:43.238365 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2020-05-28 10:53:43.238365 (MainThread): 16:23:43 | Concurrency: 1 threads (target='dev')
2020-05-28 10:53:43.242986 (MainThread): 16:23:43 | 
2020-05-28 10:53:43.254198 (Thread-1): Began running node model.vbi_zoho_people.TB_P_EMPLOYEE
2020-05-28 10:53:43.255201 (Thread-1): 16:23:43 | 1 of 1 START incremental model ANALYTICS.TB_P_EMPLOYEE............... [RUN]
2020-05-28 10:53:43.268950 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:53:43.268950 (Thread-1): Opening a new connection, currently in state init
2020-05-28 10:53:43.269956 (Thread-1): Compiling model.vbi_zoho_people.TB_P_EMPLOYEE
2020-05-28 10:53:43.361960 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_EMPLOYEE"
2020-05-28 10:53:43.366093 (Thread-1): finished collecting timing info
2020-05-28 10:53:43.438978 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_EMPLOYEE"
2020-05-28 10:53:43.445317 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:53:43.445317 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE: BEGIN
2020-05-28 10:53:46.422806 (Thread-1): SQL status: SUCCESS 1 in 2.98 seconds
2020-05-28 10:53:46.422806 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:53:46.422806 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_EMPLOYEE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_EMPLOYEE  as
      (

Select 
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::varchar(30) as APPROVALSTATUS,
    case 
        when length(SRC:"Date of joining") = 0 then
            to_date('01-Jan-0001', 'DD-Mon-YYYY')
        else
            to_date(SRC:"Date of joining"::String , 'DD-Mon-YYYY')
    end
    as DATE_OF_JOINING,
    SRC:"Department"::varchar(30) as DEPARTMENT,
    SRC:"Email ID"::varchar(40) as EMAIL_ID,
    SRC:"Employee Status"::varchar(25) as EMPLOYEE_STATUS,
    SRC:"Employee Type"::varchar(30) as EMPLOYEE_TYPE,
    SRC:"EmployeeID"::varchar(15) as EMPLOYEE_ID,
    SRC:"First Name"::varchar(50) as FIRST_NAME,
    SRC:"Last Name"::varchar(50) as LAST_NAME,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    SRC:"People Manager"::varchar(80) as PEOPLE_MANAGER,
    SRC:"Photo"::varchar(150) as PHOTO,
    SRC:"Photo_downloadUrl"::varchar(150) as PHOTO_DOWNLOAD_URL,
    SRC:"Project"::varchar(80) as PROJECT,
    SRC:"Title"::varchar(80) as TITLE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNER_ID,
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_EMPLOYEEVIEW


      );
2020-05-28 10:53:48.248151 (Thread-1): SQL status: SUCCESS 1 in 1.83 seconds
2020-05-28 10:53:48.252836 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE: COMMIT
2020-05-28 10:53:48.253115 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 10:53:48.254116 (Thread-1): On model.vbi_zoho_people.TB_P_EMPLOYEE: COMMIT
2020-05-28 10:53:48.675543 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2020-05-28 10:53:48.683706 (Thread-1): finished collecting timing info
2020-05-28 10:53:48.683706 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c72d01-98d1-4fa8-8b60-c370d17a2a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EF7CE38>]}
2020-05-28 10:53:48.687712 (Thread-1): 16:23:48 | 1 of 1 OK created incremental model ANALYTICS.TB_P_EMPLOYEE.......... [SUCCESS 1 in 5.42s]
2020-05-28 10:53:48.692827 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_EMPLOYEE
2020-05-28 10:53:48.697128 (MainThread): Using snowflake connection "master".
2020-05-28 10:53:48.698125 (MainThread): On master: BEGIN
2020-05-28 10:53:49.291011 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-28 10:53:49.292007 (MainThread): On master: COMMIT
2020-05-28 10:53:49.292654 (MainThread): Using snowflake connection "master".
2020-05-28 10:53:49.292654 (MainThread): On master: COMMIT
2020-05-28 10:53:49.968958 (MainThread): SQL status: SUCCESS 1 in 0.68 seconds
2020-05-28 10:53:49.968958 (MainThread): 16:23:49 | 
2020-05-28 10:53:49.975390 (MainThread): 16:23:49 | Finished running 1 incremental model in 19.65s.
2020-05-28 10:53:49.977382 (MainThread): Connection 'master' was left open.
2020-05-28 10:53:49.977382 (MainThread): On master: Close
2020-05-28 10:53:50.725929 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 10:53:50.725929 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 10:53:51.514796 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 10:53:51.514796 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 10:53:52.569659 (MainThread): Connection 'model.vbi_zoho_people.TB_P_EMPLOYEE' was left open.
2020-05-28 10:53:52.569659 (MainThread): On model.vbi_zoho_people.TB_P_EMPLOYEE: Close
2020-05-28 10:53:53.671291 (MainThread): 
2020-05-28 10:53:53.690178 (MainThread): Completed successfully
2020-05-28 10:53:53.694305 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 10:53:53.717976 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5AE970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5AECE8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1A1310>]}
2020-05-28 10:53:53.719060 (MainThread): Flushing usage events
2020-05-28 11:07:08.600043 (MainThread): Running with dbt=0.16.1
2020-05-28 11:07:08.943525 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:07:09.593319 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_ASSOCIATE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:07:09.593319 (MainThread): Tracking: tracking
2020-05-28 11:07:09.597420 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0BBA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E969358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E969058>]}
2020-05-28 11:07:09.659876 (MainThread): Partial parsing not enabled
2020-05-28 11:07:09.668801 (MainThread): Parsing macros\core.sql
2020-05-28 11:07:09.681645 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:07:09.794153 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:07:09.819092 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:07:09.822264 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:07:09.826535 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:07:09.832541 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:07:09.839109 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:07:09.843335 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:07:09.845378 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:07:09.868072 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:07:09.903972 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:07:09.909925 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:07:09.926582 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:07:09.982246 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:07:10.070741 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:07:10.074758 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:07:10.122058 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:07:10.141118 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:07:10.154990 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:07:10.172431 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:07:10.176466 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:07:10.180466 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:07:10.184494 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:07:10.188521 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:07:10.237161 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:07:10.241185 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:07:10.268016 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:07:10.273049 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:07:10.281215 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:07:10.333829 (MainThread): Partial parsing not enabled
2020-05-28 11:07:10.415223 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:07:10.417308 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:07:10.473300 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:07:10.511985 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:07:10.528544 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:07:10.528544 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:07:10.551907 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 11:07:10.551907 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:07:10.572141 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:07:10.572141 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:07:10.596179 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:07:10.596179 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:07:11.147806 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:07:11.159762 (MainThread): 
2020-05-28 11:07:11.168044 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:07:11.169147 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:07:11.183581 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:07:11.183581 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:07:11.419671 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:07:11.419671 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:07:13.481965 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:07:15.245261 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.83 seconds
2020-05-28 11:07:15.348237 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:07:15.348237 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:07:15.352247 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:07:15.352247 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:07:19.039075 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.69 seconds
2020-05-28 11:07:19.039075 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:07:19.039075 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:07:20.105139 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.07 seconds
2020-05-28 11:07:20.127044 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:07:20.127044 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:07:20.684577 (MainThread): Using snowflake connection "master".
2020-05-28 11:07:20.684577 (MainThread): On master: BEGIN
2020-05-28 11:07:23.039059 (MainThread): SQL status: SUCCESS 1 in 2.35 seconds
2020-05-28 11:07:23.039059 (MainThread): On master: COMMIT
2020-05-28 11:07:23.039059 (MainThread): Using snowflake connection "master".
2020-05-28 11:07:23.039059 (MainThread): On master: COMMIT
2020-05-28 11:07:23.599764 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2020-05-28 11:07:23.599764 (MainThread): 16:37:23 | Concurrency: 1 threads (target='dev')
2020-05-28 11:07:23.604684 (MainThread): 16:37:23 | 
2020-05-28 11:07:23.641141 (Thread-1): Began running node model.vbi_zoho_people.TB_ASSOCIATE
2020-05-28 11:07:23.642148 (Thread-1): 16:37:23 | 1 of 1 START incremental model ANALYTICS.TB_ASSOCIATE................ [RUN]
2020-05-28 11:07:23.663339 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:07:23.664335 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:07:23.664852 (Thread-1): Compiling model.vbi_zoho_people.TB_ASSOCIATE
2020-05-28 11:07:23.732381 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_ASSOCIATE"
2020-05-28 11:07:23.732381 (Thread-1): finished collecting timing info
2020-05-28 11:07:23.834022 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_ASSOCIATE"
2020-05-28 11:07:23.884256 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:07:23.884256 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE: BEGIN
2020-05-28 11:07:27.358062 (Thread-1): SQL status: SUCCESS 1 in 3.47 seconds
2020-05-28 11:07:27.358062 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:07:27.358062 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_ASSOCIATE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_ASSOCIATE  as
      (

Select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVALSTATUS,
    SRC:"Associate ID"::varchar(15) as ASSOCIATE_ID,
    SRC:"Associate type"::varchar(30) as ASSOCIATE_TYPE,
     case 
        when length(SRC:"Date of joining (dd-MMM-yyyy)") = 0 then
            to_date('01-Jan-0001', 'DD-Mon-YYYY')
        else
            to_date(SRC:"Date of joining (dd-MMM-yyyy)"::String , 'DD-Mon-YYYY')
    end
    as DATE_OF_JOINING,
    SRC:"Department"::varchar(30) as DEPARTMENT,
    SRC:"Designation"::varchar(80) as DESIGNATION,
    SRC:"Email ID"::varchar(40) as EMAIL_ID,
    SRC:"First Name"::varchar(50) as FIRST_NAME,
    SRC:"Last Name"::varchar(50) as LAST_NAME,
    SRC:"Location"::varchar(40) as LOCATION,
    SRC:"People Manager"::varchar(80) as PEOPLE_MANAGER,
    SRC:"Photo"::varchar(150) as PHOTO,
    SRC:"Photo_downloadUrl"::varchar(150) as PHOTO_DOWNLOAD_URL,
    SRC:"Work phone"::varchar(25) as WORK_PHONE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT, 
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_ASSOCIATE_VIEW


      );
2020-05-28 11:07:29.321788 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2020-05-28 11:07:29.325945 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE: COMMIT
2020-05-28 11:07:29.325945 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:07:29.325945 (Thread-1): On model.vbi_zoho_people.TB_ASSOCIATE: COMMIT
2020-05-28 11:07:30.139397 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2020-05-28 11:07:30.147461 (Thread-1): finished collecting timing info
2020-05-28 11:07:30.151462 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '784ec845-c7db-4908-a13d-d4902087c85e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA7B538>]}
2020-05-28 11:07:30.151462 (Thread-1): 16:37:30 | 1 of 1 OK created incremental model ANALYTICS.TB_ASSOCIATE........... [SUCCESS 1 in 6.49s]
2020-05-28 11:07:30.155414 (Thread-1): Finished running node model.vbi_zoho_people.TB_ASSOCIATE
2020-05-28 11:07:30.161691 (MainThread): Using snowflake connection "master".
2020-05-28 11:07:30.161691 (MainThread): On master: BEGIN
2020-05-28 11:07:30.753205 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-28 11:07:30.754202 (MainThread): On master: COMMIT
2020-05-28 11:07:30.754202 (MainThread): Using snowflake connection "master".
2020-05-28 11:07:30.754202 (MainThread): On master: COMMIT
2020-05-28 11:07:31.576549 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2020-05-28 11:07:31.578708 (MainThread): 16:37:31 | 
2020-05-28 11:07:31.581099 (MainThread): 16:37:31 | Finished running 1 incremental model in 20.41s.
2020-05-28 11:07:31.581099 (MainThread): Connection 'master' was left open.
2020-05-28 11:07:31.581099 (MainThread): On master: Close
2020-05-28 11:07:32.702907 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:07:32.702907 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:07:33.394598 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:07:33.394598 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:07:34.242095 (MainThread): Connection 'model.vbi_zoho_people.TB_ASSOCIATE' was left open.
2020-05-28 11:07:34.243093 (MainThread): On model.vbi_zoho_people.TB_ASSOCIATE: Close
2020-05-28 11:07:35.289326 (MainThread): 
2020-05-28 11:07:35.291641 (MainThread): Completed successfully
2020-05-28 11:07:35.323218 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 11:07:35.325802 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EEDEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EEDEB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EAD1BF8>]}
2020-05-28 11:07:35.326804 (MainThread): Flushing usage events
2020-05-28 11:17:29.157373 (MainThread): Running with dbt=0.16.1
2020-05-28 11:17:29.504989 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:17:30.160537 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_LEAVE_APPROVER'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:17:30.161872 (MainThread): Tracking: tracking
2020-05-28 11:17:30.161872 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D88BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1390A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E139100>]}
2020-05-28 11:17:30.212526 (MainThread): Partial parsing not enabled
2020-05-28 11:17:30.223028 (MainThread): Parsing macros\core.sql
2020-05-28 11:17:30.233065 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:17:30.356063 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:17:30.377438 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:17:30.380165 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:17:30.383440 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:17:30.387542 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:17:30.391602 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:17:30.396641 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:17:30.399077 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:17:30.416487 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:17:30.450749 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:17:30.457100 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:17:30.477045 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:17:30.530998 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:17:30.617358 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:17:30.622273 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:17:30.666281 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:17:30.688190 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:17:30.700973 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:17:30.720789 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:17:30.727120 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:17:30.730174 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:17:30.734244 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:17:30.738850 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:17:30.787652 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:17:30.794942 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:17:30.821707 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:17:30.827396 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:17:30.847640 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:17:30.907252 (MainThread): Partial parsing not enabled
2020-05-28 11:17:30.978179 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:17:30.978179 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:17:31.020233 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:17:31.020233 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:17:31.039380 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:17:31.039380 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:17:31.062550 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 11:17:31.063547 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:17:31.080707 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:17:31.080707 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:17:31.102970 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:17:31.102970 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:17:31.772650 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:17:31.784730 (MainThread): 
2020-05-28 11:17:31.794454 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:17:31.795454 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:17:31.810459 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:17:31.810459 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:17:32.050012 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:17:32.051008 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:17:34.189960 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:17:35.744141 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.69 seconds
2020-05-28 11:17:35.873309 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:17:35.873833 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:17:35.880164 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:17:35.880164 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:17:39.108713 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.23 seconds
2020-05-28 11:17:39.108713 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:17:39.109712 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:17:40.453525 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.34 seconds
2020-05-28 11:17:40.477602 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:17:40.477602 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:17:41.068905 (MainThread): Using snowflake connection "master".
2020-05-28 11:17:41.072977 (MainThread): On master: BEGIN
2020-05-28 11:17:44.010834 (MainThread): SQL status: SUCCESS 1 in 2.94 seconds
2020-05-28 11:17:44.012107 (MainThread): On master: COMMIT
2020-05-28 11:17:44.012107 (MainThread): Using snowflake connection "master".
2020-05-28 11:17:44.013146 (MainThread): On master: COMMIT
2020-05-28 11:17:44.667204 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2020-05-28 11:17:44.668201 (MainThread): 16:47:44 | Concurrency: 1 threads (target='dev')
2020-05-28 11:17:44.668441 (MainThread): 16:47:44 | 
2020-05-28 11:17:44.673431 (Thread-1): Began running node model.vbi_zoho_people.TB_LEAVE_APPROVER
2020-05-28 11:17:44.674426 (Thread-1): 16:47:44 | 1 of 1 START incremental model ANALYTICS.TB_LEAVE_APPROVER........... [RUN]
2020-05-28 11:17:44.675423 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:17:44.675423 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:17:44.676420 (Thread-1): Compiling model.vbi_zoho_people.TB_LEAVE_APPROVER
2020-05-28 11:17:44.723875 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER"
2020-05-28 11:17:44.724874 (Thread-1): finished collecting timing info
2020-05-28 11:17:44.799941 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_LEAVE_APPROVER"
2020-05-28 11:17:44.802481 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:17:44.803477 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER: BEGIN
2020-05-28 11:17:47.216541 (Thread-1): SQL status: SUCCESS 1 in 2.41 seconds
2020-05-28 11:17:47.216541 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:17:47.216541 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_LEAVE_APPROVER"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_LEAVE_APPROVER  as
      (

select 
     SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    SRC:"Associate ID"::varchar(80) as ASSOCIATE_ID,
    SRC:"Explain Reason for leave"::varchar(1000) as EXPLAIN_REASON_FOR_LEAVE,  
    SRC:"From (mm/dd/yyyy)"::Date as FROM_DATE,  
    SRC:"Leave type"::varchar(40) as LEAVE_TYPE,
    SRC:"To (mm/dd/yyyy)"::Date as TO_DATE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,    
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_LEAVE_APPROVER_VIEW   


      );
2020-05-28 11:17:49.156398 (Thread-1): SQL status: SUCCESS 1 in 1.94 seconds
2020-05-28 11:17:49.160411 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER: COMMIT
2020-05-28 11:17:49.160411 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:17:49.164410 (Thread-1): On model.vbi_zoho_people.TB_LEAVE_APPROVER: COMMIT
2020-05-28 11:17:49.669665 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-05-28 11:17:49.677838 (Thread-1): finished collecting timing info
2020-05-28 11:17:49.677838 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f3994f6-b647-4f7b-8aad-35dc12c81ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F07CE38>]}
2020-05-28 11:17:49.681830 (Thread-1): 16:47:49 | 1 of 1 OK created incremental model ANALYTICS.TB_LEAVE_APPROVER...... [SUCCESS 1 in 5.00s]
2020-05-28 11:17:49.685881 (Thread-1): Finished running node model.vbi_zoho_people.TB_LEAVE_APPROVER
2020-05-28 11:17:49.692199 (MainThread): Using snowflake connection "master".
2020-05-28 11:17:49.692199 (MainThread): On master: BEGIN
2020-05-28 11:17:50.284461 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-28 11:17:50.284461 (MainThread): On master: COMMIT
2020-05-28 11:17:50.284461 (MainThread): Using snowflake connection "master".
2020-05-28 11:17:50.284461 (MainThread): On master: COMMIT
2020-05-28 11:17:51.103728 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2020-05-28 11:17:51.104726 (MainThread): 16:47:51 | 
2020-05-28 11:17:51.106000 (MainThread): 16:47:51 | Finished running 1 incremental model in 19.31s.
2020-05-28 11:17:51.106998 (MainThread): Connection 'master' was left open.
2020-05-28 11:17:51.106998 (MainThread): On master: Close
2020-05-28 11:17:51.944019 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:17:51.944019 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:17:53.041627 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:17:53.041627 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:17:53.778570 (MainThread): Connection 'model.vbi_zoho_people.TB_LEAVE_APPROVER' was left open.
2020-05-28 11:17:53.779568 (MainThread): On model.vbi_zoho_people.TB_LEAVE_APPROVER: Close
2020-05-28 11:17:54.589288 (MainThread): 
2020-05-28 11:17:54.593368 (MainThread): Completed successfully
2020-05-28 11:17:54.593368 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 11:17:54.606663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6B9B98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6B9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E2A0310>]}
2020-05-28 11:17:54.607004 (MainThread): Flushing usage events
2020-05-28 11:24:35.743382 (MainThread): Running with dbt=0.16.1
2020-05-28 11:24:36.103871 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:24:36.745181 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_REPORTING_CHANGES'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:24:36.749333 (MainThread): Tracking: tracking
2020-05-28 11:24:36.750200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D91BB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1C9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1C92B0>]}
2020-05-28 11:24:36.803835 (MainThread): Partial parsing not enabled
2020-05-28 11:24:36.814232 (MainThread): Parsing macros\core.sql
2020-05-28 11:24:36.826927 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:24:36.943485 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:24:36.968354 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:24:36.972368 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:24:36.975178 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:24:36.980400 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:24:36.984442 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:24:36.992569 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:24:36.995749 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:24:37.017288 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:24:37.052242 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:24:37.056245 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:24:37.072427 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:24:37.129409 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:24:37.220482 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:24:37.224443 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:24:37.272846 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:24:37.289023 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:24:37.305180 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:24:37.323713 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:24:37.325734 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:24:37.329801 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:24:37.333797 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:24:37.341338 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:24:37.389471 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:24:37.393499 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:24:37.417092 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:24:37.425047 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:24:37.435344 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:24:37.489461 (MainThread): Partial parsing not enabled
2020-05-28 11:24:37.564872 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:24:37.564872 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:24:37.619945 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:24:37.619945 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:24:37.640015 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:24:37.640015 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:24:37.658357 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 11:24:37.658357 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:24:37.673564 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:24:37.673564 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:24:37.694151 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:24:37.694151 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:24:38.235571 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:24:38.247570 (MainThread): 
2020-05-28 11:24:38.251738 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:24:38.251738 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:24:38.268266 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:24:38.268266 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:24:38.502788 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:24:38.502788 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:24:40.179986 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:24:41.352421 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.85 seconds
2020-05-28 11:24:41.462357 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:24:41.462357 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:24:41.463354 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:24:41.463354 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:24:44.600500 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.14 seconds
2020-05-28 11:24:44.600500 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:24:44.600500 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:24:46.035162 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.43 seconds
2020-05-28 11:24:46.055333 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:24:46.055333 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:24:46.853485 (MainThread): Using snowflake connection "master".
2020-05-28 11:24:46.857660 (MainThread): On master: BEGIN
2020-05-28 11:24:49.311094 (MainThread): SQL status: SUCCESS 1 in 2.45 seconds
2020-05-28 11:24:49.311094 (MainThread): On master: COMMIT
2020-05-28 11:24:49.311094 (MainThread): Using snowflake connection "master".
2020-05-28 11:24:49.311094 (MainThread): On master: COMMIT
2020-05-28 11:24:50.130355 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2020-05-28 11:24:50.130355 (MainThread): 16:54:50 | Concurrency: 1 threads (target='dev')
2020-05-28 11:24:50.135438 (MainThread): 16:54:50 | 
2020-05-28 11:24:50.146454 (Thread-1): Began running node model.vbi_zoho_people.TB_REPORTING_CHANGES
2020-05-28 11:24:50.147491 (Thread-1): 16:54:50 | 1 of 1 START incremental model ANALYTICS.TB_REPORTING_CHANGES........ [RUN]
2020-05-28 11:24:50.161231 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:24:50.161231 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:24:50.162228 (Thread-1): Compiling model.vbi_zoho_people.TB_REPORTING_CHANGES
2020-05-28 11:24:50.247975 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES"
2020-05-28 11:24:50.252075 (Thread-1): finished collecting timing info
2020-05-28 11:24:50.319886 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_REPORTING_CHANGES"
2020-05-28 11:24:50.368875 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:24:50.368875 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES: BEGIN
2020-05-28 11:24:53.073703 (Thread-1): SQL status: SUCCESS 1 in 2.70 seconds
2020-05-28 11:24:53.073703 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:24:53.073703 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_REPORTING_CHANGES"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_REPORTING_CHANGES  as
      (

select 
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"Associate ID"::varchar(80) as ASSOCIATE_ID,
    SRC:"Comments"::varchar(1000) as COMMENTS,
    SRC:"New People Manager"::varchar(80) as NEW_PEOPLE_MANAGER,
    SRC:"Added By"::varchar(80) as ADDED_BY,
    SRC:"ownerID"::varchar(30) as OWNER_ID,
    SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    SRC:"Effective"::Date as EFFECTIVE,
    SRC:"recordId"::varchar(20) as RECORDID,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    SRC:"Current People Manager"::varchar(80) as CURRENT_PEOPLE_MANAGER,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT 
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_REPORTING_CHANGES_VIEW


      );
2020-05-28 11:24:54.569154 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-05-28 11:24:54.577356 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES: COMMIT
2020-05-28 11:24:54.577356 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:24:54.577356 (Thread-1): On model.vbi_zoho_people.TB_REPORTING_CHANGES: COMMIT
2020-05-28 11:24:55.250533 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2020-05-28 11:24:55.258738 (Thread-1): finished collecting timing info
2020-05-28 11:24:55.258738 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c89337-5b15-471f-95a7-5f3e2370559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E741838>]}
2020-05-28 11:24:55.262741 (Thread-1): 16:54:55 | 1 of 1 OK created incremental model ANALYTICS.TB_REPORTING_CHANGES... [SUCCESS 1 in 5.10s]
2020-05-28 11:24:55.266600 (Thread-1): Finished running node model.vbi_zoho_people.TB_REPORTING_CHANGES
2020-05-28 11:24:55.271825 (MainThread): Using snowflake connection "master".
2020-05-28 11:24:55.271825 (MainThread): On master: BEGIN
2020-05-28 11:24:55.697518 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2020-05-28 11:24:55.697518 (MainThread): On master: COMMIT
2020-05-28 11:24:55.697518 (MainThread): Using snowflake connection "master".
2020-05-28 11:24:55.697518 (MainThread): On master: COMMIT
2020-05-28 11:24:56.479681 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2020-05-28 11:24:56.479681 (MainThread): 16:54:56 | 
2020-05-28 11:24:56.484414 (MainThread): 16:54:56 | Finished running 1 incremental model in 18.23s.
2020-05-28 11:24:56.487404 (MainThread): Connection 'master' was left open.
2020-05-28 11:24:56.487404 (MainThread): On master: Close
2020-05-28 11:24:57.327591 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:24:57.327591 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:24:58.170768 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:24:58.174767 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:24:58.939728 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES' was left open.
2020-05-28 11:24:58.939728 (MainThread): On model.vbi_zoho_people.TB_REPORTING_CHANGES: Close
2020-05-28 11:24:59.775497 (MainThread): 
2020-05-28 11:24:59.777213 (MainThread): Completed successfully
2020-05-28 11:24:59.802910 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 11:24:59.806512 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E334E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E334700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3348B0>]}
2020-05-28 11:24:59.807509 (MainThread): Flushing usage events
2020-05-28 11:28:29.517376 (MainThread): Running with dbt=0.16.1
2020-05-28 11:28:29.876989 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:28:30.269298 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:28:30.269298 (MainThread): Tracking: tracking
2020-05-28 11:28:30.269298 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D60BB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DEBA430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DEBA190>]}
2020-05-28 11:28:30.298852 (MainThread): Partial parsing not enabled
2020-05-28 11:28:30.302938 (MainThread): Parsing macros\core.sql
2020-05-28 11:28:30.310894 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:28:30.391379 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:28:30.418058 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:28:30.418058 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:28:30.422003 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:28:30.431694 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:28:30.435311 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:28:30.442385 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:28:30.446386 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:28:30.467792 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:28:30.499791 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:28:30.507791 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:28:30.523791 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:28:30.586283 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:28:30.668706 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:28:30.672705 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:28:30.694923 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:28:30.706970 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:28:30.710986 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:28:30.723026 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:28:30.723026 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:28:30.727055 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:28:30.727055 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:28:30.733251 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:28:30.757299 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:28:30.761294 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:28:30.771492 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:28:30.775484 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:28:30.782906 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:28:30.809911 (MainThread): Partial parsing not enabled
2020-05-28 11:28:30.857844 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:28:30.857844 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:28:30.890531 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:28:30.890531 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:28:30.898573 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:28:30.898573 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:28:30.910617 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 11:28:30.910617 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:28:30.916813 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:28:30.916813 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:28:30.928798 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:28:30.928798 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:28:31.226709 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:28:31.232926 (MainThread): 
2020-05-28 11:28:31.237116 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:28:31.237116 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:28:31.246800 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:28:31.246800 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:28:31.423980 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:28:31.423980 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:28:32.961929 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:28:34.424989 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.00 seconds
2020-05-28 11:28:34.536148 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:28:34.537631 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:28:34.546711 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:28:34.546711 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:28:37.255484 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.71 seconds
2020-05-28 11:28:37.255484 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:28:37.259565 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:28:38.449906 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.19 seconds
2020-05-28 11:28:38.467386 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:28:38.467386 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:28:39.104261 (MainThread): Using snowflake connection "master".
2020-05-28 11:28:39.104261 (MainThread): On master: BEGIN
2020-05-28 11:28:41.454138 (MainThread): SQL status: SUCCESS 1 in 2.35 seconds
2020-05-28 11:28:41.454138 (MainThread): On master: COMMIT
2020-05-28 11:28:41.458302 (MainThread): Using snowflake connection "master".
2020-05-28 11:28:41.458302 (MainThread): On master: COMMIT
2020-05-28 11:28:42.069054 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 11:28:42.069054 (MainThread): 16:58:42 | Concurrency: 1 threads (target='dev')
2020-05-28 11:28:42.070838 (MainThread): 16:58:42 | 
2020-05-28 11:28:42.077265 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 11:28:42.077265 (Thread-1): 16:58:42 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-28 11:28:42.085061 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 11:28:42.085061 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:28:42.086058 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 11:28:42.131193 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 11:28:42.133443 (Thread-1): finished collecting timing info
2020-05-28 11:28:42.207301 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 11:28:42.213622 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 11:28:42.214619 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 11:28:44.626320 (Thread-1): SQL status: SUCCESS 1 in 2.41 seconds
2020-05-28 11:28:44.626320 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 11:28:44.626320 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
     case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    CASE
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    CASE
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:30:07.779618 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7752232.
2020-05-28 11:30:07.779618 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-28 11:30:07.779618 (Thread-1): initiating rollback
2020-05-28 11:30:08.322607 (Thread-1): finished collecting timing info
2020-05-28 11:30:08.322607 (Thread-1): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7752232.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7752232.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7752232.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 11:30:08.334767 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00d113dd-9460-474b-a29d-cee6022281c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDFA3D0>]}
2020-05-28 11:30:08.334767 (Thread-1): 17:00:08 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLY_LEAVE... [ERROR in 86.25s]
2020-05-28 11:30:08.334767 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 11:30:08.339751 (MainThread): Using snowflake connection "master".
2020-05-28 11:30:08.340748 (MainThread): On master: BEGIN
2020-05-28 11:30:08.885427 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2020-05-28 11:30:08.885427 (MainThread): On master: COMMIT
2020-05-28 11:30:08.889541 (MainThread): Using snowflake connection "master".
2020-05-28 11:30:08.889541 (MainThread): On master: COMMIT
2020-05-28 11:30:10.237600 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2020-05-28 11:30:10.237600 (MainThread): 17:00:10 | 
2020-05-28 11:30:10.241712 (MainThread): 17:00:10 | Finished running 1 incremental model in 99.00s.
2020-05-28 11:30:10.241712 (MainThread): Connection 'master' was left open.
2020-05-28 11:30:10.241712 (MainThread): On master: Close
2020-05-28 11:30:10.988110 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:30:10.988110 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:30:12.080817 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:30:12.080817 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:30:13.123790 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 11:30:13.123790 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 11:30:14.128691 (MainThread): 
2020-05-28 11:30:14.131128 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 11:30:14.135148 (MainThread): 
2020-05-28 11:30:14.149395 (MainThread): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
2020-05-28 11:30:14.151140 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 11:30:14.151140 (MainThread):   Processing aborted due to error 300010:3898809911; incident 7752232.
2020-05-28 11:30:14.151140 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 11:30:14.151140 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 11:30:14.155137 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E42DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E024760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E024790>]}
2020-05-28 11:30:14.155137 (MainThread): Flushing usage events
2020-05-28 11:36:27.589763 (MainThread): Running with dbt=0.16.1
2020-05-28 11:36:27.853507 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:36:28.245491 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:36:28.245491 (MainThread): Tracking: tracking
2020-05-28 11:36:28.245491 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D91BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1D9088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1D90B8>]}
2020-05-28 11:36:28.275835 (MainThread): Partial parsing not enabled
2020-05-28 11:36:28.282935 (MainThread): Parsing macros\core.sql
2020-05-28 11:36:28.290973 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:36:28.356793 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:36:28.368833 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:36:28.372844 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:36:28.375033 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:36:28.375033 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:36:28.381705 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:36:28.384408 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:36:28.386458 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:36:28.399851 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:36:28.419103 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:36:28.423119 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:36:28.431137 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:36:28.465443 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:36:28.519201 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:36:28.523217 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:36:28.548619 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:36:28.560661 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:36:28.568689 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:36:28.580721 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:36:28.584748 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:36:28.584748 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:36:28.588747 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:36:28.590970 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:36:28.618104 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:36:28.624326 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:36:28.639362 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:36:28.640397 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:36:28.648499 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:36:28.676982 (MainThread): Partial parsing not enabled
2020-05-28 11:36:28.725543 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:36:28.725543 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:36:28.758120 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:36:28.758120 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:36:28.770166 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:36:28.770166 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:36:28.778194 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:36:28.778194 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:36:28.790238 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:36:28.790238 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:36:28.800440 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:36:28.800440 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:36:29.120240 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:36:29.128918 (MainThread): 
2020-05-28 11:36:29.137421 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:36:29.137421 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:36:29.151389 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:36:29.152057 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:36:29.345762 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:36:29.345762 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:36:31.395709 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:36:32.954749 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.61 seconds
2020-05-28 11:36:33.054621 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:36:33.055618 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:36:33.059624 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:36:33.059624 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:36:35.983780 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.92 seconds
2020-05-28 11:36:35.983780 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:36:35.983780 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:36:38.451128 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 2.47 seconds
2020-05-28 11:36:38.470053 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:36:38.470053 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:36:39.120461 (MainThread): Using snowflake connection "master".
2020-05-28 11:36:39.121466 (MainThread): On master: BEGIN
2020-05-28 11:36:42.128253 (MainThread): SQL status: SUCCESS 1 in 3.01 seconds
2020-05-28 11:36:42.128253 (MainThread): On master: COMMIT
2020-05-28 11:36:42.128253 (MainThread): Using snowflake connection "master".
2020-05-28 11:36:42.128253 (MainThread): On master: COMMIT
2020-05-28 11:36:42.732832 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 11:36:42.732832 (MainThread): 17:06:42 | Concurrency: 1 threads (target='dev')
2020-05-28 11:36:42.738007 (MainThread): 17:06:42 | 
2020-05-28 11:36:42.749132 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:36:42.750183 (Thread-1): 17:06:42 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 11:36:42.767019 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:36:42.767019 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:36:42.768980 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:36:42.851961 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:36:42.853513 (Thread-1): finished collecting timing info
2020-05-28 11:36:42.909022 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:36:42.914181 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:36:42.914181 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 11:36:45.916984 (Thread-1): SQL status: SUCCESS 1 in 3.00 seconds
2020-05-28 11:36:45.916984 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:36:45.916984 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
     case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    CASE
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    CASE
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:38:04.152911 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 3348755.
2020-05-28 11:38:04.152911 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 11:38:04.152911 (Thread-1): initiating rollback
2020-05-28 11:38:04.563039 (Thread-1): finished collecting timing info
2020-05-28 11:38:04.567227 (Thread-1): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 3348755.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 3348755.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 3348755.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:38:04.586134 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f20a5ca-87a1-432b-99d7-128351b2eea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F11D490>]}
2020-05-28 11:38:04.586134 (Thread-1): 17:08:04 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLYLEAVE.... [ERROR in 81.82s]
2020-05-28 11:38:04.592165 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:38:04.597158 (MainThread): Using snowflake connection "master".
2020-05-28 11:38:04.597515 (MainThread): On master: BEGIN
2020-05-28 11:38:05.175670 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2020-05-28 11:38:05.175670 (MainThread): On master: COMMIT
2020-05-28 11:38:05.175670 (MainThread): Using snowflake connection "master".
2020-05-28 11:38:05.175670 (MainThread): On master: COMMIT
2020-05-28 11:38:05.791672 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 11:38:05.791672 (MainThread): 17:08:05 | 
2020-05-28 11:38:05.796311 (MainThread): 17:08:05 | Finished running 1 incremental model in 96.65s.
2020-05-28 11:38:05.799292 (MainThread): Connection 'master' was left open.
2020-05-28 11:38:05.799292 (MainThread): On master: Close
2020-05-28 11:38:07.021250 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:38:07.021250 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:38:08.454979 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:38:08.454979 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:38:09.478127 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 11:38:09.478127 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 11:38:10.520723 (MainThread): 
2020-05-28 11:38:10.522108 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 11:38:10.525802 (MainThread): 
2020-05-28 11:38:10.549228 (MainThread): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
2020-05-28 11:38:10.552219 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 11:38:10.554213 (MainThread):   Processing aborted due to error 300010:3898809911; incident 3348755.
2020-05-28 11:38:10.556290 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:38:10.558286 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 11:38:10.561365 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E754028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E754BF8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E741CD0>]}
2020-05-28 11:38:10.562718 (MainThread): Flushing usage events
2020-05-28 11:38:40.569559 (MainThread): Running with dbt=0.16.1
2020-05-28 11:38:40.838191 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:38:41.232863 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:38:41.232863 (MainThread): Tracking: tracking
2020-05-28 11:38:41.232863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E57B808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE29028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE29070>]}
2020-05-28 11:38:41.264863 (MainThread): Partial parsing not enabled
2020-05-28 11:38:41.268863 (MainThread): Parsing macros\core.sql
2020-05-28 11:38:41.276863 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:38:41.345934 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:38:41.361934 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:38:41.361934 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:38:41.365934 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:38:41.365934 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:38:41.369934 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:38:41.373934 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:38:41.377934 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:38:41.389934 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:38:41.409934 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:38:41.413934 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:38:41.425257 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:38:41.461298 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:38:41.514434 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:38:41.518434 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:38:41.542434 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:38:41.554434 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:38:41.563481 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:38:41.573693 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:38:41.578842 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:38:41.578842 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:38:41.582798 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:38:41.582798 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:38:41.610798 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:38:41.614798 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:38:41.630798 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:38:41.630798 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:38:41.638798 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:38:41.666798 (MainThread): Partial parsing not enabled
2020-05-28 11:38:41.719058 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:38:41.719058 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:38:41.751058 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:38:41.751058 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:38:41.759058 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:38:41.759058 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:38:41.771058 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:38:41.771058 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:38:41.783058 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:38:41.783058 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:38:41.795058 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:38:41.795058 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:38:42.116953 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:38:42.124089 (MainThread): 
2020-05-28 11:38:42.127810 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:38:42.127810 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:38:42.139632 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:38:42.140731 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:38:42.332343 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:38:42.332343 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:38:43.951257 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:38:45.521785 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.19 seconds
2020-05-28 11:38:45.631030 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:38:45.632358 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:38:45.637572 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:38:45.641568 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:38:48.401363 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.76 seconds
2020-05-28 11:38:48.401363 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:38:48.401363 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:38:49.824973 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.42 seconds
2020-05-28 11:38:49.850336 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:38:49.850503 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:38:51.064793 (MainThread): Using snowflake connection "master".
2020-05-28 11:38:51.064793 (MainThread): On master: BEGIN
2020-05-28 11:38:54.002176 (MainThread): SQL status: SUCCESS 1 in 2.94 seconds
2020-05-28 11:38:54.002176 (MainThread): On master: COMMIT
2020-05-28 11:38:54.002176 (MainThread): Using snowflake connection "master".
2020-05-28 11:38:54.002176 (MainThread): On master: COMMIT
2020-05-28 11:38:54.606865 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 11:38:54.606865 (MainThread): 17:08:54 | Concurrency: 1 threads (target='dev')
2020-05-28 11:38:54.610117 (MainThread): 17:08:54 | 
2020-05-28 11:38:54.621721 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:38:54.622757 (Thread-1): 17:08:54 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 11:38:54.639687 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:38:54.640137 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:38:54.641132 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:38:54.704843 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:38:54.707536 (Thread-1): finished collecting timing info
2020-05-28 11:38:54.766119 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:38:54.769149 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:38:54.769149 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 11:38:57.606845 (Thread-1): SQL status: SUCCESS 1 in 2.84 seconds
2020-05-28 11:38:57.607843 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:38:57.607843 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    CASE
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    CASE
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:40:12.154515 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7026750.
2020-05-28 11:40:12.154515 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 11:40:12.154515 (Thread-1): initiating rollback
2020-05-28 11:40:12.718086 (Thread-1): finished collecting timing info
2020-05-28 11:40:12.722284 (Thread-1): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7026750.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7026750.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7026750.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:40:12.750286 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63128977-cf9b-45dc-abce-0653af6e8813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0FD6FF58>]}
2020-05-28 11:40:12.750286 (Thread-1): 17:10:12 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLYLEAVE.... [ERROR in 78.11s]
2020-05-28 11:40:12.757131 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:40:12.761329 (MainThread): Using snowflake connection "master".
2020-05-28 11:40:12.762334 (MainThread): On master: BEGIN
2020-05-28 11:40:13.589696 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2020-05-28 11:40:13.589696 (MainThread): On master: COMMIT
2020-05-28 11:40:13.589696 (MainThread): Using snowflake connection "master".
2020-05-28 11:40:13.589696 (MainThread): On master: COMMIT
2020-05-28 11:40:14.159584 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 11:40:14.159584 (MainThread): 17:10:14 | 
2020-05-28 11:40:14.164483 (MainThread): 17:10:14 | Finished running 1 incremental model in 92.03s.
2020-05-28 11:40:14.167063 (MainThread): Connection 'master' was left open.
2020-05-28 11:40:14.168061 (MainThread): On master: Close
2020-05-28 11:40:15.215355 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:40:15.215355 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:40:16.060560 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:40:16.060560 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:40:17.072514 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 11:40:17.072514 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 11:40:17.906071 (MainThread): 
2020-05-28 11:40:17.907628 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 11:40:17.911328 (MainThread): 
2020-05-28 11:40:17.934067 (MainThread): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
2020-05-28 11:40:17.938206 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 11:40:17.939977 (MainThread):   Processing aborted due to error 300010:3898809911; incident 7026750.
2020-05-28 11:40:17.942016 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:40:17.944000 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 11:40:17.971134 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F3A6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EEFCDA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F394DD8>]}
2020-05-28 11:40:17.972105 (MainThread): Flushing usage events
2020-05-28 11:41:06.650289 (MainThread): Running with dbt=0.16.1
2020-05-28 11:41:06.881926 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:41:07.283380 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:41:07.287380 (MainThread): Tracking: tracking
2020-05-28 11:41:07.287380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D62BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DED9088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DED90E8>]}
2020-05-28 11:41:07.315380 (MainThread): Partial parsing not enabled
2020-05-28 11:41:07.323380 (MainThread): Parsing macros\core.sql
2020-05-28 11:41:07.327380 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:41:07.395380 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:41:07.411380 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:41:07.411380 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:41:07.415380 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:41:07.419380 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:41:07.419380 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:41:07.423380 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:41:07.427380 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:41:07.438117 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:41:07.461970 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:41:07.465099 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:41:07.475110 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:41:07.507110 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:41:07.559110 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:41:07.563110 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:41:07.591110 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:41:07.603110 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:41:07.611110 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:41:07.619110 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:41:07.623110 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:41:07.623110 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:41:07.627110 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:41:07.631110 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:41:07.659110 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:41:07.659110 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:41:07.675110 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:41:07.679110 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:41:07.683110 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:41:07.715110 (MainThread): Partial parsing not enabled
2020-05-28 11:41:07.763110 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:41:07.763110 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:07.795110 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:41:07.795110 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:07.807110 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:41:07.807110 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:07.818213 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:41:07.818213 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:07.826213 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:41:07.826213 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:07.838213 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:41:07.838213 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:08.226295 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:41:08.234323 (MainThread): 
2020-05-28 11:41:08.236666 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:41:08.236666 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:08.246135 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:41:08.247132 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:41:08.425324 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:41:08.425324 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:41:10.391414 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:41:11.757781 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.33 seconds
2020-05-28 11:41:11.785782 (MainThread): Connection 'master' was properly closed.
2020-05-28 11:41:11.786820 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:41:11.786820 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:41:12.364993 (MainThread): Flushing usage events
2020-05-28 11:41:14.018743 (MainThread): Connection 'master' was properly closed.
2020-05-28 11:41:14.018743 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:41:14.018743 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:41:16.477925 (MainThread): ctrl-c
2020-05-28 11:41:25.894205 (MainThread): Running with dbt=0.16.1
2020-05-28 11:41:26.167916 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:41:26.582339 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:41:26.586371 (MainThread): Tracking: tracking
2020-05-28 11:41:26.587373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DB1BB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3C9058>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3C9088>]}
2020-05-28 11:41:26.617386 (MainThread): Partial parsing not enabled
2020-05-28 11:41:26.625441 (MainThread): Parsing macros\core.sql
2020-05-28 11:41:26.633393 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:41:26.721923 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:41:26.740096 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:41:26.740096 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:41:26.744051 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:41:26.748051 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:41:26.752127 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:41:26.752127 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:41:26.756057 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:41:26.768063 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:41:26.796075 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:41:26.800128 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:41:26.812162 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:41:26.860196 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:41:26.936324 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:41:26.939319 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:41:26.971333 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:41:26.982096 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:41:26.992456 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:41:27.005674 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:41:27.009675 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:41:27.013751 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:41:27.013751 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:41:27.017681 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:41:27.055775 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:41:27.059828 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:41:27.075788 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:41:27.079788 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:41:27.083847 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:41:27.119861 (MainThread): Partial parsing not enabled
2020-05-28 11:41:27.178091 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:41:27.178091 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:27.213198 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:41:27.213198 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:27.227509 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:41:27.227509 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:27.235587 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:41:27.235587 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:27.247571 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:41:27.247571 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:27.259600 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:41:27.259600 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:27.623912 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:41:27.631417 (MainThread): 
2020-05-28 11:41:27.639087 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:41:27.639087 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:41:27.649612 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:41:27.650613 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:41:27.827572 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:41:27.827572 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:41:29.414656 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:41:30.669197 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.84 seconds
2020-05-28 11:41:30.777210 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:41:30.778535 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:41:30.787772 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:41:30.787772 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:41:33.775975 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.99 seconds
2020-05-28 11:41:33.775975 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:41:33.775975 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:41:35.053348 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.28 seconds
2020-05-28 11:41:35.057337 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:41:35.057337 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:41:35.590440 (MainThread): Using snowflake connection "master".
2020-05-28 11:41:35.590440 (MainThread): On master: BEGIN
2020-05-28 11:41:37.757018 (MainThread): SQL status: SUCCESS 1 in 2.17 seconds
2020-05-28 11:41:37.757018 (MainThread): On master: COMMIT
2020-05-28 11:41:37.757018 (MainThread): Using snowflake connection "master".
2020-05-28 11:41:37.757018 (MainThread): On master: COMMIT
2020-05-28 11:41:38.397689 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 11:41:38.398717 (MainThread): 17:11:38 | Concurrency: 1 threads (target='dev')
2020-05-28 11:41:38.399685 (MainThread): 17:11:38 | 
2020-05-28 11:41:38.402676 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:41:38.402676 (Thread-1): 17:11:38 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 11:41:38.407663 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:41:38.408662 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:41:38.408662 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:41:38.426646 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:41:38.427610 (Thread-1): finished collecting timing info
2020-05-28 11:41:38.463544 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:41:38.465539 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:41:38.465539 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 11:41:41.122959 (Thread-1): SQL status: SUCCESS 1 in 2.66 seconds
2020-05-28 11:41:41.123955 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:41:41.123955 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
     case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    CASE
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    CASE
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:42:59.757751 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 1178620.
2020-05-28 11:42:59.758806 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 11:42:59.759802 (Thread-1): initiating rollback
2020-05-28 11:43:00.138756 (Thread-1): finished collecting timing info
2020-05-28 11:43:00.138756 (Thread-1): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 1178620.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 1178620.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 1178620.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:43:00.142790 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc7d067-4794-43c8-90ad-eeb940ef4d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E93E838>]}
2020-05-28 11:43:00.142790 (Thread-1): 17:13:00 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLYLEAVE.... [ERROR in 81.74s]
2020-05-28 11:43:00.144077 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:43:00.146074 (MainThread): Using snowflake connection "master".
2020-05-28 11:43:00.146074 (MainThread): On master: BEGIN
2020-05-28 11:43:00.719209 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 11:43:00.720207 (MainThread): On master: COMMIT
2020-05-28 11:43:00.721203 (MainThread): Using snowflake connection "master".
2020-05-28 11:43:00.721203 (MainThread): On master: COMMIT
2020-05-28 11:43:01.358237 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 11:43:01.360268 (MainThread): 17:13:01 | 
2020-05-28 11:43:01.361220 (MainThread): 17:13:01 | Finished running 1 incremental model in 93.72s.
2020-05-28 11:43:01.362217 (MainThread): Connection 'master' was left open.
2020-05-28 11:43:01.362217 (MainThread): On master: Close
2020-05-28 11:43:02.198764 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:43:02.198764 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:43:02.959553 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:43:02.959553 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:43:03.657857 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 11:43:03.657857 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 11:43:04.561255 (MainThread): 
2020-05-28 11:43:04.561255 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 11:43:04.563250 (MainThread): 
2020-05-28 11:43:04.569235 (MainThread): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
2020-05-28 11:43:04.571230 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 11:43:04.571230 (MainThread):   Processing aborted due to error 300010:3898809911; incident 1178620.
2020-05-28 11:43:04.572228 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:43:04.573223 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 11:43:04.574266 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9437D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9430A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E534790>]}
2020-05-28 11:43:04.574266 (MainThread): Flushing usage events
2020-05-28 11:43:32.956890 (MainThread): Running with dbt=0.16.1
2020-05-28 11:43:33.090888 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:43:33.335235 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:43:33.335235 (MainThread): Tracking: tracking
2020-05-28 11:43:33.335235 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DBABAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E459028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E459058>]}
2020-05-28 11:43:33.355181 (MainThread): Partial parsing not enabled
2020-05-28 11:43:33.358174 (MainThread): Parsing macros\core.sql
2020-05-28 11:43:33.363160 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:43:33.406046 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:43:33.416019 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:43:33.417016 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:43:33.418014 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:43:33.421005 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:43:33.423000 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:43:33.424995 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:43:33.425992 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:43:33.433971 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:43:33.447933 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:43:33.449928 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:43:33.455912 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:43:33.477853 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:43:33.511763 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:43:33.513757 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:43:33.532707 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:43:33.540685 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:43:33.545672 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:43:33.552653 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:43:33.554648 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:43:33.555646 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:43:33.557640 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:43:33.558638 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:43:33.578584 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:43:33.580579 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:43:33.589555 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:43:33.591550 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:43:33.595539 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:43:33.615485 (MainThread): Partial parsing not enabled
2020-05-28 11:43:33.647400 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:43:33.647400 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:43:33.670339 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:43:33.671336 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:43:33.677321 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:43:33.678318 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:43:33.686296 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:43:33.686296 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:43:33.693278 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:43:33.693278 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:43:33.700259 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:43:33.700259 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:43:33.914698 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:43:33.920687 (MainThread): 
2020-05-28 11:43:33.922749 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:43:33.923752 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:43:33.930737 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:43:33.930737 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:43:34.028474 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:43:34.028474 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:43:35.469916 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:43:36.651123 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.62 seconds
2020-05-28 11:43:36.676403 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:43:36.676403 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:43:36.678400 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:43:36.678400 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:43:38.825795 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.15 seconds
2020-05-28 11:43:38.825795 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:43:38.826766 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:43:40.078051 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.25 seconds
2020-05-28 11:43:40.090015 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:43:40.091012 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:43:40.736591 (MainThread): Using snowflake connection "master".
2020-05-28 11:43:40.737628 (MainThread): On master: BEGIN
2020-05-28 11:43:43.117777 (MainThread): SQL status: SUCCESS 1 in 2.38 seconds
2020-05-28 11:43:43.117777 (MainThread): On master: COMMIT
2020-05-28 11:43:43.117777 (MainThread): Using snowflake connection "master".
2020-05-28 11:43:43.117777 (MainThread): On master: COMMIT
2020-05-28 11:43:43.688513 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 11:43:43.688513 (MainThread): 17:13:43 | Concurrency: 1 threads (target='dev')
2020-05-28 11:43:43.689504 (MainThread): 17:13:43 | 
2020-05-28 11:43:43.694456 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:43:43.694456 (Thread-1): 17:13:43 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 11:43:43.701445 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:43:43.701445 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:43:43.701445 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:43:43.725417 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:43:43.726414 (Thread-1): finished collecting timing info
2020-05-28 11:43:43.762282 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:43:43.765278 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:43:43.765278 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 11:43:45.842088 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2020-05-28 11:43:45.842088 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:43:45.843083 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:45:03.508512 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7061969.
2020-05-28 11:45:03.509498 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 11:45:03.509498 (Thread-1): initiating rollback
2020-05-28 11:45:03.895839 (Thread-1): finished collecting timing info
2020-05-28 11:45:03.896834 (Thread-1): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7061969.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 7061969.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 7061969.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:45:03.902821 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bc535d5-446a-49de-a8cf-40020b913347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E552580>]}
2020-05-28 11:45:03.903820 (Thread-1): 17:15:03 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLYLEAVE.... [ERROR in 80.20s]
2020-05-28 11:45:03.904769 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:45:03.905756 (MainThread): Using snowflake connection "master".
2020-05-28 11:45:03.906755 (MainThread): On master: BEGIN
2020-05-28 11:45:04.570689 (MainThread): SQL status: SUCCESS 1 in 0.66 seconds
2020-05-28 11:45:04.571686 (MainThread): On master: COMMIT
2020-05-28 11:45:04.572761 (MainThread): Using snowflake connection "master".
2020-05-28 11:45:04.572761 (MainThread): On master: COMMIT
2020-05-28 11:45:05.277371 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2020-05-28 11:45:05.279366 (MainThread): 17:15:05 | 
2020-05-28 11:45:05.281318 (MainThread): 17:15:05 | Finished running 1 incremental model in 91.36s.
2020-05-28 11:45:05.283320 (MainThread): Connection 'master' was left open.
2020-05-28 11:45:05.284359 (MainThread): On master: Close
2020-05-28 11:45:06.253957 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:45:06.254949 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:45:06.995277 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:45:06.995277 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:45:07.717080 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 11:45:07.718081 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 11:45:08.454477 (MainThread): 
2020-05-28 11:45:08.455475 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 11:45:08.457469 (MainThread): 
2020-05-28 11:45:08.467442 (MainThread): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
2020-05-28 11:45:08.468439 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 11:45:08.469438 (MainThread):   Processing aborted due to error 300010:3898809911; incident 7061969.
2020-05-28 11:45:08.470435 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:45:08.471431 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 11:45:08.472428 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9CEF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5BF8F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E5BF1A8>]}
2020-05-28 11:45:08.472428 (MainThread): Flushing usage events
2020-05-28 11:50:54.852629 (MainThread): Running with dbt=0.16.1
2020-05-28 11:50:54.992257 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:50:55.248634 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:50:55.249629 (MainThread): Tracking: tracking
2020-05-28 11:50:55.249629 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DB1BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3C9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E3C9070>]}
2020-05-28 11:50:55.269583 (MainThread): Partial parsing not enabled
2020-05-28 11:50:55.273563 (MainThread): Parsing macros\core.sql
2020-05-28 11:50:55.279549 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:50:55.324310 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:50:55.334282 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:50:55.336254 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:50:55.337215 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:50:55.339269 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:50:55.342262 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:50:55.344255 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:50:55.345225 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:50:55.353245 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:50:55.368190 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:50:55.370191 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:50:55.377115 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:50:55.400106 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:50:55.435012 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:50:55.436961 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:50:55.455805 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:50:55.463845 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:50:55.468832 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:50:55.475783 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:50:55.477792 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:50:55.479786 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:50:55.480784 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:50:55.482778 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:50:55.501728 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:50:55.504719 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:50:55.513657 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:50:55.515674 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:50:55.519678 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:50:55.540623 (MainThread): Partial parsing not enabled
2020-05-28 11:50:55.573535 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:50:55.573535 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:50:55.595513 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:50:55.595513 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:50:55.602457 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:50:55.602457 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:50:55.610436 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:50:55.610436 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:50:55.616407 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:50:55.617419 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:50:55.623402 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:50:55.624399 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:50:55.841317 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:50:55.846255 (MainThread): 
2020-05-28 11:50:55.851242 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:50:55.851242 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:50:55.860272 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:50:55.861217 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:50:55.958017 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:50:55.958017 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:50:57.232574 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:50:58.406196 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.45 seconds
2020-05-28 11:50:58.445142 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:50:58.446104 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:50:58.448126 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:50:58.448126 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:51:00.614419 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.17 seconds
2020-05-28 11:51:00.615425 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:51:00.615425 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:51:02.328056 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.71 seconds
2020-05-28 11:51:02.333027 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:51:02.333027 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:51:03.324212 (MainThread): Using snowflake connection "master".
2020-05-28 11:51:03.324212 (MainThread): On master: BEGIN
2020-05-28 11:51:05.349483 (MainThread): SQL status: SUCCESS 1 in 2.03 seconds
2020-05-28 11:51:05.350480 (MainThread): On master: COMMIT
2020-05-28 11:51:05.350480 (MainThread): Using snowflake connection "master".
2020-05-28 11:51:05.350480 (MainThread): On master: COMMIT
2020-05-28 11:51:06.025892 (MainThread): SQL status: SUCCESS 1 in 0.68 seconds
2020-05-28 11:51:06.026881 (MainThread): 17:21:06 | Concurrency: 1 threads (target='dev')
2020-05-28 11:51:06.028920 (MainThread): 17:21:06 | 
2020-05-28 11:51:06.047822 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:51:06.048860 (Thread-1): 17:21:06 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 11:51:06.049820 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:51:06.049820 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:51:06.049820 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:51:06.073754 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:51:06.073754 (Thread-1): finished collecting timing info
2020-05-28 11:51:06.111693 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:51:06.113645 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:51:06.113645 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 11:51:08.759884 (Thread-1): SQL status: SUCCESS 1 in 2.65 seconds
2020-05-28 11:51:08.759884 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:51:08.759884 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:51:10.709585 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2020-05-28 11:51:10.712531 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 11:51:10.713582 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:51:10.713582 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 11:51:11.205958 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2020-05-28 11:51:11.207986 (Thread-1): finished collecting timing info
2020-05-28 11:51:11.209083 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc24c868-bbdb-425d-924e-8195ff14afed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EEAA508>]}
2020-05-28 11:51:11.209083 (Thread-1): 17:21:11 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 5.16s]
2020-05-28 11:51:11.210943 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:51:11.211970 (MainThread): Using snowflake connection "master".
2020-05-28 11:51:11.211970 (MainThread): On master: BEGIN
2020-05-28 11:51:11.675736 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2020-05-28 11:51:11.676731 (MainThread): On master: COMMIT
2020-05-28 11:51:11.676731 (MainThread): Using snowflake connection "master".
2020-05-28 11:51:11.676731 (MainThread): On master: COMMIT
2020-05-28 11:51:12.333768 (MainThread): SQL status: SUCCESS 1 in 0.66 seconds
2020-05-28 11:51:12.334819 (MainThread): 17:21:12 | 
2020-05-28 11:51:12.336760 (MainThread): 17:21:12 | Finished running 1 incremental model in 16.48s.
2020-05-28 11:51:12.337756 (MainThread): Connection 'master' was left open.
2020-05-28 11:51:12.338753 (MainThread): On master: Close
2020-05-28 11:51:13.155695 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:51:13.156738 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:51:13.918197 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:51:13.919197 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:51:14.696339 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 11:51:14.696339 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 11:51:15.479525 (MainThread): 
2020-05-28 11:51:15.479525 (MainThread): Completed successfully
2020-05-28 11:51:15.481520 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 11:51:15.487503 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E948F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9486D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E935DD8>]}
2020-05-28 11:51:15.487503 (MainThread): Flushing usage events
2020-05-28 11:53:19.836119 (MainThread): Running with dbt=0.16.1
2020-05-28 11:53:19.973529 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:53:20.229132 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:53:20.230119 (MainThread): Tracking: tracking
2020-05-28 11:53:20.230119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D67BB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF29058>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF29088>]}
2020-05-28 11:53:20.250063 (MainThread): Partial parsing not enabled
2020-05-28 11:53:20.253057 (MainThread): Parsing macros\core.sql
2020-05-28 11:53:20.259040 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:53:20.304240 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:53:20.314213 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:53:20.315196 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:53:20.316193 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:53:20.319199 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:53:20.321195 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:53:20.323190 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:53:20.324187 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:53:20.333166 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:53:20.347123 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:53:20.349122 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:53:20.356102 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:53:20.380038 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:53:20.413946 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:53:20.416924 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:53:20.434890 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:53:20.441873 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:53:20.447856 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:53:20.454840 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:53:20.456852 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:53:20.458826 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:53:20.459826 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:53:20.461820 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:53:20.481765 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:53:20.483761 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:53:20.493732 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:53:20.495723 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:53:20.499718 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:53:20.520673 (MainThread): Partial parsing not enabled
2020-05-28 11:53:20.553529 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:53:20.553529 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:53:20.576520 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:53:20.576520 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:53:20.583493 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:53:20.583493 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:53:20.591475 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:53:20.591475 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:53:20.599447 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:53:20.599447 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:53:20.607426 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:53:20.607426 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:53:20.823847 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:53:20.828824 (MainThread): 
2020-05-28 11:53:20.832782 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:53:20.832782 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:53:20.839803 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:53:20.840760 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:53:20.936504 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:53:20.937501 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:53:22.611459 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:53:23.827776 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.89 seconds
2020-05-28 11:53:23.867687 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:53:23.867687 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:53:23.869721 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:53:23.869721 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:53:25.818591 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.95 seconds
2020-05-28 11:53:25.819597 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:53:25.819597 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:53:27.244831 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.42 seconds
2020-05-28 11:53:27.252806 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:53:27.252806 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:53:27.899411 (MainThread): Using snowflake connection "master".
2020-05-28 11:53:27.899411 (MainThread): On master: BEGIN
2020-05-28 11:53:30.104020 (MainThread): SQL status: SUCCESS 1 in 2.20 seconds
2020-05-28 11:53:30.105022 (MainThread): On master: COMMIT
2020-05-28 11:53:30.105022 (MainThread): Using snowflake connection "master".
2020-05-28 11:53:30.105022 (MainThread): On master: COMMIT
2020-05-28 11:53:30.728352 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2020-05-28 11:53:30.730348 (MainThread): 17:23:30 | Concurrency: 1 threads (target='dev')
2020-05-28 11:53:30.732300 (MainThread): 17:23:30 | 
2020-05-28 11:53:30.741313 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:53:30.741313 (Thread-1): 17:23:30 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 11:53:30.745262 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:53:30.745262 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:53:30.745262 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:53:30.770022 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:53:30.771019 (Thread-1): finished collecting timing info
2020-05-28 11:53:30.817893 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:53:30.818891 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:53:30.819888 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 11:53:32.895527 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2020-05-28 11:53:32.895527 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:53:32.895527 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
   
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:53:34.530111 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2020-05-28 11:53:34.533048 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 11:53:34.533048 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:53:34.533048 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 11:53:34.943596 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-05-28 11:53:34.946605 (Thread-1): finished collecting timing info
2020-05-28 11:53:34.947577 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc251f0-602c-45b7-9ee6-ecf0e1d43333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE6DDF0>]}
2020-05-28 11:53:34.947577 (Thread-1): 17:23:34 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 4.20s]
2020-05-28 11:53:34.948534 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:53:34.949532 (MainThread): Using snowflake connection "master".
2020-05-28 11:53:34.949532 (MainThread): On master: BEGIN
2020-05-28 11:53:35.446947 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2020-05-28 11:53:35.447948 (MainThread): On master: COMMIT
2020-05-28 11:53:35.448949 (MainThread): Using snowflake connection "master".
2020-05-28 11:53:35.448949 (MainThread): On master: COMMIT
2020-05-28 11:53:36.021300 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 11:53:36.022307 (MainThread): 17:23:36 | 
2020-05-28 11:53:36.024250 (MainThread): 17:23:36 | Finished running 1 incremental model in 15.19s.
2020-05-28 11:53:36.024250 (MainThread): Connection 'master' was left open.
2020-05-28 11:53:36.025252 (MainThread): On master: Close
2020-05-28 11:53:36.933965 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:53:36.933965 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:53:37.658630 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:53:37.659675 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:53:38.360599 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 11:53:38.361590 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 11:53:39.295294 (MainThread): 
2020-05-28 11:53:39.296290 (MainThread): Completed successfully
2020-05-28 11:53:39.297290 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 11:53:39.303273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4A5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E094D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E094868>]}
2020-05-28 11:53:39.304271 (MainThread): Flushing usage events
2020-05-28 11:54:37.181859 (MainThread): Running with dbt=0.16.1
2020-05-28 11:54:37.320807 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 11:54:37.573667 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 11:54:37.574627 (MainThread): Tracking: tracking
2020-05-28 11:54:37.574627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE9BBC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7490D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E749100>]}
2020-05-28 11:54:37.595574 (MainThread): Partial parsing not enabled
2020-05-28 11:54:37.599663 (MainThread): Parsing macros\core.sql
2020-05-28 11:54:37.604650 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 11:54:37.648659 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 11:54:37.658688 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 11:54:37.660684 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 11:54:37.661680 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 11:54:37.663676 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 11:54:37.666668 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 11:54:37.668675 (MainThread): Parsing macros\etc\query.sql
2020-05-28 11:54:37.669664 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 11:54:37.678146 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 11:54:37.692217 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 11:54:37.695207 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 11:54:37.702208 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 11:54:37.726097 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 11:54:37.761004 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 11:54:37.762998 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 11:54:37.780950 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 11:54:37.788929 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 11:54:37.793916 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 11:54:37.800897 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 11:54:37.803889 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 11:54:37.804887 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 11:54:37.805884 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 11:54:37.807878 (MainThread): Parsing macros\adapters.sql
2020-05-28 11:54:37.827825 (MainThread): Parsing macros\catalog.sql
2020-05-28 11:54:37.829820 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 11:54:37.839793 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 11:54:37.841788 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 11:54:37.845777 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 11:54:37.866721 (MainThread): Partial parsing not enabled
2020-05-28 11:54:37.899633 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 11:54:37.899633 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:54:37.921575 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 11:54:37.922572 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:54:37.928556 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 11:54:37.928556 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:54:37.936535 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:54:37.936535 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:54:37.943516 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 11:54:37.943516 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:54:37.950497 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 11:54:37.950497 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:54:38.167469 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 11:54:38.173454 (MainThread): 
2020-05-28 11:54:38.176956 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 11:54:38.176956 (MainThread): Opening a new connection, currently in state init
2020-05-28 11:54:38.183937 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:54:38.183937 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 11:54:38.280720 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 11:54:38.281720 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 11:54:39.471643 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 11:54:40.628516 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.35 seconds
2020-05-28 11:54:40.660427 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:54:40.660427 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 11:54:40.662463 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:54:40.662463 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 11:54:42.842893 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.18 seconds
2020-05-28 11:54:42.842893 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 11:54:42.843890 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 11:54:43.992562 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.15 seconds
2020-05-28 11:54:44.010512 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 11:54:44.011509 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 11:54:44.781378 (MainThread): Using snowflake connection "master".
2020-05-28 11:54:44.782330 (MainThread): On master: BEGIN
2020-05-28 11:54:46.875080 (MainThread): SQL status: SUCCESS 1 in 2.09 seconds
2020-05-28 11:54:46.876024 (MainThread): On master: COMMIT
2020-05-28 11:54:46.876024 (MainThread): Using snowflake connection "master".
2020-05-28 11:54:46.876024 (MainThread): On master: COMMIT
2020-05-28 11:54:47.455003 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2020-05-28 11:54:47.455003 (MainThread): 17:24:47 | Concurrency: 1 threads (target='dev')
2020-05-28 11:54:47.456998 (MainThread): 17:24:47 | 
2020-05-28 11:54:47.463040 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:54:47.464026 (Thread-1): 17:24:47 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 11:54:47.473018 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:54:47.473018 (Thread-1): Opening a new connection, currently in state init
2020-05-28 11:54:47.473018 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:54:47.493001 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:54:47.493001 (Thread-1): finished collecting timing info
2020-05-28 11:54:47.529896 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 11:54:47.533896 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:54:47.533896 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 11:54:49.428603 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2020-05-28 11:54:49.428603 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 11:54:49.428603 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::String as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 11:56:14.400395 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 9151315.
2020-05-28 11:56:14.400395 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 11:56:14.400395 (Thread-1): initiating rollback
2020-05-28 11:56:14.823229 (Thread-1): finished collecting timing info
2020-05-28 11:56:14.824185 (Thread-1): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 9151315.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 9151315.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 9151315.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:56:14.828215 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd7c1d7-12fc-4e68-bc99-5c7290869082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F689760>]}
2020-05-28 11:56:14.828215 (Thread-1): 17:26:14 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLYLEAVE.... [ERROR in 87.36s]
2020-05-28 11:56:14.830164 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 11:56:14.831161 (MainThread): Using snowflake connection "master".
2020-05-28 11:56:14.832204 (MainThread): On master: BEGIN
2020-05-28 11:56:15.325505 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2020-05-28 11:56:15.325505 (MainThread): On master: COMMIT
2020-05-28 11:56:15.326556 (MainThread): Using snowflake connection "master".
2020-05-28 11:56:15.326556 (MainThread): On master: COMMIT
2020-05-28 11:56:15.936027 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 11:56:15.937024 (MainThread): 17:26:15 | 
2020-05-28 11:56:15.938022 (MainThread): 17:26:15 | Finished running 1 incremental model in 97.76s.
2020-05-28 11:56:15.940017 (MainThread): Connection 'master' was left open.
2020-05-28 11:56:15.941014 (MainThread): On master: Close
2020-05-28 11:56:16.709504 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 11:56:16.710500 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 11:56:17.483663 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 11:56:17.483663 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 11:56:18.283027 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 11:56:18.284080 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 11:56:19.003539 (MainThread): 
2020-05-28 11:56:19.004593 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 11:56:19.005592 (MainThread): 
2020-05-28 11:56:19.005592 (MainThread): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
2020-05-28 11:56:19.006594 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 11:56:19.007587 (MainThread):   Processing aborted due to error 300010:3898809911; incident 9151315.
2020-05-28 11:56:19.007587 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 11:56:19.007587 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 11:56:19.008584 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8A9B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8A91D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8A9A48>]}
2020-05-28 11:56:19.008584 (MainThread): Flushing usage events
2020-05-28 12:14:54.786377 (MainThread): Running with dbt=0.16.1
2020-05-28 12:14:54.919312 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:14:55.170652 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:14:55.171649 (MainThread): Tracking: tracking
2020-05-28 12:14:55.171649 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE2BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6D9028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6D9088>]}
2020-05-28 12:14:55.191596 (MainThread): Partial parsing not enabled
2020-05-28 12:14:55.195585 (MainThread): Parsing macros\core.sql
2020-05-28 12:14:55.200572 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:14:55.242460 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:14:55.252433 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:14:55.253430 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:14:55.254428 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:14:55.256422 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:14:55.259414 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:14:55.260412 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:14:55.262406 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:14:55.270385 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:14:55.284348 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:14:55.286342 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:14:55.292326 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:14:55.314268 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:14:55.346182 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:14:55.348697 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:14:55.366156 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:14:55.373137 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:14:55.378124 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:14:55.384108 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:14:55.387100 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:14:55.388097 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:14:55.389095 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:14:55.391090 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:14:55.410039 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:14:55.412033 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:14:55.422007 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:14:55.423004 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:14:55.426993 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:14:55.447937 (MainThread): Partial parsing not enabled
2020-05-28 12:14:55.479852 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:14:55.479852 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:14:55.501794 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:14:55.501794 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:14:55.507777 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:14:55.507777 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:14:55.515756 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:14:55.515756 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:14:55.521740 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:14:55.521740 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:14:55.528721 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:14:55.528721 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:14:55.733174 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:14:55.737667 (MainThread): 
2020-05-28 12:14:55.742624 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:14:55.742624 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:14:55.749635 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:14:55.750642 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:14:55.854326 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:14:55.854326 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:14:57.183094 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:14:58.368247 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.51 seconds
2020-05-28 12:14:58.394768 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:14:58.394768 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:14:58.397761 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:14:58.397761 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:15:00.927270 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.53 seconds
2020-05-28 12:15:00.927270 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:15:00.928268 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:15:02.206707 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.28 seconds
2020-05-28 12:15:02.214678 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:15:02.214678 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:15:02.850158 (MainThread): Using snowflake connection "master".
2020-05-28 12:15:02.851152 (MainThread): On master: BEGIN
2020-05-28 12:15:05.249215 (MainThread): SQL status: SUCCESS 1 in 2.40 seconds
2020-05-28 12:15:05.250214 (MainThread): On master: COMMIT
2020-05-28 12:15:05.250214 (MainThread): Using snowflake connection "master".
2020-05-28 12:15:05.251210 (MainThread): On master: COMMIT
2020-05-28 12:15:06.070097 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2020-05-28 12:15:06.071094 (MainThread): 17:45:06 | Concurrency: 1 threads (target='dev')
2020-05-28 12:15:06.072189 (MainThread): 17:45:06 | 
2020-05-28 12:15:06.076025 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:15:06.076025 (Thread-1): 17:45:06 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:15:06.083007 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:15:06.083007 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:15:06.083007 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:15:06.101956 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:15:06.102994 (Thread-1): finished collecting timing info
2020-05-28 12:15:06.137904 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:15:06.139899 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:15:06.139899 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:15:08.109549 (Thread-1): SQL status: SUCCESS 1 in 1.97 seconds
2020-05-28 12:15:08.110586 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:15:08.110586 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:16:29.913749 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 1243594.
2020-05-28 12:16:29.914752 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 12:16:29.914752 (Thread-1): initiating rollback
2020-05-28 12:16:30.307555 (Thread-1): finished collecting timing info
2020-05-28 12:16:30.309545 (Thread-1): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 1243594.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 1243594.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 1243594.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 12:16:30.314523 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6285d79-2511-4ab3-bb92-8859dd6df0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F61D3E8>]}
2020-05-28 12:16:30.314523 (Thread-1): 17:46:30 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLYLEAVE.... [ERROR in 84.23s]
2020-05-28 12:16:30.316474 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:16:30.317472 (MainThread): Using snowflake connection "master".
2020-05-28 12:16:30.317472 (MainThread): On master: BEGIN
2020-05-28 12:16:30.847716 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2020-05-28 12:16:30.848715 (MainThread): On master: COMMIT
2020-05-28 12:16:30.848715 (MainThread): Using snowflake connection "master".
2020-05-28 12:16:30.849710 (MainThread): On master: COMMIT
2020-05-28 12:16:31.575957 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2020-05-28 12:16:31.577957 (MainThread): 17:46:31 | 
2020-05-28 12:16:31.578804 (MainThread): 17:46:31 | Finished running 1 incremental model in 95.84s.
2020-05-28 12:16:31.578804 (MainThread): Connection 'master' was left open.
2020-05-28 12:16:31.579805 (MainThread): On master: Close
2020-05-28 12:16:32.509197 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:16:32.509197 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:16:33.472431 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:16:33.472431 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:16:34.212652 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:16:34.213650 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:16:35.015201 (MainThread): 
2020-05-28 12:16:35.016266 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 12:16:35.017163 (MainThread): 
2020-05-28 12:16:35.024686 (MainThread): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
2020-05-28 12:16:35.025685 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 12:16:35.026721 (MainThread):   Processing aborted due to error 300010:3898809911; incident 1243594.
2020-05-28 12:16:35.027726 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 12:16:35.027726 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 12:16:35.028675 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC56670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E840CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E840898>]}
2020-05-28 12:16:35.029673 (MainThread): Flushing usage events
2020-05-28 12:18:53.374619 (MainThread): Running with dbt=0.16.1
2020-05-28 12:18:53.505262 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:18:53.748634 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:18:53.748634 (MainThread): Tracking: tracking
2020-05-28 12:18:53.749632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DDDBBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6890A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E689118>]}
2020-05-28 12:18:53.767584 (MainThread): Partial parsing not enabled
2020-05-28 12:18:53.771573 (MainThread): Parsing macros\core.sql
2020-05-28 12:18:53.776560 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:18:53.819445 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:18:53.828421 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:18:53.829419 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:18:53.830416 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:18:53.833408 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:18:53.835402 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:18:53.837397 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:18:53.838395 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:18:53.846373 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:18:53.859338 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:18:53.861333 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:18:53.868314 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:18:53.890256 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:18:53.922170 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:18:53.924165 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:18:53.941120 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:18:53.948101 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:18:53.954085 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:18:53.960069 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:18:53.962064 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:18:53.963061 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:18:53.965056 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:18:53.967051 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:18:53.985002 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:18:53.987995 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:18:53.995973 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:18:53.997968 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:18:54.001957 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:18:54.021904 (MainThread): Partial parsing not enabled
2020-05-28 12:18:54.053818 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:18:54.053818 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:18:54.075760 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:18:54.075760 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:18:54.081744 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:18:54.082741 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:18:54.088725 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:18:54.089723 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:18:54.095707 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:18:54.095707 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:18:54.102688 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:18:54.102688 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:18:54.306144 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:18:54.311258 (MainThread): 
2020-05-28 12:18:54.316247 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:18:54.316247 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:18:54.324225 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:18:54.324225 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:18:54.414046 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:18:54.415041 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:18:55.701749 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:18:57.018684 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.60 seconds
2020-05-28 12:18:57.045661 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:18:57.045661 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:18:57.047656 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:18:57.047656 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:18:59.737842 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.69 seconds
2020-05-28 12:18:59.738831 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:18:59.738831 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:19:00.803197 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.06 seconds
2020-05-28 12:19:00.810178 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:19:00.811177 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:19:01.662396 (MainThread): Using snowflake connection "master".
2020-05-28 12:19:01.663394 (MainThread): On master: BEGIN
2020-05-28 12:19:03.960794 (MainThread): SQL status: SUCCESS 1 in 2.30 seconds
2020-05-28 12:19:03.960794 (MainThread): On master: COMMIT
2020-05-28 12:19:03.961791 (MainThread): Using snowflake connection "master".
2020-05-28 12:19:03.962799 (MainThread): On master: COMMIT
2020-05-28 12:19:04.550238 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-28 12:19:04.551228 (MainThread): 17:49:04 | Concurrency: 1 threads (target='dev')
2020-05-28 12:19:04.551906 (MainThread): 17:49:04 | 
2020-05-28 12:19:04.554901 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:19:04.554901 (Thread-1): 17:49:04 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:19:04.563018 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:19:04.563018 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:19:04.563018 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:19:04.582964 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:19:04.583960 (Thread-1): finished collecting timing info
2020-05-28 12:19:04.617869 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:19:04.619864 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:19:04.619864 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:19:06.852555 (Thread-1): SQL status: SUCCESS 1 in 2.23 seconds
2020-05-28 12:19:06.852555 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:19:06.853559 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:19:08.787970 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2020-05-28 12:19:08.791958 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:19:08.791958 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:19:08.792959 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:19:09.199399 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-05-28 12:19:09.204375 (Thread-1): finished collecting timing info
2020-05-28 12:19:09.204375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c98599-e3a5-48bb-b803-9279d6635713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F5CDFD0>]}
2020-05-28 12:19:09.205373 (Thread-1): 17:49:09 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 4.64s]
2020-05-28 12:19:09.206370 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:19:09.207366 (MainThread): Using snowflake connection "master".
2020-05-28 12:19:09.208412 (MainThread): On master: BEGIN
2020-05-28 12:19:09.695572 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2020-05-28 12:19:09.696559 (MainThread): On master: COMMIT
2020-05-28 12:19:09.697575 (MainThread): Using snowflake connection "master".
2020-05-28 12:19:09.697575 (MainThread): On master: COMMIT
2020-05-28 12:19:10.399309 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2020-05-28 12:19:10.400304 (MainThread): 17:49:10 | 
2020-05-28 12:19:10.401713 (MainThread): 17:49:10 | Finished running 1 incremental model in 16.09s.
2020-05-28 12:19:10.401713 (MainThread): Connection 'master' was left open.
2020-05-28 12:19:10.401713 (MainThread): On master: Close
2020-05-28 12:19:11.257973 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:19:11.258967 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:19:12.001229 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:19:12.001229 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:19:12.854204 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:19:12.854204 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:19:13.835399 (MainThread): 
2020-05-28 12:19:13.836352 (MainThread): Completed successfully
2020-05-28 12:19:13.837350 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:19:13.844332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC057A8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7EAB98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E786970>]}
2020-05-28 12:19:13.845329 (MainThread): Flushing usage events
2020-05-28 12:20:20.798406 (MainThread): Running with dbt=0.16.1
2020-05-28 12:20:20.928100 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:20:21.172445 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-28 12:20:21.172445 (MainThread): Tracking: tracking
2020-05-28 12:20:21.172445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D84BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0FA028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0FA0A0>]}
2020-05-28 12:20:21.191396 (MainThread): Partial parsing not enabled
2020-05-28 12:20:21.195383 (MainThread): Parsing macros\core.sql
2020-05-28 12:20:21.200380 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:20:21.242258 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:20:21.252233 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:20:21.253230 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:20:21.254231 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:20:21.256221 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:20:21.259173 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:20:21.261168 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:20:21.262165 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:20:21.270188 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:20:21.283149 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:20:21.286145 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:20:21.292125 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:20:21.313070 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:20:21.345983 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:20:21.347976 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:20:21.364930 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:20:21.371913 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:20:21.376901 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:20:21.383883 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:20:21.385875 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:20:21.387871 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:20:21.388867 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:20:21.390863 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:20:21.408816 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:20:21.410822 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:20:21.419784 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:20:21.421782 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:20:21.425768 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:20:21.445715 (MainThread): Partial parsing not enabled
2020-05-28 12:20:21.480248 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:20:21.480248 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:21.502190 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:20:21.502190 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:21.508173 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:20:21.508173 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:21.515153 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:20:21.515153 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:21.522138 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:20:21.522138 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:21.528120 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:20:21.528120 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:21.734613 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:20:21.739487 (MainThread): 
2020-05-28 12:20:21.744459 (MainThread): 17:50:21 | Concurrency: 1 threads (target='dev')
2020-05-28 12:20:21.745457 (MainThread): 17:50:21 | 
2020-05-28 12:20:21.749445 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:20:21.749445 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:20:21.750443 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:20:21.750443 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:20:21.767412 (Thread-1): On "model.vbi_zoho_people.TB_P_APPLYLEAVE": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-28 12:20:21.862221 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:20:21.862221 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:20:23.230982 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:20:25.022661 (Thread-1): SQL status: SUCCESS 1 in 3.16 seconds
2020-05-28 12:20:25.022661 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:20:25.023659 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:20:26.436668 (Thread-1): SQL status: SUCCESS 6 in 1.41 seconds
2020-05-28 12:20:26.449293 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_EMPLOYEEINACTIVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_APPLYLEAVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_EMPLOYEE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES">]
2020-05-28 12:20:26.450859 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:20:26.451850 (Thread-1): finished collecting timing info
2020-05-28 12:20:26.451850 (Thread-1): finished collecting timing info
2020-05-28 12:20:26.451850 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 12:20:26.451850 (Thread-1): initiating rollback
2020-05-28 12:20:27.041514 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:20:27.042675 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES' was properly closed.
2020-05-28 12:20:27.042675 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:20:27.042675 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:20:27.770269 (MainThread): 17:50:27 | Done.
2020-05-28 12:20:27.771225 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E26BC28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E26BDA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E26BCB8>]}
2020-05-28 12:20:27.771225 (MainThread): Flushing usage events
2020-05-28 12:20:47.985049 (MainThread): Running with dbt=0.16.1
2020-05-28 12:20:48.115996 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:20:48.358338 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:20:48.358338 (MainThread): Tracking: tracking
2020-05-28 12:20:48.358338 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF1B9B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7CA100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7CA130>]}
2020-05-28 12:20:48.377287 (MainThread): Partial parsing not enabled
2020-05-28 12:20:48.381276 (MainThread): Parsing macros\core.sql
2020-05-28 12:20:48.386260 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:20:48.431468 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:20:48.441439 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:20:48.443435 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:20:48.444432 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:20:48.447424 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:20:48.450417 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:20:48.452411 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:20:48.453409 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:20:48.463383 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:20:48.478340 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:20:48.481333 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:20:48.489312 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:20:48.514246 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:20:48.547138 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:20:48.549132 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:20:48.566091 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:20:48.574071 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:20:48.579052 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:20:48.586035 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:20:48.588030 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:20:48.589025 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:20:48.590022 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:20:48.592018 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:20:48.610969 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:20:48.612960 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:20:48.621936 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:20:48.623932 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:20:48.627924 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:20:48.647722 (MainThread): Partial parsing not enabled
2020-05-28 12:20:48.678652 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:20:48.678652 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:48.699583 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:20:48.699583 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:48.706564 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:20:48.706564 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:48.713544 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:20:48.713544 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:48.719530 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:20:48.720525 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:48.726510 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:20:48.726510 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:48.930962 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:20:48.935909 (MainThread): 
2020-05-28 12:20:48.940898 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:20:48.940898 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:20:48.947583 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:20:48.947583 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:20:49.039340 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:20:49.039340 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:20:50.218289 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:20:51.399083 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.36 seconds
2020-05-28 12:20:51.426064 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:20:51.427005 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:20:51.429067 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:20:51.429067 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:20:53.807340 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.38 seconds
2020-05-28 12:20:53.807340 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:20:53.808340 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:20:54.881865 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.07 seconds
2020-05-28 12:20:54.890833 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:20:54.890833 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:20:55.480526 (MainThread): Using snowflake connection "master".
2020-05-28 12:20:55.481562 (MainThread): On master: BEGIN
2020-05-28 12:20:57.596581 (MainThread): SQL status: SUCCESS 1 in 2.12 seconds
2020-05-28 12:20:57.596581 (MainThread): On master: COMMIT
2020-05-28 12:20:57.597576 (MainThread): Using snowflake connection "master".
2020-05-28 12:20:57.597576 (MainThread): On master: COMMIT
2020-05-28 12:20:58.227121 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2020-05-28 12:20:58.229126 (MainThread): 17:50:58 | Concurrency: 1 threads (target='dev')
2020-05-28 12:20:58.230415 (MainThread): 17:50:58 | 
2020-05-28 12:20:58.239396 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:20:58.239396 (Thread-1): 17:50:58 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:20:58.244396 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:20:58.244396 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:20:58.244396 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:20:58.262379 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:20:58.263379 (Thread-1): finished collecting timing info
2020-05-28 12:20:58.299288 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:20:58.301286 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:20:58.301286 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:21:00.860017 (Thread-1): SQL status: SUCCESS 1 in 2.56 seconds
2020-05-28 12:21:00.860017 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:21:00.861016 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:21:02.583495 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2020-05-28 12:21:02.586479 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:21:02.586479 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:21:02.586479 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:21:02.960038 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2020-05-28 12:21:02.964017 (Thread-1): finished collecting timing info
2020-05-28 12:21:02.965015 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e86bc348-ceff-40ca-8f7a-bbba7f22c213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F70D8B0>]}
2020-05-28 12:21:02.965015 (Thread-1): 17:51:02 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 4.72s]
2020-05-28 12:21:02.967008 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:21:02.968007 (MainThread): Using snowflake connection "master".
2020-05-28 12:21:02.968007 (MainThread): On master: BEGIN
2020-05-28 12:21:03.567641 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 12:21:03.568637 (MainThread): On master: COMMIT
2020-05-28 12:21:03.569634 (MainThread): Using snowflake connection "master".
2020-05-28 12:21:03.570631 (MainThread): On master: COMMIT
2020-05-28 12:21:04.206740 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 12:21:04.207737 (MainThread): 17:51:04 | 
2020-05-28 12:21:04.210697 (MainThread): 17:51:04 | Finished running 1 incremental model in 15.27s.
2020-05-28 12:21:04.213728 (MainThread): Connection 'master' was left open.
2020-05-28 12:21:04.213728 (MainThread): On master: Close
2020-05-28 12:21:04.934844 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:21:04.934844 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:21:05.623472 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:21:05.623472 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:21:06.298434 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:21:06.298434 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:21:07.103652 (MainThread): 
2020-05-28 12:21:07.104650 (MainThread): Completed successfully
2020-05-28 12:21:07.105648 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:21:07.106657 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED3DC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E938058>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E938160>]}
2020-05-28 12:21:07.107641 (MainThread): Flushing usage events
2020-05-28 12:21:26.673130 (MainThread): Running with dbt=0.16.1
2020-05-28 12:21:26.815750 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:21:27.082684 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:21:27.083681 (MainThread): Tracking: tracking
2020-05-28 12:21:27.083681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E12BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9D9028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9D9088>]}
2020-05-28 12:21:27.106620 (MainThread): Partial parsing not enabled
2020-05-28 12:21:27.110609 (MainThread): Parsing macros\core.sql
2020-05-28 12:21:27.116593 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:21:27.180422 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:21:27.194385 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:21:27.195383 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:21:27.197378 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:21:27.199372 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:21:27.202364 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:21:27.204358 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:21:27.205356 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:21:27.215329 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:21:27.235279 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:21:27.237274 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:21:27.246250 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:21:27.276170 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:21:27.327034 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:21:27.329029 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:21:27.352964 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:21:27.362938 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:21:27.369919 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:21:27.378895 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:21:27.380890 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:21:27.381887 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:21:27.383882 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:21:27.385877 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:21:27.414799 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:21:27.417791 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:21:27.428762 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:21:27.431754 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:21:27.435743 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:21:27.460676 (MainThread): Partial parsing not enabled
2020-05-28 12:21:27.499572 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:21:27.499572 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:21:27.525503 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:21:27.525503 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:21:27.532485 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:21:27.532485 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:21:27.540463 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:21:27.540463 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:21:27.548442 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:21:27.548442 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:21:27.555423 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:21:27.555423 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:21:27.801764 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:21:27.807785 (MainThread): 
2020-05-28 12:21:27.810739 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:21:27.810739 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:21:27.817589 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:21:27.817589 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:21:27.909346 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:21:27.909346 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:21:29.254784 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:21:30.447238 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.54 seconds
2020-05-28 12:21:30.475157 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:21:30.475157 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:21:30.477214 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:21:30.477214 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:21:33.237843 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.76 seconds
2020-05-28 12:21:33.238841 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:21:33.239838 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:21:34.284668 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.04 seconds
2020-05-28 12:21:34.289655 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:21:34.289655 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:21:34.935080 (MainThread): Using snowflake connection "master".
2020-05-28 12:21:34.936113 (MainThread): On master: BEGIN
2020-05-28 12:21:37.165187 (MainThread): SQL status: SUCCESS 1 in 2.23 seconds
2020-05-28 12:21:37.165187 (MainThread): On master: COMMIT
2020-05-28 12:21:37.166185 (MainThread): Using snowflake connection "master".
2020-05-28 12:21:37.166185 (MainThread): On master: COMMIT
2020-05-28 12:21:37.797946 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2020-05-28 12:21:37.798956 (MainThread): 17:51:37 | Concurrency: 1 threads (target='dev')
2020-05-28 12:21:37.800893 (MainThread): 17:51:37 | 
2020-05-28 12:21:37.803886 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:21:37.803886 (Thread-1): 17:51:37 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:21:37.809870 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:21:37.810867 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:21:37.810867 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:21:37.828818 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:21:37.829852 (Thread-1): finished collecting timing info
2020-05-28 12:21:37.863769 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:21:37.865765 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:21:37.865765 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:21:40.367734 (Thread-1): SQL status: SUCCESS 1 in 2.50 seconds
2020-05-28 12:21:40.368730 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:21:40.369724 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:21:42.370615 (Thread-1): SQL status: SUCCESS 1 in 2.00 seconds
2020-05-28 12:21:42.372610 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:21:42.373600 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:21:42.373600 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:21:42.786817 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-05-28 12:21:42.790338 (Thread-1): finished collecting timing info
2020-05-28 12:21:42.790892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf9406ec-678f-4d93-bab2-e71114a5a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F91C700>]}
2020-05-28 12:21:42.790892 (Thread-1): 17:51:42 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 4.98s]
2020-05-28 12:21:42.792842 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:21:42.793358 (MainThread): Using snowflake connection "master".
2020-05-28 12:21:42.794358 (MainThread): On master: BEGIN
2020-05-28 12:21:43.306314 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2020-05-28 12:21:43.307319 (MainThread): On master: COMMIT
2020-05-28 12:21:43.307319 (MainThread): Using snowflake connection "master".
2020-05-28 12:21:43.308296 (MainThread): On master: COMMIT
2020-05-28 12:21:43.922999 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2020-05-28 12:21:43.922999 (MainThread): 17:51:43 | 
2020-05-28 12:21:43.923993 (MainThread): 17:51:43 | Finished running 1 incremental model in 16.11s.
2020-05-28 12:21:43.924964 (MainThread): Connection 'master' was left open.
2020-05-28 12:21:43.924964 (MainThread): On master: Close
2020-05-28 12:21:44.840741 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:21:44.840741 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:21:45.593839 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:21:45.593839 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:21:46.437422 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:21:46.437422 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:21:47.404428 (MainThread): 
2020-05-28 12:21:47.405398 (MainThread): Completed successfully
2020-05-28 12:21:47.406386 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:21:47.413367 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EF4E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EF43E98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EF43148>]}
2020-05-28 12:21:47.413367 (MainThread): Flushing usage events
2020-05-28 12:22:01.840452 (MainThread): Running with dbt=0.16.1
2020-05-28 12:22:01.986102 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:22:02.239219 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:22:02.240219 (MainThread): Tracking: tracking
2020-05-28 12:22:02.240219 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF6BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E81A0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E81A118>]}
2020-05-28 12:22:02.260156 (MainThread): Partial parsing not enabled
2020-05-28 12:22:02.264156 (MainThread): Parsing macros\core.sql
2020-05-28 12:22:02.269142 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:22:02.320112 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:22:02.333113 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:22:02.335106 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:22:02.336111 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:22:02.338101 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:22:02.340108 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:22:02.342095 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:22:02.344084 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:22:02.352065 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:22:02.366029 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:22:02.368025 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:22:02.375003 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:22:02.396945 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:22:02.428860 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:22:02.430854 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:22:02.449802 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:22:02.457777 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:22:02.463783 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:22:02.469766 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:22:02.472764 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:22:02.473761 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:22:02.474760 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:22:02.476722 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:22:02.496700 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:22:02.498693 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:22:02.507672 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:22:02.509604 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:22:02.513653 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:22:02.534574 (MainThread): Partial parsing not enabled
2020-05-28 12:22:02.568537 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:22:02.568537 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:22:02.590423 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:22:02.590423 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:22:02.598402 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:22:02.598402 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:22:02.605422 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:22:02.605422 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:22:02.612399 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:22:02.612399 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:22:02.619384 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:22:02.619384 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:22:02.836769 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:22:02.841584 (MainThread): 
2020-05-28 12:22:02.845574 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:22:02.845574 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:22:02.853614 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:22:02.854615 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:22:02.956368 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:22:02.956368 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:22:04.160059 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:22:05.246226 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.29 seconds
2020-05-28 12:22:05.272190 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:22:05.272190 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:22:05.275142 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:22:05.275142 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:22:07.579987 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.30 seconds
2020-05-28 12:22:07.580974 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:22:07.580974 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:22:08.753841 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.17 seconds
2020-05-28 12:22:08.760859 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:22:08.761856 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:22:09.393952 (MainThread): Using snowflake connection "master".
2020-05-28 12:22:09.393952 (MainThread): On master: BEGIN
2020-05-28 12:22:11.576937 (MainThread): SQL status: SUCCESS 1 in 2.18 seconds
2020-05-28 12:22:11.577937 (MainThread): On master: COMMIT
2020-05-28 12:22:11.577937 (MainThread): Using snowflake connection "master".
2020-05-28 12:22:11.577937 (MainThread): On master: COMMIT
2020-05-28 12:22:12.167245 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-28 12:22:12.168242 (MainThread): 17:52:12 | Concurrency: 1 threads (target='dev')
2020-05-28 12:22:12.169777 (MainThread): 17:52:12 | 
2020-05-28 12:22:12.172773 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:22:12.173769 (Thread-1): 17:52:12 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:22:12.179806 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:22:12.179806 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:22:12.179806 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:22:12.198795 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:22:12.199788 (Thread-1): finished collecting timing info
2020-05-28 12:22:12.233706 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:22:12.235700 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:22:12.236695 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:22:14.178873 (Thread-1): SQL status: SUCCESS 1 in 1.94 seconds
2020-05-28 12:22:14.179865 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:22:14.179865 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:22:16.217925 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2020-05-28 12:22:16.218968 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:22:16.218968 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:22:16.219966 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:22:16.620942 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2020-05-28 12:22:16.623920 (Thread-1): finished collecting timing info
2020-05-28 12:22:16.624920 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ade12f7-6452-4046-b3dd-f2141364e290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED8EE98>]}
2020-05-28 12:22:16.624920 (Thread-1): 17:52:16 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 4.45s]
2020-05-28 12:22:16.625821 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:22:16.627820 (MainThread): Using snowflake connection "master".
2020-05-28 12:22:16.627820 (MainThread): On master: BEGIN
2020-05-28 12:22:17.154497 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2020-05-28 12:22:17.154497 (MainThread): On master: COMMIT
2020-05-28 12:22:17.154497 (MainThread): Using snowflake connection "master".
2020-05-28 12:22:17.154497 (MainThread): On master: COMMIT
2020-05-28 12:22:17.788180 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2020-05-28 12:22:17.788180 (MainThread): 17:52:17 | 
2020-05-28 12:22:17.789213 (MainThread): 17:52:17 | Finished running 1 incremental model in 14.94s.
2020-05-28 12:22:17.790174 (MainThread): Connection 'master' was left open.
2020-05-28 12:22:17.790174 (MainThread): On master: Close
2020-05-28 12:22:18.492202 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:22:18.492202 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:22:19.202496 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:22:19.203439 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:22:20.037458 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:22:20.037458 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:22:20.719897 (MainThread): 
2020-05-28 12:22:20.719897 (MainThread): Completed successfully
2020-05-28 12:22:20.720870 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:22:20.726853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED930B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E97A8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E916A00>]}
2020-05-28 12:22:20.727851 (MainThread): Flushing usage events
2020-05-28 12:23:01.053813 (MainThread): Running with dbt=0.16.1
2020-05-28 12:23:01.184866 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:23:01.427233 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:23:01.428234 (MainThread): Tracking: tracking
2020-05-28 12:23:01.428234 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE2BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6D9478>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6D9208>]}
2020-05-28 12:23:01.447178 (MainThread): Partial parsing not enabled
2020-05-28 12:23:01.451167 (MainThread): Parsing macros\core.sql
2020-05-28 12:23:01.456155 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:23:01.499042 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:23:01.508020 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:23:01.509016 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:23:01.511009 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:23:01.513003 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:23:01.515002 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:23:01.516994 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:23:01.517989 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:23:01.525969 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:23:01.539935 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:23:01.541930 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:23:01.547909 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:23:01.569852 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:23:01.601764 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:23:01.603759 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:23:01.620713 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:23:01.627695 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:23:01.633679 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:23:01.640662 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:23:01.642656 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:23:01.643658 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:23:01.644651 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:23:01.646645 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:23:01.665594 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:23:01.667593 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:23:01.676566 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:23:01.678560 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:23:01.682549 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:23:01.702509 (MainThread): Partial parsing not enabled
2020-05-28 12:23:01.733413 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:23:01.733413 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:23:01.754357 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:23:01.754357 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:23:01.761339 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:23:01.761339 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:23:01.768320 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:23:01.768320 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:23:01.774303 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:23:01.775316 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:23:01.781290 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:23:01.781290 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:23:01.987733 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:23:01.992901 (MainThread): 
2020-05-28 12:23:01.997889 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:23:01.997889 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:23:02.004870 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:23:02.004870 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:23:02.095671 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:23:02.096668 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:23:03.216951 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:23:04.528376 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.43 seconds
2020-05-28 12:23:04.557118 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:23:04.557118 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:23:04.559114 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:23:04.559114 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:23:07.039379 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.48 seconds
2020-05-28 12:23:07.040360 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:23:07.041358 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:23:08.155113 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.11 seconds
2020-05-28 12:23:08.176049 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:23:08.176049 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:23:08.741191 (MainThread): Using snowflake connection "master".
2020-05-28 12:23:08.742247 (MainThread): On master: BEGIN
2020-05-28 12:23:10.651336 (MainThread): SQL status: SUCCESS 1 in 1.91 seconds
2020-05-28 12:23:10.652331 (MainThread): On master: COMMIT
2020-05-28 12:23:10.653328 (MainThread): Using snowflake connection "master".
2020-05-28 12:23:10.653328 (MainThread): On master: COMMIT
2020-05-28 12:23:11.224241 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 12:23:11.226232 (MainThread): 17:53:11 | Concurrency: 1 threads (target='dev')
2020-05-28 12:23:11.228216 (MainThread): 17:53:11 | 
2020-05-28 12:23:11.248644 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:23:11.249674 (Thread-1): 17:53:11 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:23:11.252636 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:23:11.252636 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:23:11.252636 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:23:11.272632 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:23:11.273576 (Thread-1): finished collecting timing info
2020-05-28 12:23:11.308543 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:23:11.310537 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:23:11.310537 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:23:13.165039 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2020-05-28 12:23:13.165039 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:23:13.166042 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:23:15.399192 (Thread-1): SQL status: SUCCESS 1 in 2.23 seconds
2020-05-28 12:23:15.403181 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:23:15.403181 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:23:15.403181 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:23:15.878756 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-05-28 12:23:15.882736 (Thread-1): finished collecting timing info
2020-05-28 12:23:15.883733 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc23499d-1a30-49d0-9a7a-5283915c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC505C8>]}
2020-05-28 12:23:15.883733 (Thread-1): 17:53:15 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 4.63s]
2020-05-28 12:23:15.885692 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:23:15.886688 (MainThread): Using snowflake connection "master".
2020-05-28 12:23:15.886688 (MainThread): On master: BEGIN
2020-05-28 12:23:16.356088 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2020-05-28 12:23:16.356088 (MainThread): On master: COMMIT
2020-05-28 12:23:16.356088 (MainThread): Using snowflake connection "master".
2020-05-28 12:23:16.356088 (MainThread): On master: COMMIT
2020-05-28 12:23:16.997896 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 12:23:16.998852 (MainThread): 17:53:16 | 
2020-05-28 12:23:17.004830 (MainThread): 17:53:17 | Finished running 1 incremental model in 15.00s.
2020-05-28 12:23:17.006827 (MainThread): Connection 'master' was left open.
2020-05-28 12:23:17.006827 (MainThread): On master: Close
2020-05-28 12:23:17.728055 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:23:17.729056 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:23:18.591833 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:23:18.591833 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:23:19.347556 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:23:19.347556 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:23:20.300559 (MainThread): 
2020-05-28 12:23:20.301519 (MainThread): Completed successfully
2020-05-28 12:23:20.302516 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:23:20.309696 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC55E98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E83F118>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E83F430>]}
2020-05-28 12:23:20.309696 (MainThread): Flushing usage events
2020-05-28 12:24:02.960500 (MainThread): Running with dbt=0.16.1
2020-05-28 12:24:03.092109 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:24:03.333509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:24:03.333509 (MainThread): Tracking: tracking
2020-05-28 12:24:03.334500 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D64BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DEFA070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DEFA0B8>]}
2020-05-28 12:24:03.352452 (MainThread): Partial parsing not enabled
2020-05-28 12:24:03.356441 (MainThread): Parsing macros\core.sql
2020-05-28 12:24:03.361429 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:24:03.404314 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:24:03.414290 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:24:03.415283 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:24:03.416287 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:24:03.418279 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:24:03.421268 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:24:03.422267 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:24:03.424259 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:24:03.432239 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:24:03.445206 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:24:03.447202 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:24:03.453184 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:24:03.475125 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:24:03.511028 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:24:03.514024 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:24:03.534964 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:24:03.542941 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:24:03.549923 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:24:03.557907 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:24:03.559897 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:24:03.561895 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:24:03.562895 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:24:03.564885 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:24:03.586831 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:24:03.589822 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:24:03.600792 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:24:03.602787 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:24:03.607772 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:24:03.627887 (MainThread): Partial parsing not enabled
2020-05-28 12:24:03.660841 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:24:03.661836 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:24:03.683780 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:24:03.683780 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:24:03.690762 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:24:03.690762 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:24:03.697741 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:24:03.697741 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:24:03.704722 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:24:03.704722 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:24:03.710705 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:24:03.710705 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:24:03.917202 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:24:03.922757 (MainThread): 
2020-05-28 12:24:03.927715 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:24:03.927715 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:24:03.934800 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:24:03.934800 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:24:04.034536 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:24:04.035533 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:24:05.693667 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:24:07.626276 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.59 seconds
2020-05-28 12:24:07.653584 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:24:07.653584 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:24:07.655580 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:24:07.655580 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:24:10.126114 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.47 seconds
2020-05-28 12:24:10.126114 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:24:10.127104 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:24:11.261840 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.13 seconds
2020-05-28 12:24:11.269854 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:24:11.269854 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:24:12.042606 (MainThread): Using snowflake connection "master".
2020-05-28 12:24:12.043560 (MainThread): On master: BEGIN
2020-05-28 12:24:14.356120 (MainThread): SQL status: SUCCESS 1 in 2.31 seconds
2020-05-28 12:24:14.356120 (MainThread): On master: COMMIT
2020-05-28 12:24:14.357118 (MainThread): Using snowflake connection "master".
2020-05-28 12:24:14.358081 (MainThread): On master: COMMIT
2020-05-28 12:24:15.237798 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2020-05-28 12:24:15.239793 (MainThread): 17:54:15 | Concurrency: 1 threads (target='dev')
2020-05-28 12:24:15.240777 (MainThread): 17:54:15 | 
2020-05-28 12:24:15.244734 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:24:15.244734 (Thread-1): 17:54:15 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:24:15.250727 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:24:15.250727 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:24:15.250727 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:24:15.269713 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:24:15.270672 (Thread-1): finished collecting timing info
2020-05-28 12:24:15.304624 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:24:15.307611 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:24:15.307611 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:24:17.478147 (Thread-1): unclosed <socket.socket fd=1376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.43.142', 51555), raddr=('52.184.166.117', 443)>
2020-05-28 12:24:19.076666 (Thread-1): SQL status: SUCCESS 1 in 3.77 seconds
2020-05-28 12:24:19.076666 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:24:19.076666 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
   
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:24:21.161761 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2020-05-28 12:24:21.163754 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:24:21.163754 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:24:21.164756 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:24:21.762243 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 12:24:21.766226 (Thread-1): finished collecting timing info
2020-05-28 12:24:21.767221 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1263a0c8-4fc5-4d01-bdb0-3b8badb08b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4708E0>]}
2020-05-28 12:24:21.767221 (Thread-1): 17:54:21 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 6.52s]
2020-05-28 12:24:21.769179 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:24:21.770176 (MainThread): Using snowflake connection "master".
2020-05-28 12:24:21.770176 (MainThread): On master: BEGIN
2020-05-28 12:24:22.296050 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2020-05-28 12:24:22.296050 (MainThread): On master: COMMIT
2020-05-28 12:24:22.297049 (MainThread): Using snowflake connection "master".
2020-05-28 12:24:22.297049 (MainThread): On master: COMMIT
2020-05-28 12:24:23.246651 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2020-05-28 12:24:23.247650 (MainThread): 17:54:23 | 
2020-05-28 12:24:23.249431 (MainThread): 17:54:23 | Finished running 1 incremental model in 19.32s.
2020-05-28 12:24:23.252432 (MainThread): Connection 'master' was left open.
2020-05-28 12:24:23.252432 (MainThread): On master: Close
2020-05-28 12:24:24.200555 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:24:24.200555 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:24:24.899707 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:24:24.900703 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:24:25.923394 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:24:25.923394 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:24:26.777710 (MainThread): 
2020-05-28 12:24:26.779322 (MainThread): Completed successfully
2020-05-28 12:24:26.780325 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:24:26.782321 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4F6A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E46EA18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFF78E0>]}
2020-05-28 12:24:26.782321 (MainThread): Flushing usage events
2020-05-28 12:25:53.439506 (MainThread): Running with dbt=0.16.1
2020-05-28 12:25:53.570477 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:25:53.811835 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:25:53.811835 (MainThread): Tracking: tracking
2020-05-28 12:25:53.811835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D8DBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E189070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1890D0>]}
2020-05-28 12:25:53.830779 (MainThread): Partial parsing not enabled
2020-05-28 12:25:53.834770 (MainThread): Parsing macros\core.sql
2020-05-28 12:25:53.839760 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:25:53.881642 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:25:53.891616 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:25:53.892613 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:25:53.893613 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:25:53.895610 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:25:53.898597 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:25:53.899595 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:25:53.901589 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:25:53.909569 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:25:53.922534 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:25:53.924528 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:25:53.930511 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:25:53.952457 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:25:53.984370 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:25:53.986362 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:25:54.003317 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:25:54.010298 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:25:54.015285 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:25:54.022267 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:25:54.024261 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:25:54.025258 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:25:54.027252 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:25:54.029247 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:25:54.047200 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:25:54.049196 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:25:54.058172 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:25:54.059746 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:25:54.064417 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:25:54.085928 (MainThread): Partial parsing not enabled
2020-05-28 12:25:54.117907 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:25:54.117907 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:25:54.138845 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:25:54.138845 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:25:54.144830 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:25:54.145840 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:25:54.151814 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:25:54.152809 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:25:54.158794 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:25:54.158794 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:25:54.164776 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:25:54.164776 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:25:54.371614 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:25:54.376706 (MainThread): 
2020-05-28 12:25:54.380695 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:25:54.380695 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:25:54.388674 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:25:54.388674 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:25:54.479473 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:25:54.479473 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:25:56.133828 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:25:57.466974 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.99 seconds
2020-05-28 12:25:57.493056 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:25:57.493056 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:25:57.495088 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:25:57.495088 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:25:59.816258 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.32 seconds
2020-05-28 12:25:59.817304 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:25:59.817304 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:26:00.921272 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.10 seconds
2020-05-28 12:26:00.928245 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:26:00.929247 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:26:01.610681 (MainThread): Using snowflake connection "master".
2020-05-28 12:26:01.610681 (MainThread): On master: BEGIN
2020-05-28 12:26:04.176525 (MainThread): SQL status: SUCCESS 1 in 2.57 seconds
2020-05-28 12:26:04.177525 (MainThread): On master: COMMIT
2020-05-28 12:26:04.178521 (MainThread): Using snowflake connection "master".
2020-05-28 12:26:04.178521 (MainThread): On master: COMMIT
2020-05-28 12:26:04.814886 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 12:26:04.816881 (MainThread): 17:56:04 | Concurrency: 1 threads (target='dev')
2020-05-28 12:26:04.817761 (MainThread): 17:56:04 | 
2020-05-28 12:26:04.820755 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:26:04.820755 (Thread-1): 17:56:04 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:26:04.827738 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:26:04.827738 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:26:04.827738 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:26:04.845730 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:26:04.846685 (Thread-1): finished collecting timing info
2020-05-28 12:26:04.880638 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:26:04.883627 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:26:04.883627 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:26:06.953582 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2020-05-28 12:26:06.953582 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:26:06.954622 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:26:09.164749 (Thread-1): unclosed <socket.socket fd=1396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.43.142', 51576), raddr=('52.184.166.117', 443)>
2020-05-28 12:26:09.166744 (Thread-1): SQL status: SUCCESS 1 in 2.21 seconds
2020-05-28 12:26:09.167731 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:26:09.167731 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:26:09.167731 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:26:10.824655 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2020-05-28 12:26:10.832639 (Thread-1): finished collecting timing info
2020-05-28 12:26:10.834634 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce4e3713-9d9b-4cbf-af41-0ffdc85a68c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E7003D0>]}
2020-05-28 12:26:10.835627 (Thread-1): 17:56:10 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 6.01s]
2020-05-28 12:26:10.840566 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:26:10.844603 (MainThread): Using snowflake connection "master".
2020-05-28 12:26:10.845556 (MainThread): On master: BEGIN
2020-05-28 12:26:11.400263 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2020-05-28 12:26:11.401260 (MainThread): On master: COMMIT
2020-05-28 12:26:11.401260 (MainThread): Using snowflake connection "master".
2020-05-28 12:26:11.402257 (MainThread): On master: COMMIT
2020-05-28 12:26:12.055735 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2020-05-28 12:26:12.057730 (MainThread): 17:56:12 | 
2020-05-28 12:26:12.058718 (MainThread): 17:56:12 | Finished running 1 incremental model in 17.68s.
2020-05-28 12:26:12.058718 (MainThread): Connection 'master' was left open.
2020-05-28 12:26:12.058718 (MainThread): On master: Close
2020-05-28 12:26:13.058484 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:26:13.058484 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:26:14.013174 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:26:14.013174 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:26:14.826498 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:26:14.826498 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:26:15.650747 (MainThread): 
2020-05-28 12:26:15.651705 (MainThread): Completed successfully
2020-05-28 12:26:15.652702 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:26:15.658687 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E2826A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E6FEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E306808>]}
2020-05-28 12:26:15.659686 (MainThread): Flushing usage events
2020-05-28 12:26:49.593866 (MainThread): Running with dbt=0.16.1
2020-05-28 12:26:49.740547 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:26:50.000864 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:26:50.001857 (MainThread): Tracking: tracking
2020-05-28 12:26:50.001857 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D5EBAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE99388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DE99088>]}
2020-05-28 12:26:50.021801 (MainThread): Partial parsing not enabled
2020-05-28 12:26:50.025792 (MainThread): Parsing macros\core.sql
2020-05-28 12:26:50.030779 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:26:50.074620 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:26:50.086588 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:26:50.087624 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:26:50.088622 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:26:50.091618 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:26:50.093619 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:26:50.095568 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:26:50.097598 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:26:50.105575 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:26:50.119542 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:26:50.121535 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:26:50.127521 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:26:50.149460 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:26:50.182374 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:26:50.184368 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:26:50.202319 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:26:50.209300 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:26:50.214287 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:26:50.221268 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:26:50.223264 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:26:50.224262 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:26:50.225258 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:26:50.227252 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:26:50.246203 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:26:50.248199 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:26:50.257172 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:26:50.259168 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:26:50.263156 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:26:50.282105 (MainThread): Partial parsing not enabled
2020-05-28 12:26:50.316014 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:26:50.316014 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:26:50.336959 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:26:50.336959 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:26:50.342943 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:26:50.342943 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:26:50.350921 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:26:50.350921 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:26:50.356905 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:26:50.356905 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:26:50.363886 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:26:50.363886 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:26:50.573924 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:26:50.578842 (MainThread): 
2020-05-28 12:26:50.583828 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:26:50.583828 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:26:50.590812 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:26:50.590812 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:26:50.687094 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:26:50.687094 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:26:52.136031 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:26:53.288150 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.60 seconds
2020-05-28 12:26:53.318081 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:26:53.318081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:26:53.321087 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:26:53.321087 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:26:55.727649 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.41 seconds
2020-05-28 12:26:55.727649 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:26:55.728638 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:26:57.158192 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.43 seconds
2020-05-28 12:26:57.166166 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:26:57.166166 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:26:58.113937 (MainThread): Using snowflake connection "master".
2020-05-28 12:26:58.113937 (MainThread): On master: BEGIN
2020-05-28 12:27:00.430022 (MainThread): SQL status: SUCCESS 1 in 2.32 seconds
2020-05-28 12:27:00.431063 (MainThread): On master: COMMIT
2020-05-28 12:27:00.431063 (MainThread): Using snowflake connection "master".
2020-05-28 12:27:00.431063 (MainThread): On master: COMMIT
2020-05-28 12:27:01.111260 (MainThread): SQL status: SUCCESS 1 in 0.68 seconds
2020-05-28 12:27:01.111260 (MainThread): 17:57:01 | Concurrency: 1 threads (target='dev')
2020-05-28 12:27:01.113272 (MainThread): 17:57:01 | 
2020-05-28 12:27:01.120238 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:27:01.121179 (Thread-1): 17:57:01 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:27:01.127165 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:27:01.128159 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:27:01.128159 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:27:01.148106 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:27:01.149155 (Thread-1): finished collecting timing info
2020-05-28 12:27:01.183057 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:27:01.186049 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:27:01.186049 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:27:03.083057 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2020-05-28 12:27:03.084055 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:27:03.084055 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:27:05.216140 (Thread-1): SQL status: SUCCESS 1 in 2.13 seconds
2020-05-28 12:27:05.219161 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:27:05.219161 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:27:05.219161 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: COMMIT
2020-05-28 12:27:05.606877 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2020-05-28 12:27:05.608923 (Thread-1): finished collecting timing info
2020-05-28 12:27:05.608923 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e5342d8-4959-44c9-a7f6-48e82e768275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDDD700>]}
2020-05-28 12:27:05.609922 (Thread-1): 17:57:05 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLYLEAVE........ [SUCCESS 1 in 4.48s]
2020-05-28 12:27:05.610866 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:27:05.611863 (MainThread): Using snowflake connection "master".
2020-05-28 12:27:05.611863 (MainThread): On master: BEGIN
2020-05-28 12:27:06.178584 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 12:27:06.179582 (MainThread): On master: COMMIT
2020-05-28 12:27:06.179582 (MainThread): Using snowflake connection "master".
2020-05-28 12:27:06.180579 (MainThread): On master: COMMIT
2020-05-28 12:27:06.783294 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 12:27:06.784302 (MainThread): 17:57:06 | 
2020-05-28 12:27:06.785287 (MainThread): 17:57:06 | Finished running 1 incremental model in 16.20s.
2020-05-28 12:27:06.786250 (MainThread): Connection 'master' was left open.
2020-05-28 12:27:06.786250 (MainThread): On master: Close
2020-05-28 12:27:07.661564 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:27:07.662567 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:27:08.422667 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:27:08.422667 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:27:09.230350 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:27:09.231348 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:27:10.010406 (MainThread): 
2020-05-28 12:27:10.011363 (MainThread): Completed successfully
2020-05-28 12:27:10.012360 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:27:10.019344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E4109D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E405E98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E405148>]}
2020-05-28 12:27:10.020339 (MainThread): Flushing usage events
2020-05-28 12:28:21.161393 (MainThread): Running with dbt=0.16.1
2020-05-28 12:28:21.310994 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:28:21.602244 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLYLEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:28:21.602244 (MainThread): Tracking: tracking
2020-05-28 12:28:21.603242 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E53BAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDEA028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EDEA088>]}
2020-05-28 12:28:21.623198 (MainThread): Partial parsing not enabled
2020-05-28 12:28:21.627190 (MainThread): Parsing macros\core.sql
2020-05-28 12:28:21.633174 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:28:21.688023 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:28:21.704940 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:28:21.706935 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:28:21.710927 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:28:21.716907 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:28:21.727880 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:28:21.732866 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:28:21.734861 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:28:21.753810 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:28:21.772758 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:28:21.775752 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:28:21.786722 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:28:21.834628 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:28:21.882470 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:28:21.884466 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:28:21.910930 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:28:21.917911 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:28:21.923901 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:28:21.930877 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:28:21.933868 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:28:21.934878 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:28:21.936860 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:28:21.938855 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:28:21.963764 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:28:21.965759 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:28:21.979721 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:28:21.982714 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:28:21.987700 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:28:22.012633 (MainThread): Partial parsing not enabled
2020-05-28 12:28:22.053524 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:28:22.053524 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:28:22.079455 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:28:22.079455 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:28:22.087434 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:28:22.087434 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:28:22.095412 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:28:22.096409 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:28:22.103391 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:28:22.103391 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:28:22.111369 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:28:22.112367 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:28:22.366695 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:28:22.371457 (MainThread): 
2020-05-28 12:28:22.372411 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:28:22.372411 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:28:22.381397 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:28:22.381397 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:28:22.475196 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:28:22.475196 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:28:23.681239 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:28:24.997846 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.52 seconds
2020-05-28 12:28:25.044722 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:28:25.044722 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:28:25.046715 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:28:25.046715 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:28:27.396920 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.35 seconds
2020-05-28 12:28:27.396920 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:28:27.397914 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:28:28.681376 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.28 seconds
2020-05-28 12:28:28.686324 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:28:28.686324 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:28:29.334701 (MainThread): Using snowflake connection "master".
2020-05-28 12:28:29.335707 (MainThread): On master: BEGIN
2020-05-28 12:28:31.274898 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2020-05-28 12:28:31.275585 (MainThread): On master: COMMIT
2020-05-28 12:28:31.275585 (MainThread): Using snowflake connection "master".
2020-05-28 12:28:31.275585 (MainThread): On master: COMMIT
2020-05-28 12:28:31.873387 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-05-28 12:28:31.873387 (MainThread): 17:58:31 | Concurrency: 1 threads (target='dev')
2020-05-28 12:28:31.874385 (MainThread): 17:58:31 | 
2020-05-28 12:28:31.877388 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:28:31.877388 (Thread-1): 17:58:31 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLYLEAVE............. [RUN]
2020-05-28 12:28:31.883336 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:28:31.883336 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:28:31.884378 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:28:31.904279 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:28:31.905278 (Thread-1): finished collecting timing info
2020-05-28 12:28:31.939231 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLYLEAVE"
2020-05-28 12:28:31.942228 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:28:31.942228 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: BEGIN
2020-05-28 12:28:34.251965 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2020-05-28 12:28:34.251965 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLYLEAVE".
2020-05-28 12:28:34.251965 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLYLEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLYLEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_2,
   
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:29:55.395389 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 2764471.
2020-05-28 12:29:55.395389 (Thread-1): On model.vbi_zoho_people.TB_P_APPLYLEAVE: ROLLBACK
2020-05-28 12:29:55.395389 (Thread-1): initiating rollback
2020-05-28 12:29:55.831432 (Thread-1): finished collecting timing info
2020-05-28 12:29:55.831432 (Thread-1): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 2764471.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 2764471.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 2764471.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 12:29:55.836412 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eadb6cc1-6a1d-480d-abc7-8f376da4f12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0FD2CFA0>]}
2020-05-28 12:29:55.837371 (Thread-1): 17:59:55 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLYLEAVE.... [ERROR in 83.95s]
2020-05-28 12:29:55.838369 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLYLEAVE
2020-05-28 12:29:55.840363 (MainThread): Using snowflake connection "master".
2020-05-28 12:29:55.840363 (MainThread): On master: BEGIN
2020-05-28 12:29:56.526975 (MainThread): SQL status: SUCCESS 1 in 0.69 seconds
2020-05-28 12:29:56.528022 (MainThread): On master: COMMIT
2020-05-28 12:29:56.528022 (MainThread): Using snowflake connection "master".
2020-05-28 12:29:56.528022 (MainThread): On master: COMMIT
2020-05-28 12:29:57.635024 (MainThread): SQL status: SUCCESS 1 in 1.11 seconds
2020-05-28 12:29:57.635024 (MainThread): 17:59:57 | 
2020-05-28 12:29:57.636970 (MainThread): 17:59:57 | Finished running 1 incremental model in 95.26s.
2020-05-28 12:29:57.637968 (MainThread): Connection 'master' was left open.
2020-05-28 12:29:57.637968 (MainThread): On master: Close
2020-05-28 12:29:58.341021 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:29:58.342018 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:29:59.297533 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:29:59.297533 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:30:00.028296 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLYLEAVE' was left open.
2020-05-28 12:30:00.028296 (MainThread): On model.vbi_zoho_people.TB_P_APPLYLEAVE: Close
2020-05-28 12:30:00.757398 (MainThread): 
2020-05-28 12:30:00.758021 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 12:30:00.759020 (MainThread): 
2020-05-28 12:30:00.765004 (MainThread): Database Error in model TB_P_APPLYLEAVE (models\analytics\TB_P_APPLYLEAVE.sql)
2020-05-28 12:30:00.767000 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 12:30:00.767000 (MainThread):   Processing aborted due to error 300010:3898809911; incident 2764471.
2020-05-28 12:30:00.767997 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLYLEAVE.sql
2020-05-28 12:30:00.773980 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 12:30:00.774977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F35E178>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F353E98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F353DA8>]}
2020-05-28 12:30:00.774977 (MainThread): Flushing usage events
2020-05-28 12:35:50.327617 (MainThread): Running with dbt=0.16.1
2020-05-28 12:35:50.459266 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:35:50.704178 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:35:50.705176 (MainThread): Tracking: tracking
2020-05-28 12:35:50.705176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E24BBF8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EAF90B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EAF9130>]}
2020-05-28 12:35:50.723127 (MainThread): Partial parsing not enabled
2020-05-28 12:35:50.727117 (MainThread): Parsing macros\core.sql
2020-05-28 12:35:50.732104 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:35:50.775506 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:35:50.785480 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:35:50.786477 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:35:50.787475 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:35:50.789469 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:35:50.791464 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:35:50.793459 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:35:50.794456 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:35:50.802435 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:35:50.816397 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:35:50.818392 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:35:50.824376 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:35:50.845320 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:35:50.878232 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:35:50.880227 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:35:50.898178 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:35:50.904162 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:35:50.910146 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:35:50.916130 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:35:50.918125 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:35:50.920120 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:35:50.921117 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:35:50.923112 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:35:50.941064 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:35:50.943059 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:35:50.952034 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:35:50.954029 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:35:50.958018 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:35:50.976968 (MainThread): Partial parsing not enabled
2020-05-28 12:35:51.007885 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:35:51.008883 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:35:51.028829 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:35:51.028829 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:35:51.035811 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:35:51.035811 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:35:51.042300 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:35:51.043297 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:35:51.050783 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:35:51.050783 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:35:51.057765 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:35:51.057765 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:35:51.263233 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:35:51.268837 (MainThread): 
2020-05-28 12:35:51.270090 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:35:51.270090 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:35:51.276099 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:35:51.276099 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:35:51.365856 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:35:51.365856 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:35:52.942920 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:35:54.111807 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.75 seconds
2020-05-28 12:35:54.141759 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:35:54.141759 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:35:54.144753 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:35:54.144753 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:35:56.664713 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.52 seconds
2020-05-28 12:35:56.665706 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:35:56.665706 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:35:58.631034 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.96 seconds
2020-05-28 12:35:58.639997 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:35:58.639997 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:35:59.179163 (MainThread): Using snowflake connection "master".
2020-05-28 12:35:59.180130 (MainThread): On master: BEGIN
2020-05-28 12:36:01.035744 (MainThread): SQL status: SUCCESS 1 in 1.85 seconds
2020-05-28 12:36:01.035744 (MainThread): On master: COMMIT
2020-05-28 12:36:01.036744 (MainThread): Using snowflake connection "master".
2020-05-28 12:36:01.036744 (MainThread): On master: COMMIT
2020-05-28 12:36:01.681648 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 12:36:01.682647 (MainThread): 18:06:01 | Concurrency: 1 threads (target='dev')
2020-05-28 12:36:01.684383 (MainThread): 18:06:01 | 
2020-05-28 12:36:01.691370 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:36:01.691370 (Thread-1): 18:06:01 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-28 12:36:01.695359 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:36:01.696360 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:36:01.696360 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:36:01.714369 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 12:36:01.715366 (Thread-1): finished collecting timing info
2020-05-28 12:36:01.750277 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 12:36:01.753267 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:36:01.753267 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 12:36:03.917026 (Thread-1): SQL status: SUCCESS 1 in 2.16 seconds
2020-05-28 12:36:03.917026 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:36:03.918025 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(150) as REASON_FOR_LEAVE,
    SRC:"Reason for leave"::varchar(150) as REASON_FOR_LEAVE_,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:37:23.631455 (Thread-1): Snowflake error: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 6774786.
2020-05-28 12:37:23.632441 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: ROLLBACK
2020-05-28 12:37:23.632441 (Thread-1): initiating rollback
2020-05-28 12:37:24.134654 (Thread-1): finished collecting timing info
2020-05-28 12:37:24.136649 (Thread-1): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 6774786.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000603 (XX000): SQL execution internal error:
Processing aborted due to error 300010:3898809911; incident 6774786.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
  000603 (XX000): SQL execution internal error:
  Processing aborted due to error 300010:3898809911; incident 6774786.
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 12:37:24.151622 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13daf4f4-0f29-411d-a3b6-f28548e6c074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0FA3C760>]}
2020-05-28 12:37:24.151622 (Thread-1): 18:07:24 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_APPLY_LEAVE... [ERROR in 82.46s]
2020-05-28 12:37:24.154461 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:37:24.156457 (MainThread): Using snowflake connection "master".
2020-05-28 12:37:24.156457 (MainThread): On master: BEGIN
2020-05-28 12:37:24.669685 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2020-05-28 12:37:24.670683 (MainThread): On master: COMMIT
2020-05-28 12:37:24.671679 (MainThread): Using snowflake connection "master".
2020-05-28 12:37:24.671679 (MainThread): On master: COMMIT
2020-05-28 12:37:25.673580 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2020-05-28 12:37:25.675578 (MainThread): 18:07:25 | 
2020-05-28 12:37:25.677526 (MainThread): 18:07:25 | Finished running 1 incremental model in 94.41s.
2020-05-28 12:37:25.679524 (MainThread): Connection 'master' was left open.
2020-05-28 12:37:25.679524 (MainThread): On master: Close
2020-05-28 12:37:27.062463 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:37:27.062463 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:37:27.879484 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:37:27.879484 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:37:28.707034 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 12:37:28.707034 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 12:37:29.488196 (MainThread): 
2020-05-28 12:37:29.489141 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 12:37:29.490149 (MainThread): 
2020-05-28 12:37:29.496834 (MainThread): Database Error in model TB_P_APPLY_LEAVE (models\analytics\TB_P_APPLY_LEAVE.sql)
2020-05-28 12:37:29.498829 (MainThread):   000603 (XX000): SQL execution internal error:
2020-05-28 12:37:29.499826 (MainThread):   Processing aborted due to error 300010:3898809911; incident 6774786.
2020-05-28 12:37:29.499826 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_APPLY_LEAVE.sql
2020-05-28 12:37:29.500823 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 12:37:29.501822 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC672E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC673B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC67310>]}
2020-05-28 12:37:29.501822 (MainThread): Flushing usage events
2020-05-28 12:37:49.578972 (MainThread): Running with dbt=0.16.1
2020-05-28 12:37:49.721628 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:37:49.977966 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:37:49.978963 (MainThread): Tracking: tracking
2020-05-28 12:37:49.978963 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E01BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8CA490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8CA1C0>]}
2020-05-28 12:37:49.997855 (MainThread): Partial parsing not enabled
2020-05-28 12:37:50.001901 (MainThread): Parsing macros\core.sql
2020-05-28 12:37:50.006898 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:37:50.050770 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:37:50.060750 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:37:50.061745 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:37:50.062744 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:37:50.065731 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:37:50.067725 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:37:50.069691 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:37:50.070688 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:37:50.078702 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:37:50.092663 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:37:50.094653 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:37:50.101637 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:37:50.123577 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:37:50.156487 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:37:50.158481 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:37:50.175439 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:37:50.182423 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:37:50.187416 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:37:50.194389 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:37:50.196380 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:37:50.197380 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:37:50.199372 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:37:50.201367 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:37:50.219322 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:37:50.221325 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:37:50.230295 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:37:50.232285 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:37:50.236274 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:37:50.256221 (MainThread): Partial parsing not enabled
2020-05-28 12:37:50.287143 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:37:50.288139 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:37:50.309080 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:37:50.309080 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:37:50.316065 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:37:50.316065 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:37:50.323043 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:37:50.323043 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:37:50.329028 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:37:50.330032 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:37:50.336008 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:37:50.336008 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:37:50.567330 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:37:50.572795 (MainThread): 
2020-05-28 12:37:50.577781 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:37:50.577781 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:37:50.586758 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:37:50.586758 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:37:50.678563 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:37:50.678563 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:37:52.352619 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:37:53.785787 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.11 seconds
2020-05-28 12:37:53.831666 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:37:53.831666 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:37:53.833663 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:37:53.833663 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:37:56.388592 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.55 seconds
2020-05-28 12:37:56.389590 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:37:56.389590 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:37:57.964926 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.58 seconds
2020-05-28 12:37:57.976939 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:37:57.977888 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:37:58.640435 (MainThread): Using snowflake connection "master".
2020-05-28 12:37:58.640435 (MainThread): On master: BEGIN
2020-05-28 12:38:01.259121 (MainThread): SQL status: SUCCESS 1 in 2.62 seconds
2020-05-28 12:38:01.260109 (MainThread): On master: COMMIT
2020-05-28 12:38:01.261116 (MainThread): Using snowflake connection "master".
2020-05-28 12:38:01.261116 (MainThread): On master: COMMIT
2020-05-28 12:38:01.907245 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2020-05-28 12:38:01.908179 (MainThread): 18:08:01 | Concurrency: 1 threads (target='dev')
2020-05-28 12:38:01.910403 (MainThread): 18:08:01 | 
2020-05-28 12:38:01.913349 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:38:01.913349 (Thread-1): 18:08:01 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-28 12:38:01.919333 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:38:01.920331 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:38:01.920331 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:38:01.938319 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 12:38:01.939279 (Thread-1): finished collecting timing info
2020-05-28 12:38:01.973231 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 12:38:01.976181 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:38:01.976181 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 12:38:04.349740 (Thread-1): SQL status: SUCCESS 1 in 2.37 seconds
2020-05-28 12:38:04.349740 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:38:04.349740 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(1000) as REASON_FOR_LEAVE,
    SRC:"Reason for leave"::varchar(1000) as REASON_FOR_LEAVE_,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:38:06.905515 (Thread-1): SQL status: SUCCESS 1 in 2.56 seconds
2020-05-28 12:38:06.908503 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-28 12:38:06.908503 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:38:06.908503 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-28 12:38:07.320308 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-05-28 12:38:07.327289 (Thread-1): finished collecting timing info
2020-05-28 12:38:07.330282 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a66f5275-88bb-4497-9c7f-431bc1b8d3d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE41E98>]}
2020-05-28 12:38:07.331279 (Thread-1): 18:08:07 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLY_LEAVE....... [SUCCESS 1 in 5.41s]
2020-05-28 12:38:07.334459 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:38:07.337436 (MainThread): Using snowflake connection "master".
2020-05-28 12:38:07.337436 (MainThread): On master: BEGIN
2020-05-28 12:38:08.194140 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2020-05-28 12:38:08.195018 (MainThread): On master: COMMIT
2020-05-28 12:38:08.195018 (MainThread): Using snowflake connection "master".
2020-05-28 12:38:08.195018 (MainThread): On master: COMMIT
2020-05-28 12:38:09.251902 (MainThread): SQL status: SUCCESS 1 in 1.06 seconds
2020-05-28 12:38:09.253897 (MainThread): 18:08:09 | 
2020-05-28 12:38:09.255856 (MainThread): 18:08:09 | Finished running 1 incremental model in 18.68s.
2020-05-28 12:38:09.258844 (MainThread): Connection 'master' was left open.
2020-05-28 12:38:09.258844 (MainThread): On master: Close
2020-05-28 12:38:10.180369 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:38:10.181368 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:38:11.161060 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:38:11.162058 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:38:11.927866 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 12:38:11.927866 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 12:38:12.789883 (MainThread): 
2020-05-28 12:38:12.790837 (MainThread): Completed successfully
2020-05-28 12:38:12.791835 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:38:12.798817 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE3F040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA298C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9C6A00>]}
2020-05-28 12:38:12.799816 (MainThread): Flushing usage events
2020-05-28 12:41:56.224743 (MainThread): Running with dbt=0.16.1
2020-05-28 12:41:56.363646 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:41:56.604994 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_APPLY_LEAVE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:41:56.604994 (MainThread): Tracking: tracking
2020-05-28 12:41:56.604994 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E47BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED29358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED290D0>]}
2020-05-28 12:41:56.623940 (MainThread): Partial parsing not enabled
2020-05-28 12:41:56.627930 (MainThread): Parsing macros\core.sql
2020-05-28 12:41:56.632918 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:41:56.675801 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:41:56.684781 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:41:56.685776 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:41:56.687771 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:41:56.689768 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:41:56.691758 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:41:56.693753 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:41:56.694760 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:41:56.703728 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:41:56.716696 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:41:56.719684 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:41:56.725669 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:41:56.746613 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:41:56.779526 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:41:56.781519 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:41:56.799470 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:41:56.806466 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:41:56.811439 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:41:56.818421 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:41:56.820418 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:41:56.821414 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:41:56.822414 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:41:56.824404 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:41:56.843357 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:41:56.845348 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:41:56.854327 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:41:56.856324 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:41:56.860312 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:41:56.879258 (MainThread): Partial parsing not enabled
2020-05-28 12:41:56.910195 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:41:56.910195 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:41:56.932140 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:41:56.932140 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:41:56.939124 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:41:56.939124 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:41:56.946103 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:41:56.946103 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:41:56.952088 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:41:56.953085 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:41:56.959068 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:41:56.959068 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:41:57.165701 (MainThread): Found 6 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 6 sources
2020-05-28 12:41:57.170719 (MainThread): 
2020-05-28 12:41:57.174677 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:41:57.174677 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:41:57.181658 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:41:57.181658 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:41:57.273455 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:41:57.273455 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:41:58.364543 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:41:59.881412 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.61 seconds
2020-05-28 12:41:59.909358 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:41:59.909358 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:41:59.911361 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:41:59.911361 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:42:02.608458 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.70 seconds
2020-05-28 12:42:02.609454 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:42:02.610463 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:42:03.629449 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.02 seconds
2020-05-28 12:42:03.638403 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:42:03.638403 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:42:04.226724 (MainThread): Using snowflake connection "master".
2020-05-28 12:42:04.226724 (MainThread): On master: BEGIN
2020-05-28 12:42:06.105471 (MainThread): unclosed <socket.socket fd=1248, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.43.142', 51810), raddr=('52.184.166.117', 443)>
2020-05-28 12:42:07.865295 (MainThread): SQL status: SUCCESS 1 in 3.64 seconds
2020-05-28 12:42:07.866291 (MainThread): On master: COMMIT
2020-05-28 12:42:07.866291 (MainThread): Using snowflake connection "master".
2020-05-28 12:42:07.866291 (MainThread): On master: COMMIT
2020-05-28 12:42:08.859415 (MainThread): SQL status: SUCCESS 1 in 0.99 seconds
2020-05-28 12:42:08.861411 (MainThread): 18:12:08 | Concurrency: 1 threads (target='dev')
2020-05-28 12:42:08.862404 (MainThread): 18:12:08 | 
2020-05-28 12:42:08.865396 (Thread-1): Began running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:42:08.865396 (Thread-1): 18:12:08 | 1 of 1 START incremental model ANALYTICS.TB_P_APPLY_LEAVE............ [RUN]
2020-05-28 12:42:08.870384 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:42:08.870384 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:42:08.870384 (Thread-1): Compiling model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:42:08.889383 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 12:42:08.890380 (Thread-1): finished collecting timing info
2020-05-28 12:42:08.924997 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_APPLY_LEAVE"
2020-05-28 12:42:08.927989 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:42:08.928984 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: BEGIN
2020-05-28 12:42:10.949937 (Thread-1): SQL status: SUCCESS 1 in 2.02 seconds
2020-05-28 12:42:10.949937 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:42:10.950934 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_APPLY_LEAVE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_APPLY_LEAVE  as
      (

select
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::String as APPROVALSTATUS,
    case
        when SRC:"ApprovalTime" not like '%AM%' and SRC:"ApprovalTime" not like '%PM%' then 
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH:MI:SS') 
        else
            TO_TIMESTAMP((SRC:"ApprovalTime")::String,  'DD-MON-YYYY HH12:MI AM')
     end
     as APPROVED_TIME,
    SRC:"Comments for Cancellation by Admin"::varchar(1000) as COMMENTS_FOR_CANCELLATION_BY_ADMIN,
    case
        when length(SRC:"DOR") = 0 then
           to_date('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_date(SRC:"DOR"::String, 'DD-MON-YYYY')
    end 
    as DATE_OF_RESIGNATION,
    case
        when length(SRC:"Date - Time for WFH") = 0 then
           to_timestamp('01-Jan-0001', 'DD-MON-YYYY')
        else
           to_timestamp(SRC:"Date - Time for WFH"::String, 'DD-MON-YYYY HH:MI:SS')
    end 
    as DATE_TIME_FOR_WFH,
    TRY_CAST(SRC:"Date of request"::String as Date) as DATE_OF_REQUEST,
    TRY_CAST(SRC:"Days Taken"::String as NUMBER(4,1)) as DAYS_TAKEN,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    TRY_CAST(SRC:"Friday flag"::String  as Smallint) as FRIDAY_FLAG,
    SRC:"From"::Date as FROM_DATE,
    TRY_CAST(SRC:"Late Flag"::String  as Smallint) as LATE_FLAG,
    SRC:"Leave Type"::varchar(40) as LEAVE_TYPE,
    SRC:"Medical certificate"::varchar(150) as MEDICAL_CERTIFICATE,
    SRC:"Medical certificate_downloadUrl"::varchar(150) as MEDICAL_CERTIFICATE_DOWNLOAD_URL,
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    TRY_CAST(SRC:"NP DOR Flag"::String  as Smallint) as NOTICE_PERIOD,
    TRY_CAST(SRC:"Number of Days"::String  as Smallint) as NO_OF_DAYS,
    SRC:"Reason for Leave"::varchar(1000) as REASON_FOR_LEAVE_1,
    SRC:"Reason for leave"::varchar(1000) as REASON_FOR_LEAVE_2,
    SRC:"To"::Date as TO_DATE,
    SRC:"Was it a late Application (EL to be reduced)"::varchar(5) as WAS_IT_A_LATE_APPLICATION,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,
    SRC:"ownerID"::varchar(30) as OWNERID,
    SRC:"ownerName"::varchar(80) as OWNERNAME,
    SRC:"recordId"::varchar(20) as RECORDID
 
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_APPLYLEAVEVIEW


      );
2020-05-28 12:42:13.629235 (Thread-1): SQL status: SUCCESS 1 in 2.68 seconds
2020-05-28 12:42:13.632211 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-28 12:42:13.632211 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:42:13.632211 (Thread-1): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: COMMIT
2020-05-28 12:42:14.073409 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2020-05-28 12:42:14.075404 (Thread-1): finished collecting timing info
2020-05-28 12:42:14.075404 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa96f40-f1a7-4f7f-a25d-faa87fc00373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EF7FB50>]}
2020-05-28 12:42:14.076401 (Thread-1): 18:12:14 | 1 of 1 OK created incremental model ANALYTICS.TB_P_APPLY_LEAVE....... [SUCCESS 1 in 5.21s]
2020-05-28 12:42:14.077399 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_APPLY_LEAVE
2020-05-28 12:42:14.078395 (MainThread): Using snowflake connection "master".
2020-05-28 12:42:14.078395 (MainThread): On master: BEGIN
2020-05-28 12:42:14.589770 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2020-05-28 12:42:14.590774 (MainThread): On master: COMMIT
2020-05-28 12:42:14.590774 (MainThread): Using snowflake connection "master".
2020-05-28 12:42:14.590774 (MainThread): On master: COMMIT
2020-05-28 12:42:15.166070 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2020-05-28 12:42:15.167074 (MainThread): 18:12:15 | 
2020-05-28 12:42:15.168059 (MainThread): 18:12:15 | Finished running 1 incremental model in 17.99s.
2020-05-28 12:42:15.169017 (MainThread): Connection 'master' was left open.
2020-05-28 12:42:15.169017 (MainThread): On master: Close
2020-05-28 12:42:16.347691 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 12:42:16.348673 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 12:42:17.160155 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 12:42:17.160155 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 12:42:17.867019 (MainThread): Connection 'model.vbi_zoho_people.TB_P_APPLY_LEAVE' was left open.
2020-05-28 12:42:17.867019 (MainThread): On model.vbi_zoho_people.TB_P_APPLY_LEAVE: Close
2020-05-28 12:42:18.775968 (MainThread): 
2020-05-28 12:42:18.776923 (MainThread): Completed successfully
2020-05-28 12:42:18.777922 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 12:42:18.783905 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F29EB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE8B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EE8B7F0>]}
2020-05-28 12:42:18.784902 (MainThread): Flushing usage events
2020-05-28 12:59:44.646678 (MainThread): Running with dbt=0.16.1
2020-05-28 12:59:44.777399 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 12:59:45.023697 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_DEPARTMENT'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 12:59:45.023697 (MainThread): Tracking: tracking
2020-05-28 12:59:45.023697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DF5B9B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E80A100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E80A160>]}
2020-05-28 12:59:45.043643 (MainThread): Partial parsing not enabled
2020-05-28 12:59:45.046635 (MainThread): Parsing macros\core.sql
2020-05-28 12:59:45.051622 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 12:59:45.095505 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 12:59:45.104480 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 12:59:45.105478 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 12:59:45.106475 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 12:59:45.109467 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 12:59:45.111462 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 12:59:45.113456 (MainThread): Parsing macros\etc\query.sql
2020-05-28 12:59:45.114454 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 12:59:45.122433 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 12:59:45.135398 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 12:59:45.137392 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 12:59:45.144374 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 12:59:45.165318 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 12:59:45.198230 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 12:59:45.200224 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 12:59:45.217179 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 12:59:45.224160 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 12:59:45.229147 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 12:59:45.236128 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 12:59:45.238123 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 12:59:45.239121 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 12:59:45.241115 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 12:59:45.243109 (MainThread): Parsing macros\adapters.sql
2020-05-28 12:59:45.261062 (MainThread): Parsing macros\catalog.sql
2020-05-28 12:59:45.263057 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 12:59:45.272032 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 12:59:45.274027 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 12:59:45.278016 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 12:59:45.297963 (MainThread): Partial parsing not enabled
2020-05-28 12:59:45.328880 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 12:59:45.328880 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.351939 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 12:59:45.351939 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.359094 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 12:59:45.359094 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.366078 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 12:59:45.366078 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.373060 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 12:59:45.373060 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.380041 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 12:59:45.380041 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.386022 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 12:59:45.386022 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.609802 (MainThread): Found 7 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 7 sources
2020-05-28 12:59:45.616188 (MainThread): 
2020-05-28 12:59:45.619045 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 12:59:45.619045 (MainThread): Opening a new connection, currently in state init
2020-05-28 12:59:45.627060 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:59:45.627060 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 12:59:45.720811 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 12:59:45.720811 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 12:59:47.279382 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 12:59:48.464028 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.74 seconds
2020-05-28 12:59:48.494013 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:59:48.494013 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 12:59:48.496009 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:59:48.497006 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 12:59:51.152688 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.66 seconds
2020-05-28 12:59:51.153696 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 12:59:51.154647 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 12:59:52.312350 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.16 seconds
2020-05-28 12:59:52.319324 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 12:59:52.319324 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 12:59:53.341910 (MainThread): Using snowflake connection "master".
2020-05-28 12:59:53.342908 (MainThread): On master: BEGIN
2020-05-28 12:59:55.878797 (MainThread): SQL status: SUCCESS 1 in 2.53 seconds
2020-05-28 12:59:55.878797 (MainThread): On master: COMMIT
2020-05-28 12:59:55.879794 (MainThread): Using snowflake connection "master".
2020-05-28 12:59:55.879794 (MainThread): On master: COMMIT
2020-05-28 12:59:56.567295 (MainThread): SQL status: SUCCESS 1 in 0.69 seconds
2020-05-28 12:59:56.568293 (MainThread): 18:29:56 | Concurrency: 1 threads (target='dev')
2020-05-28 12:59:56.569884 (MainThread): 18:29:56 | 
2020-05-28 12:59:56.572879 (Thread-1): Began running node model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 12:59:56.572879 (Thread-1): 18:29:56 | 1 of 1 START incremental model ANALYTICS.TB_P_DEPARTMENT............. [RUN]
2020-05-28 12:59:56.578864 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 12:59:56.578864 (Thread-1): Opening a new connection, currently in state init
2020-05-28 12:59:56.578864 (Thread-1): Compiling model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 12:59:56.596855 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_DEPARTMENT"
2020-05-28 12:59:56.597852 (Thread-1): finished collecting timing info
2020-05-28 12:59:56.631760 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_DEPARTMENT"
2020-05-28 12:59:56.633756 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 12:59:56.633756 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: BEGIN
2020-05-28 12:59:59.225006 (Thread-1): SQL status: SUCCESS 1 in 2.59 seconds
2020-05-28 12:59:59.225006 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 12:59:59.226003 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DEPARTMENT"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_DEPARTMENT  as
      (

select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    SRC:"Department Head"::varchar(80) as FROM_DATE,  
    SRC:"Department Name"::varchar(30) as LEAVE_TYPE,
    SRC:"Parent Department"::varchar(30) as TO_DATE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,    
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_DEPARTMENTVIEW   


      );
2020-05-28 13:00:01.127283 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2020-05-28 13:00:01.129286 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: COMMIT
2020-05-28 13:00:01.129286 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:00:01.130283 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: COMMIT
2020-05-28 13:00:01.583391 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2020-05-28 13:00:01.587420 (Thread-1): finished collecting timing info
2020-05-28 13:00:01.588418 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ed6fa1a-d0fa-4297-a539-c4fe9b1f4573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED657F0>]}
2020-05-28 13:00:01.588418 (Thread-1): 18:30:01 | 1 of 1 OK created incremental model ANALYTICS.TB_P_DEPARTMENT........ [SUCCESS 1 in 5.01s]
2020-05-28 13:00:01.590391 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 13:00:01.591388 (MainThread): Using snowflake connection "master".
2020-05-28 13:00:01.591388 (MainThread): On master: BEGIN
2020-05-28 13:00:02.224566 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2020-05-28 13:00:02.225524 (MainThread): On master: COMMIT
2020-05-28 13:00:02.226567 (MainThread): Using snowflake connection "master".
2020-05-28 13:00:02.226567 (MainThread): On master: COMMIT
2020-05-28 13:00:02.864557 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 13:00:02.867537 (MainThread): 18:30:02 | 
2020-05-28 13:00:02.868372 (MainThread): 18:30:02 | Finished running 1 incremental model in 17.25s.
2020-05-28 13:00:02.869375 (MainThread): Connection 'master' was left open.
2020-05-28 13:00:02.869375 (MainThread): On master: Close
2020-05-28 13:00:03.602547 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 13:00:03.602547 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 13:00:04.517409 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 13:00:04.518404 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 13:00:05.425844 (MainThread): Connection 'model.vbi_zoho_people.TB_P_DEPARTMENT' was left open.
2020-05-28 13:00:05.425844 (MainThread): On model.vbi_zoho_people.TB_P_DEPARTMENT: Close
2020-05-28 13:00:06.377489 (MainThread): 
2020-05-28 13:00:06.378487 (MainThread): Completed successfully
2020-05-28 13:00:06.380489 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 13:00:06.390181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E905520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E905B98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E905538>]}
2020-05-28 13:00:06.390181 (MainThread): Flushing usage events
2020-05-28 13:03:10.580702 (MainThread): Running with dbt=0.16.1
2020-05-28 13:03:10.733897 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 13:03:11.004684 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_DEPARTMENT'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 13:03:11.004684 (MainThread): Tracking: tracking
2020-05-28 13:03:11.005682 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E13BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9E9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E9E9220>]}
2020-05-28 13:03:11.029617 (MainThread): Partial parsing not enabled
2020-05-28 13:03:11.033607 (MainThread): Parsing macros\core.sql
2020-05-28 13:03:11.038593 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 13:03:11.104417 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 13:03:11.119377 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 13:03:11.120375 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 13:03:11.122369 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 13:03:11.125361 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 13:03:11.128353 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 13:03:11.131345 (MainThread): Parsing macros\etc\query.sql
2020-05-28 13:03:11.133340 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 13:03:11.145308 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 13:03:11.167249 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 13:03:11.169244 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 13:03:11.179217 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 13:03:11.216118 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 13:03:11.267980 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 13:03:11.269975 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 13:03:11.292913 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 13:03:11.302887 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 13:03:11.308870 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 13:03:11.317866 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 13:03:11.320858 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 13:03:11.321855 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 13:03:11.322853 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 13:03:11.325845 (MainThread): Parsing macros\adapters.sql
2020-05-28 13:03:11.352773 (MainThread): Parsing macros\catalog.sql
2020-05-28 13:03:11.354767 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 13:03:11.367733 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 13:03:11.369727 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 13:03:11.374714 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 13:03:11.398650 (MainThread): Partial parsing not enabled
2020-05-28 13:03:11.437546 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 13:03:11.437546 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.462479 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 13:03:11.462479 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.469461 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 13:03:11.470458 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.478437 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 13:03:11.478437 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.485418 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:11.485418 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.493397 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 13:03:11.493397 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.501375 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 13:03:11.501375 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.750750 (MainThread): Found 7 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 7 sources
2020-05-28 13:03:11.756892 (MainThread): 
2020-05-28 13:03:11.760851 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 13:03:11.760851 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:03:11.767832 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 13:03:11.767832 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 13:03:11.859647 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 13:03:11.859647 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 13:03:13.156464 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 13:03:14.383640 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.52 seconds
2020-05-28 13:03:14.430298 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:03:14.430298 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 13:03:14.432295 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:03:14.432295 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 13:03:16.770062 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.34 seconds
2020-05-28 13:03:16.770062 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:03:16.770062 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 13:03:18.064152 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.29 seconds
2020-05-28 13:03:18.088044 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 13:03:18.088044 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 13:03:18.914780 (MainThread): Using snowflake connection "master".
2020-05-28 13:03:18.915822 (MainThread): On master: BEGIN
2020-05-28 13:03:21.326080 (MainThread): SQL status: SUCCESS 1 in 2.41 seconds
2020-05-28 13:03:21.326080 (MainThread): On master: COMMIT
2020-05-28 13:03:21.326080 (MainThread): Using snowflake connection "master".
2020-05-28 13:03:21.326080 (MainThread): On master: COMMIT
2020-05-28 13:03:21.904393 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2020-05-28 13:03:21.906384 (MainThread): 18:33:21 | Concurrency: 1 threads (target='dev')
2020-05-28 13:03:21.907376 (MainThread): 18:33:21 | 
2020-05-28 13:03:21.910331 (Thread-1): Began running node model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 13:03:21.911328 (Thread-1): 18:33:21 | 1 of 1 START incremental model ANALYTICS.TB_P_DEPARTMENT............. [RUN]
2020-05-28 13:03:21.916314 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:21.916314 (Thread-1): Opening a new connection, currently in state init
2020-05-28 13:03:21.916314 (Thread-1): Compiling model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 13:03:21.941282 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_DEPARTMENT"
2020-05-28 13:03:21.942280 (Thread-1): finished collecting timing info
2020-05-28 13:03:21.978283 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:21.978283 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DEPARTMENT"} */

    

      create or replace temporary table ZOHO_OA_EDW.ANALYTICS.TB_P_DEPARTMENT__dbt_tmp  as
      (

select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    SRC:"Department Head"::varchar(80) as DEPARTMENT_HEAD,  
    SRC:"Department Name"::varchar(30) as DEPARTMENT_NAME,
    SRC:"Parent Department"::varchar(30) as PARENT_DEPARTMENT,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,    
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_DEPARTMENTVIEW   


    where MODIFIED_TIME > ( select max(MODIFIED_TIME) from ZOHO_OA_EDW.ANALYTICS.TB_P_DEPARTMENT )

      );
2020-05-28 13:03:25.741372 (Thread-1): SQL status: SUCCESS 1 in 3.76 seconds
2020-05-28 13:03:25.745361 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:25.745361 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: BEGIN
2020-05-28 13:03:26.271388 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2020-05-28 13:03:26.271388 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:26.271388 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DEPARTMENT"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_P_DEPARTMENT__dbt_tmp'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-28 13:03:27.547424 (Thread-1): SQL status: SUCCESS 10 in 1.28 seconds
2020-05-28 13:03:27.575334 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:27.575334 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DEPARTMENT"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_P_DEPARTMENT'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-28 13:03:28.858060 (Thread-1): SQL status: SUCCESS 10 in 1.28 seconds
2020-05-28 13:03:28.864047 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:28.864047 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DEPARTMENT"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from
      ZOHO_OA_EDW.INFORMATION_SCHEMA.columns

      where table_name ilike 'TB_P_DEPARTMENT'
        
        and table_schema ilike 'ANALYTICS'
        
        
        and table_catalog ilike 'ZOHO_OA_EDW'
        
      order by ordinal_position
2020-05-28 13:03:30.000087 (Thread-1): SQL status: SUCCESS 10 in 1.14 seconds
2020-05-28 13:03:30.026013 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_DEPARTMENT"
2020-05-28 13:03:30.028009 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:03:30.028009 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DEPARTMENT"} */

        
        
    

    merge into ZOHO_OA_EDW.ANALYTICS.TB_P_DEPARTMENT as DBT_INTERNAL_DEST
        using ZOHO_OA_EDW.ANALYTICS.TB_P_DEPARTMENT__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.RECORDID = DBT_INTERNAL_DEST.RECORDID
        

    
    when matched then update set
        "APPROVAL_STATUS" = DBT_INTERNAL_SOURCE."APPROVAL_STATUS","FROM_DATE" = DBT_INTERNAL_SOURCE."FROM_DATE","LEAVE_TYPE" = DBT_INTERNAL_SOURCE."LEAVE_TYPE","TO_DATE" = DBT_INTERNAL_SOURCE."TO_DATE","CREATED_TIME_INT" = DBT_INTERNAL_SOURCE."CREATED_TIME_INT","MODIFIED_TIME_INT" = DBT_INTERNAL_SOURCE."MODIFIED_TIME_INT","MODIFIED_TIME" = DBT_INTERNAL_SOURCE."MODIFIED_TIME","OWNER_ID" = DBT_INTERNAL_SOURCE."OWNER_ID","OWNER_NAME" = DBT_INTERNAL_SOURCE."OWNER_NAME","RECORDID" = DBT_INTERNAL_SOURCE."RECORDID"
    

    when not matched then insert
        ("APPROVAL_STATUS", "FROM_DATE", "LEAVE_TYPE", "TO_DATE", "CREATED_TIME_INT", "MODIFIED_TIME_INT", "MODIFIED_TIME", "OWNER_ID", "OWNER_NAME", "RECORDID")
    values
        ("APPROVAL_STATUS", "FROM_DATE", "LEAVE_TYPE", "TO_DATE", "CREATED_TIME_INT", "MODIFIED_TIME_INT", "MODIFIED_TIME", "OWNER_ID", "OWNER_NAME", "RECORDID")
2020-05-28 13:03:30.583133 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 28
invalid identifier 'FROM_DATE'
2020-05-28 13:03:30.584131 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: ROLLBACK
2020-05-28 13:03:30.584131 (Thread-1): initiating rollback
2020-05-28 13:03:31.253467 (Thread-1): finished collecting timing info
2020-05-28 13:03:31.254464 (Thread-1): Database Error in model TB_P_DEPARTMENT (models\analytics\TB_P_DEPARTMENT.sql)
  000904 (42000): SQL compilation error: error line 15 at position 28
  invalid identifier 'FROM_DATE'
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_DEPARTMENT.sql
Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 158, in exception_handler
    yield
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "c:\program files (x86)\python38-32\lib\site-packages\snowflake\connector\errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 15 at position 28
invalid identifier 'FROM_DATE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 209, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\clients\jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 217, in execute
    return self.connections.execute(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 299, in add_query
    connection, cursor = super().add_query(
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\sql\connections.py", line 82, in add_query
    return connection, cursor
  File "c:\program files (x86)\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\program files (x86)\python38-32\lib\site-packages\dbt\adapters\snowflake\connections.py", line 176, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model TB_P_DEPARTMENT (models\analytics\TB_P_DEPARTMENT.sql)
  000904 (42000): SQL compilation error: error line 15 at position 28
  invalid identifier 'FROM_DATE'
  compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_DEPARTMENT.sql
2020-05-28 13:03:31.259455 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f65087-6f1a-49ea-874e-64a553525245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EABD9A0>]}
2020-05-28 13:03:31.259455 (Thread-1): 18:33:31 | 1 of 1 ERROR creating incremental model ANALYTICS.TB_P_DEPARTMENT.... [ERROR in 9.34s]
2020-05-28 13:03:31.261232 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 13:03:31.262228 (MainThread): Using snowflake connection "master".
2020-05-28 13:03:31.263226 (MainThread): On master: BEGIN
2020-05-28 13:03:31.719741 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2020-05-28 13:03:31.721375 (MainThread): On master: COMMIT
2020-05-28 13:03:31.721375 (MainThread): Using snowflake connection "master".
2020-05-28 13:03:31.721375 (MainThread): On master: COMMIT
2020-05-28 13:03:32.464289 (MainThread): SQL status: SUCCESS 1 in 0.74 seconds
2020-05-28 13:03:32.466276 (MainThread): 18:33:32 | 
2020-05-28 13:03:32.468227 (MainThread): 18:33:32 | Finished running 1 incremental model in 20.70s.
2020-05-28 13:03:32.470225 (MainThread): Connection 'master' was left open.
2020-05-28 13:03:32.471220 (MainThread): On master: Close
2020-05-28 13:03:33.215705 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 13:03:33.215705 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 13:03:34.161804 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 13:03:34.161804 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 13:03:35.106305 (MainThread): Connection 'model.vbi_zoho_people.TB_P_DEPARTMENT' was left open.
2020-05-28 13:03:35.107301 (MainThread): On model.vbi_zoho_people.TB_P_DEPARTMENT: Close
2020-05-28 13:03:36.064349 (MainThread): 
2020-05-28 13:03:36.065306 (MainThread): Completed with 1 error and 0 warnings:
2020-05-28 13:03:36.066305 (MainThread): 
2020-05-28 13:03:36.072289 (MainThread): Database Error in model TB_P_DEPARTMENT (models\analytics\TB_P_DEPARTMENT.sql)
2020-05-28 13:03:36.073287 (MainThread):   000904 (42000): SQL compilation error: error line 15 at position 28
2020-05-28 13:03:36.074285 (MainThread):   invalid identifier 'FROM_DATE'
2020-05-28 13:03:36.074285 (MainThread):   compiled SQL at target\run\vbi_zoho_people\analytics\TB_P_DEPARTMENT.sql
2020-05-28 13:03:36.075281 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-05-28 13:03:36.076279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EF62B98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EABDBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F906CE8>]}
2020-05-28 13:03:36.076279 (MainThread): Flushing usage events
2020-05-28 13:04:04.791755 (MainThread): Running with dbt=0.16.1
2020-05-28 13:04:04.925440 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 13:04:05.169000 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['TB_P_DEPARTMENT'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 13:04:05.170008 (MainThread): Tracking: tracking
2020-05-28 13:04:05.170008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DAEBB38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E39A430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E39A1C0>]}
2020-05-28 13:04:05.188948 (MainThread): Partial parsing not enabled
2020-05-28 13:04:05.192937 (MainThread): Parsing macros\core.sql
2020-05-28 13:04:05.197922 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 13:04:05.239808 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 13:04:05.249783 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 13:04:05.250780 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 13:04:05.251778 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 13:04:05.254768 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 13:04:05.256764 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 13:04:05.258761 (MainThread): Parsing macros\etc\query.sql
2020-05-28 13:04:05.259755 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 13:04:05.267742 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 13:04:05.280700 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 13:04:05.283693 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 13:04:05.289676 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 13:04:05.311619 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 13:04:05.343534 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 13:04:05.345527 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 13:04:05.362482 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 13:04:05.369463 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 13:04:05.375449 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 13:04:05.381431 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 13:04:05.383427 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 13:04:05.384428 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 13:04:05.386420 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 13:04:05.388414 (MainThread): Parsing macros\adapters.sql
2020-05-28 13:04:05.406370 (MainThread): Parsing macros\catalog.sql
2020-05-28 13:04:05.409357 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 13:04:05.417340 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 13:04:05.420330 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 13:04:05.423320 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 13:04:05.443277 (MainThread): Partial parsing not enabled
2020-05-28 13:04:05.475180 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 13:04:05.475180 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.496124 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 13:04:05.496124 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.502114 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 13:04:05.503106 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.509090 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 13:04:05.510087 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.516074 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:04:05.516074 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.523051 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 13:04:05.523051 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.529037 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 13:04:05.529037 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.743534 (MainThread): Found 7 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 7 sources
2020-05-28 13:04:05.749544 (MainThread): 
2020-05-28 13:04:05.751507 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 13:04:05.751507 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:04:05.758488 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 13:04:05.758488 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 13:04:05.851303 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 13:04:05.851303 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 13:04:07.462806 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 13:04:08.943560 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.09 seconds
2020-05-28 13:04:08.974013 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:04:08.974013 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 13:04:08.976007 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:04:08.976007 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 13:04:11.821884 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.85 seconds
2020-05-28 13:04:11.822879 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:04:11.822879 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 13:04:13.183767 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.36 seconds
2020-05-28 13:04:13.192737 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 13:04:13.192737 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 13:04:13.783671 (MainThread): Using snowflake connection "master".
2020-05-28 13:04:13.783671 (MainThread): On master: BEGIN
2020-05-28 13:04:15.894745 (MainThread): SQL status: SUCCESS 1 in 2.11 seconds
2020-05-28 13:04:15.894745 (MainThread): On master: COMMIT
2020-05-28 13:04:15.895731 (MainThread): Using snowflake connection "master".
2020-05-28 13:04:15.895731 (MainThread): On master: COMMIT
2020-05-28 13:04:16.621612 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2020-05-28 13:04:16.621612 (MainThread): 18:34:16 | Concurrency: 1 threads (target='dev')
2020-05-28 13:04:16.622886 (MainThread): 18:34:16 | 
2020-05-28 13:04:16.625880 (Thread-1): Began running node model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 13:04:16.625880 (Thread-1): 18:34:16 | 1 of 1 START incremental model ANALYTICS.TB_P_DEPARTMENT............. [RUN]
2020-05-28 13:04:16.630867 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:04:16.631865 (Thread-1): Opening a new connection, currently in state init
2020-05-28 13:04:16.631865 (Thread-1): Compiling model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 13:04:16.648850 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_DEPARTMENT"
2020-05-28 13:04:16.649845 (Thread-1): finished collecting timing info
2020-05-28 13:04:16.685778 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_DEPARTMENT"
2020-05-28 13:04:16.686775 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:04:16.686775 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: BEGIN
2020-05-28 13:04:19.402897 (Thread-1): SQL status: SUCCESS 1 in 2.72 seconds
2020-05-28 13:04:19.402897 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:04:19.403900 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DEPARTMENT"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_DEPARTMENT  as
      (

select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    SRC:"Department Head"::varchar(80) as DEPARTMENT_HEAD,  
    SRC:"Department Name"::varchar(30) as DEPARTMENT_NAME,
    SRC:"Parent Department"::varchar(30) as PARENT_DEPARTMENT,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,    
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_DEPARTMENTVIEW   


      );
2020-05-28 13:04:21.101506 (Thread-1): SQL status: SUCCESS 1 in 1.70 seconds
2020-05-28 13:04:21.103502 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: COMMIT
2020-05-28 13:04:21.103502 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:04:21.103502 (Thread-1): On model.vbi_zoho_people.TB_P_DEPARTMENT: COMMIT
2020-05-28 13:04:21.583509 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-05-28 13:04:21.587494 (Thread-1): finished collecting timing info
2020-05-28 13:04:21.587494 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e6bc6af-78f4-45a4-8d34-4cd68c8a68f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8F50A0>]}
2020-05-28 13:04:21.588491 (Thread-1): 18:34:21 | 1 of 1 OK created incremental model ANALYTICS.TB_P_DEPARTMENT........ [SUCCESS 1 in 4.96s]
2020-05-28 13:04:21.589489 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_DEPARTMENT
2020-05-28 13:04:21.590486 (MainThread): Using snowflake connection "master".
2020-05-28 13:04:21.590486 (MainThread): On master: BEGIN
2020-05-28 13:04:22.084760 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2020-05-28 13:04:22.084760 (MainThread): On master: COMMIT
2020-05-28 13:04:22.084760 (MainThread): Using snowflake connection "master".
2020-05-28 13:04:22.085761 (MainThread): On master: COMMIT
2020-05-28 13:04:22.703994 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2020-05-28 13:04:22.704991 (MainThread): 18:34:22 | 
2020-05-28 13:04:22.705985 (MainThread): 18:34:22 | Finished running 1 incremental model in 16.95s.
2020-05-28 13:04:22.706983 (MainThread): Connection 'master' was left open.
2020-05-28 13:04:22.706983 (MainThread): On master: Close
2020-05-28 13:04:23.441173 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 13:04:23.441173 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 13:04:24.305302 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 13:04:24.305302 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 13:04:25.142780 (MainThread): Connection 'model.vbi_zoho_people.TB_P_DEPARTMENT' was left open.
2020-05-28 13:04:25.142780 (MainThread): On model.vbi_zoho_people.TB_P_DEPARTMENT: Close
2020-05-28 13:04:26.569065 (MainThread): 
2020-05-28 13:04:26.570025 (MainThread): Completed successfully
2020-05-28 13:04:26.571023 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 13:04:26.578007 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E49A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E49AF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E49AC70>]}
2020-05-28 13:04:26.578007 (MainThread): Flushing usage events
2020-05-28 13:14:19.969220 (MainThread): Running with dbt=0.16.1
2020-05-28 13:14:20.099867 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-28 13:14:20.344387 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_DESIGNATION'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-28 13:14:20.345440 (MainThread): Tracking: tracking
2020-05-28 13:14:20.345440 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E38CBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC393B8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EC390E8>]}
2020-05-28 13:14:20.364391 (MainThread): Partial parsing not enabled
2020-05-28 13:14:20.367383 (MainThread): Parsing macros\core.sql
2020-05-28 13:14:20.373369 (MainThread): Parsing macros\adapters\common.sql
2020-05-28 13:14:20.415254 (MainThread): Parsing macros\etc\datetime.sql
2020-05-28 13:14:20.425228 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-28 13:14:20.426225 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-28 13:14:20.427223 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-28 13:14:20.429219 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-28 13:14:20.431211 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-28 13:14:20.433207 (MainThread): Parsing macros\etc\query.sql
2020-05-28 13:14:20.435200 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-28 13:14:20.443181 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-28 13:14:20.456146 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-28 13:14:20.458143 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-28 13:14:20.465119 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-28 13:14:20.487062 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-28 13:14:20.519971 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-28 13:14:20.521966 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-28 13:14:20.540916 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-28 13:14:20.547897 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-28 13:14:20.553881 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-28 13:14:20.560846 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-28 13:14:20.562842 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-28 13:14:20.564833 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-28 13:14:20.565789 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-28 13:14:20.567825 (MainThread): Parsing macros\adapters.sql
2020-05-28 13:14:20.586776 (MainThread): Parsing macros\catalog.sql
2020-05-28 13:14:20.589725 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-28 13:14:20.598740 (MainThread): Parsing macros\materializations\merge.sql
2020-05-28 13:14:20.600742 (MainThread): Parsing macros\materializations\table.sql
2020-05-28 13:14:20.604735 (MainThread): Parsing macros\materializations\view.sql
2020-05-28 13:14:20.624676 (MainThread): Partial parsing not enabled
2020-05-28 13:14:20.657585 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-28 13:14:20.658584 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.680526 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-28 13:14:20.680526 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.687503 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-28 13:14:20.687503 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.694488 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-28 13:14:20.694488 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.701441 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-28 13:14:20.701441 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.708450 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-28 13:14:20.708450 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.715430 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-28 13:14:20.715430 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.721413 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-28 13:14:20.721413 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.945562 (MainThread): Found 8 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 8 sources
2020-05-28 13:14:20.951507 (MainThread): 
2020-05-28 13:14:20.954499 (MainThread): Acquiring new snowflake connection "master".
2020-05-28 13:14:20.954499 (MainThread): Opening a new connection, currently in state init
2020-05-28 13:14:20.961480 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 13:14:20.962633 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-28 13:14:21.059377 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-28 13:14:21.059377 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-28 13:14:22.388560 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-28 13:14:23.632758 (ThreadPoolExecutor-0_0): unclosed <socket.socket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.43.142', 52147), raddr=('52.184.166.117', 443)>
2020-05-28 13:14:23.635749 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.58 seconds
2020-05-28 13:14:23.670645 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:14:23.670645 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-28 13:14:23.672640 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:14:23.673704 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-28 13:14:25.797998 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.12 seconds
2020-05-28 13:14:25.797998 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-28 13:14:25.797998 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-28 13:14:27.477208 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.68 seconds
2020-05-28 13:14:27.485165 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-28 13:14:27.486168 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-28 13:14:28.049980 (MainThread): Using snowflake connection "master".
2020-05-28 13:14:28.050978 (MainThread): On master: BEGIN
2020-05-28 13:14:30.513579 (MainThread): SQL status: SUCCESS 1 in 2.46 seconds
2020-05-28 13:14:30.513579 (MainThread): On master: COMMIT
2020-05-28 13:14:30.514583 (MainThread): Using snowflake connection "master".
2020-05-28 13:14:30.515580 (MainThread): On master: COMMIT
2020-05-28 13:14:31.151662 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-05-28 13:14:31.151662 (MainThread): 18:44:31 | Concurrency: 1 threads (target='dev')
2020-05-28 13:14:31.152724 (MainThread): 18:44:31 | 
2020-05-28 13:14:31.155694 (Thread-1): Began running node model.vbi_zoho_people.TB_P_DESIGNATION
2020-05-28 13:14:31.155694 (Thread-1): 18:44:31 | 1 of 1 START incremental model ANALYTICS.TB_P_DESIGNATION............ [RUN]
2020-05-28 13:14:31.156669 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-28 13:14:31.156669 (Thread-1): Opening a new connection, currently in state init
2020-05-28 13:14:31.156669 (Thread-1): Compiling model.vbi_zoho_people.TB_P_DESIGNATION
2020-05-28 13:14:31.174601 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_DESIGNATION"
2020-05-28 13:14:31.175599 (Thread-1): finished collecting timing info
2020-05-28 13:14:31.217486 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_DESIGNATION"
2020-05-28 13:14:31.220479 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-28 13:14:31.220479 (Thread-1): On model.vbi_zoho_people.TB_P_DESIGNATION: BEGIN
2020-05-28 13:14:33.527212 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2020-05-28 13:14:33.528220 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-28 13:14:33.528220 (Thread-1): On model.vbi_zoho_people.TB_P_DESIGNATION: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_DESIGNATION"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_DESIGNATION  as
      (

select 
    SRC:"Added By"::varchar(80) as ADDED_BY,
    TO_TIMESTAMP((SRC:"Added time")::String, 'DD-mon-YYYY HH:MI:SS') as ADDED_TIME,
    SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    SRC:"Designation Name"::varchar(80) as DESIGNATION_NAME,
    SRC:"Mail Alias"::varchar(40) as MAIL_ALIAS,  
    SRC:"Modified By"::varchar(80) as MODIFIED_BY,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT,    
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    TO_TIMESTAMP((SRC:"Modified time")::String, 'DD-mon-YYYY HH:MI:SS') as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID

from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_DESIGNATIONVIEW   


      );
2020-05-28 13:14:35.248292 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2020-05-28 13:14:35.250285 (Thread-1): On model.vbi_zoho_people.TB_P_DESIGNATION: COMMIT
2020-05-28 13:14:35.250285 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-28 13:14:35.250285 (Thread-1): On model.vbi_zoho_people.TB_P_DESIGNATION: COMMIT
2020-05-28 13:14:35.690049 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2020-05-28 13:14:35.694006 (Thread-1): finished collecting timing info
2020-05-28 13:14:35.695039 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc7e10c-1936-4728-a98b-6a19c95b9163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F18A088>]}
2020-05-28 13:14:35.696044 (Thread-1): 18:44:35 | 1 of 1 OK created incremental model ANALYTICS.TB_P_DESIGNATION....... [SUCCESS 1 in 4.54s]
2020-05-28 13:14:35.697997 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_DESIGNATION
2020-05-28 13:14:35.700027 (MainThread): Using snowflake connection "master".
2020-05-28 13:14:35.700027 (MainThread): On master: BEGIN
2020-05-28 13:14:36.175548 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2020-05-28 13:14:36.176545 (MainThread): On master: COMMIT
2020-05-28 13:14:36.177544 (MainThread): Using snowflake connection "master".
2020-05-28 13:14:36.177544 (MainThread): On master: COMMIT
2020-05-28 13:14:36.914755 (MainThread): SQL status: SUCCESS 1 in 0.74 seconds
2020-05-28 13:14:36.916714 (MainThread): 18:44:36 | 
2020-05-28 13:14:36.917709 (MainThread): 18:44:36 | Finished running 1 incremental model in 15.96s.
2020-05-28 13:14:36.920706 (MainThread): Connection 'master' was left open.
2020-05-28 13:14:36.920706 (MainThread): On master: Close
2020-05-28 13:14:37.711339 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-28 13:14:37.711339 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-28 13:14:39.889030 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-28 13:14:39.890011 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-28 13:14:41.071091 (MainThread): Connection 'model.vbi_zoho_people.TB_P_DESIGNATION' was left open.
2020-05-28 13:14:41.071091 (MainThread): On model.vbi_zoho_people.TB_P_DESIGNATION: Close
2020-05-28 13:14:41.803186 (MainThread): 
2020-05-28 13:14:41.805181 (MainThread): Completed successfully
2020-05-28 13:14:41.806211 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-28 13:14:41.815150 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0ED0DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F184A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F184F10>]}
2020-05-28 13:14:41.816147 (MainThread): Flushing usage events
2020-05-29 07:28:16.587329 (MainThread): Running with dbt=0.16.1
2020-05-29 07:28:16.974826 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-29 07:28:17.905097 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_PROJECT_DEPARTMENT_CHANGES'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-29 07:28:17.905097 (MainThread): Tracking: tracking
2020-05-29 07:28:17.905097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D85BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E10A070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E10A0E8>]}
2020-05-29 07:28:17.949487 (MainThread): Partial parsing not enabled
2020-05-29 07:28:17.965109 (MainThread): Parsing macros\core.sql
2020-05-29 07:28:17.972718 (MainThread): Parsing macros\adapters\common.sql
2020-05-29 07:28:18.088599 (MainThread): Parsing macros\etc\datetime.sql
2020-05-29 07:28:18.090593 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-29 07:28:18.106263 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-29 07:28:18.110160 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-29 07:28:18.114448 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-29 07:28:18.118314 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-29 07:28:18.119315 (MainThread): Parsing macros\etc\query.sql
2020-05-29 07:28:18.119315 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-29 07:28:18.134982 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-29 07:28:18.150603 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-29 07:28:18.150603 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-29 07:28:18.166225 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-29 07:28:18.197467 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-29 07:28:18.249841 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-29 07:28:18.249841 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-29 07:28:18.284510 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-29 07:28:18.300132 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-29 07:28:18.300132 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-29 07:28:18.318759 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-29 07:28:18.318759 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-29 07:28:18.331305 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-29 07:28:18.333588 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-29 07:28:18.334585 (MainThread): Parsing macros\adapters.sql
2020-05-29 07:28:18.367481 (MainThread): Parsing macros\catalog.sql
2020-05-29 07:28:18.369476 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-29 07:28:18.385146 (MainThread): Parsing macros\materializations\merge.sql
2020-05-29 07:28:18.385146 (MainThread): Parsing macros\materializations\table.sql
2020-05-29 07:28:18.385146 (MainThread): Parsing macros\materializations\view.sql
2020-05-29 07:28:18.437142 (MainThread): Partial parsing not enabled
2020-05-29 07:28:18.506740 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-29 07:28:18.506740 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.550110 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE copy".
2020-05-29 07:28:18.550110 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.560310 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-29 07:28:18.560310 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.615927 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-29 07:28:18.615927 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.647218 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:28:18.647218 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.675748 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-29 07:28:18.675748 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.691312 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-29 07:28:18.691312 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.706991 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-29 07:28:18.706991 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.722611 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-29 07:28:18.722611 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:18.738228 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-29 07:28:18.738228 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:19.156270 (MainThread): Found 10 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 9 sources
2020-05-29 07:28:19.169435 (MainThread): 
2020-05-29 07:28:19.169576 (MainThread): 12:58:19 | Concurrency: 1 threads (target='dev')
2020-05-29 07:28:19.169576 (MainThread): 12:58:19 | 
2020-05-29 07:28:19.181160 (Thread-1): Began running node model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES
2020-05-29 07:28:19.182158 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:28:19.182471 (Thread-1): Opening a new connection, currently in state init
2020-05-29 07:28:19.182471 (Thread-1): Compiling model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES
2020-05-29 07:28:19.211614 (Thread-1): On "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-29 07:28:19.414951 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:28:19.414951 (Thread-1): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: BEGIN
2020-05-29 07:28:21.660997 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-29 07:28:24.024040 (Thread-1): SQL status: SUCCESS 1 in 4.61 seconds
2020-05-29 07:28:24.024040 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:28:24.024040 (Thread-1): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-29 07:28:25.252259 (Thread-1): SQL status: SUCCESS 8 in 1.23 seconds
2020-05-29 07:28:25.304339 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_EMPLOYEEINACTIVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_APPLY_LEAVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_DEPARTMENT">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_DESIGNATION">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_EMPLOYEE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES">]
2020-05-29 07:28:25.304339 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES"
2020-05-29 07:28:25.355066 (Thread-1): finished collecting timing info
2020-05-29 07:28:25.356064 (Thread-1): finished collecting timing info
2020-05-29 07:28:25.356064 (Thread-1): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: ROLLBACK
2020-05-29 07:28:25.356064 (Thread-1): initiating rollback
2020-05-29 07:28:26.277511 (Thread-1): Finished running node model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES
2020-05-29 07:28:26.281708 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES' was properly closed.
2020-05-29 07:28:26.281708 (MainThread): Connection 'model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES' was left open.
2020-05-29 07:28:26.281708 (MainThread): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: Close
2020-05-29 07:28:27.409922 (MainThread): 12:58:27 | Done.
2020-05-29 07:28:27.412807 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E1DDBC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E2355B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E235598>]}
2020-05-29 07:28:27.413804 (MainThread): Flushing usage events
2020-05-29 07:28:43.458450 (MainThread): Running with dbt=0.16.1
2020-05-29 07:28:43.710590 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-29 07:28:44.146673 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_PROJECT_DEPARTMENT_CHANGES'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-29 07:28:44.146673 (MainThread): Tracking: tracking
2020-05-29 07:28:44.146673 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D78B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0393D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E039160>]}
2020-05-29 07:28:44.201705 (MainThread): Partial parsing not enabled
2020-05-29 07:28:44.209512 (MainThread): Parsing macros\core.sql
2020-05-29 07:28:44.225044 (MainThread): Parsing macros\adapters\common.sql
2020-05-29 07:28:44.350400 (MainThread): Parsing macros\etc\datetime.sql
2020-05-29 07:28:44.378894 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-29 07:28:44.383069 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-29 07:28:44.387636 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-29 07:28:44.393219 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-29 07:28:44.400207 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-29 07:28:44.402354 (MainThread): Parsing macros\etc\query.sql
2020-05-29 07:28:44.409556 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-29 07:28:44.431658 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-29 07:28:44.468968 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-29 07:28:44.475070 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-29 07:28:44.491476 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-29 07:28:44.553963 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-29 07:28:44.653770 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-29 07:28:44.660874 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-29 07:28:44.720165 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-29 07:28:44.744425 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-29 07:28:44.761910 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-29 07:28:44.784917 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-29 07:28:44.791696 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-29 07:28:44.795483 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-29 07:28:44.799810 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-29 07:28:44.805881 (MainThread): Parsing macros\adapters.sql
2020-05-29 07:28:44.863500 (MainThread): Parsing macros\catalog.sql
2020-05-29 07:28:44.867499 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-29 07:28:44.897246 (MainThread): Parsing macros\materializations\merge.sql
2020-05-29 07:28:44.901251 (MainThread): Parsing macros\materializations\table.sql
2020-05-29 07:28:44.915681 (MainThread): Parsing macros\materializations\view.sql
2020-05-29 07:28:44.967216 (MainThread): Partial parsing not enabled
2020-05-29 07:28:45.051672 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-29 07:28:45.051672 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.109313 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE copy".
2020-05-29 07:28:45.109313 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.121747 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-29 07:28:45.121747 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.142326 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-29 07:28:45.142326 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.162944 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:28:45.162944 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.181411 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-29 07:28:45.181411 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.193948 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-29 07:28:45.193948 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.214448 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-29 07:28:45.214448 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.232689 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-29 07:28:45.232689 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.245091 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-29 07:28:45.245091 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.881215 (MainThread): Found 10 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 9 sources
2020-05-29 07:28:45.895704 (MainThread): 
2020-05-29 07:28:45.896227 (MainThread): Acquiring new snowflake connection "master".
2020-05-29 07:28:45.896227 (MainThread): Opening a new connection, currently in state init
2020-05-29 07:28:45.907252 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-29 07:28:45.907252 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-29 07:28:46.377275 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-29 07:28:46.381442 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-29 07:28:47.608767 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-29 07:28:49.827556 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.45 seconds
2020-05-29 07:28:49.952697 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-29 07:28:49.953691 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-29 07:28:49.959173 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-29 07:28:49.959173 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-29 07:28:52.605960 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.65 seconds
2020-05-29 07:28:52.605960 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-29 07:28:52.605960 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-29 07:28:54.128938 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.52 seconds
2020-05-29 07:28:54.161395 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-29 07:28:54.161395 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-29 07:28:54.704431 (MainThread): Using snowflake connection "master".
2020-05-29 07:28:54.704431 (MainThread): On master: BEGIN
2020-05-29 07:28:57.817687 (MainThread): SQL status: SUCCESS 1 in 3.11 seconds
2020-05-29 07:28:57.818106 (MainThread): On master: COMMIT
2020-05-29 07:28:57.819104 (MainThread): Using snowflake connection "master".
2020-05-29 07:28:57.819104 (MainThread): On master: COMMIT
2020-05-29 07:28:58.731133 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2020-05-29 07:28:58.732129 (MainThread): 12:58:58 | Concurrency: 1 threads (target='dev')
2020-05-29 07:28:58.732129 (MainThread): 12:58:58 | 
2020-05-29 07:28:58.776304 (Thread-1): Began running node model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES
2020-05-29 07:28:58.778384 (Thread-1): 12:58:58 | 1 of 1 START incremental model ANALYTICS.TB_PROJECT_DEPARTMENT_CHANGES [RUN]
2020-05-29 07:28:58.781441 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:28:58.782487 (Thread-1): Opening a new connection, currently in state init
2020-05-29 07:28:58.782487 (Thread-1): Compiling model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES
2020-05-29 07:28:58.878568 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES"
2020-05-29 07:28:58.878568 (Thread-1): finished collecting timing info
2020-05-29 07:28:58.999362 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES"
2020-05-29 07:28:59.016516 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:28:59.016516 (Thread-1): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: BEGIN
2020-05-29 07:29:01.706609 (Thread-1): SQL status: SUCCESS 1 in 2.69 seconds
2020-05-29 07:29:01.706609 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:29:01.706609 (Thread-1): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_PROJECT_DEPARTMENT_CHANGES  as
      (

Select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    SRC:"Associate ID"::varchar(80) as ASSOCIATE_ID,
    SRC:"Current Department"::varchar(30) as CURRENT_DEPARTMENT,
    SRC:"Current Project"::varchar(15) as CURRENT_PROJECT,
    SRC:"Current Project Lead"::varchar(80) as CURRENT_PROJECT_LEAD,
    SRC:"Department"::varchar(30) as DEPARTMENT,
    SRC:"Initiate Post Project Feedback "::varchar(5) as INITIAL_POST_PROJECT_FEEDBACK,
    SRC:"New Department"::varchar(30) as NEW_DEPARTMENT,
    SRC:"New Project"::varchar(15) as NEW_PROJECT,
    SRC:"New Project Department Name"::varchar(50) as NEW_PROJECT_DEPARTMENT_NAME,
    SRC:"New Project Lead"::varchar(80) as NEW_PROJECT_LEAD,
    SRC:"Post Project Feedback to be filled by"::varchar(80) as POST_PROJECT_FEEDBACK_TO_BE_FILLED_BY,
    SRC:"Project Lead"::varchar(80) as PROJECT_LEAD,
    SRC:"Project Name"::varchar(80) as PROJECT_NAME,
    SRC:"Reasons for Department Change"::varchar(250) as REASONS_FOR_DEPARTMENT_CHANGE,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT, 
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_PROJECT_DEPARTMENT_CHANGES_VIEW


      );
2020-05-29 07:29:03.449025 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2020-05-29 07:29:03.452858 (Thread-1): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: COMMIT
2020-05-29 07:29:03.453857 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 07:29:03.453857 (Thread-1): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: COMMIT
2020-05-29 07:29:03.951048 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2020-05-29 07:29:03.966300 (Thread-1): finished collecting timing info
2020-05-29 07:29:03.970856 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec64dc63-b486-459e-9069-a21b2b41887d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E575CA0>]}
2020-05-29 07:29:03.970856 (Thread-1): 12:59:03 | 1 of 1 OK created incremental model ANALYTICS.TB_PROJECT_DEPARTMENT_CHANGES [SUCCESS 1 in 5.19s]
2020-05-29 07:29:03.977714 (Thread-1): Finished running node model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES
2020-05-29 07:29:03.981975 (MainThread): Using snowflake connection "master".
2020-05-29 07:29:03.981975 (MainThread): On master: BEGIN
2020-05-29 07:29:04.574595 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2020-05-29 07:29:04.574595 (MainThread): On master: COMMIT
2020-05-29 07:29:04.574595 (MainThread): Using snowflake connection "master".
2020-05-29 07:29:04.574595 (MainThread): On master: COMMIT
2020-05-29 07:29:05.236868 (MainThread): SQL status: SUCCESS 1 in 0.66 seconds
2020-05-29 07:29:05.236868 (MainThread): 12:59:05 | 
2020-05-29 07:29:05.241071 (MainThread): 12:59:05 | Finished running 1 incremental model in 19.34s.
2020-05-29 07:29:05.241589 (MainThread): Connection 'master' was left open.
2020-05-29 07:29:05.241589 (MainThread): On master: Close
2020-05-29 07:29:06.216022 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-29 07:29:06.216022 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-29 07:29:07.237936 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-29 07:29:07.237936 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-29 07:29:08.456161 (MainThread): Connection 'model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES' was left open.
2020-05-29 07:29:08.456161 (MainThread): On model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES: Close
2020-05-29 07:29:09.704619 (MainThread): 
2020-05-29 07:29:09.705660 (MainThread): Completed successfully
2020-05-29 07:29:09.707290 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-29 07:29:09.708298 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E13B040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E13B220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E571700>]}
2020-05-29 07:29:09.709329 (MainThread): Flushing usage events
2020-05-29 10:05:07.751501 (MainThread): Running with dbt=0.16.1
2020-05-29 10:05:08.053092 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-29 10:05:08.729131 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_ATTENDANCE'], parse_only=False, partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-05-29 10:05:08.736196 (MainThread): Tracking: tracking
2020-05-29 10:05:08.736196 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E04C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8E9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E8E9028>]}
2020-05-29 10:05:08.766446 (MainThread): Partial parsing not enabled
2020-05-29 10:05:08.774526 (MainThread): Parsing macros\core.sql
2020-05-29 10:05:08.782453 (MainThread): Parsing macros\adapters\common.sql
2020-05-29 10:05:08.860890 (MainThread): Parsing macros\etc\datetime.sql
2020-05-29 10:05:08.876168 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-29 10:05:08.884125 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-29 10:05:08.884125 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-29 10:05:08.884125 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-29 10:05:08.892196 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-29 10:05:08.892196 (MainThread): Parsing macros\etc\query.sql
2020-05-29 10:05:08.900131 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-29 10:05:08.908211 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-29 10:05:08.932145 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-29 10:05:08.932145 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-29 10:05:08.948151 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-29 10:05:08.980163 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-29 10:05:09.036230 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-29 10:05:09.044184 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-29 10:05:09.068240 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-29 10:05:09.076196 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-29 10:05:09.092202 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-29 10:05:09.100252 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-29 10:05:09.100252 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-29 10:05:09.100252 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-29 10:05:09.108207 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-29 10:05:09.108207 (MainThread): Parsing macros\adapters.sql
2020-05-29 10:05:09.142432 (MainThread): Parsing macros\catalog.sql
2020-05-29 10:05:09.142432 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-29 10:05:09.158404 (MainThread): Parsing macros\materializations\merge.sql
2020-05-29 10:05:09.158404 (MainThread): Parsing macros\materializations\table.sql
2020-05-29 10:05:09.166378 (MainThread): Parsing macros\materializations\view.sql
2020-05-29 10:05:09.198391 (MainThread): Partial parsing not enabled
2020-05-29 10:05:09.252593 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-29 10:05:09.252593 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.281183 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE copy".
2020-05-29 10:05:09.281183 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.289234 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-29 10:05:09.289234 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.305265 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-29 10:05:09.305265 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.313197 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 10:05:09.313197 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.321246 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-29 10:05:09.321246 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.329203 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:09.329203 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.345209 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-29 10:05:09.345209 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.353276 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-29 10:05:09.353276 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.364219 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-29 10:05:09.364219 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.372283 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-29 10:05:09.372283 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:09.795872 (MainThread): Found 11 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 10 sources
2020-05-29 10:05:09.808644 (MainThread): 
2020-05-29 10:05:09.810675 (MainThread): 15:35:09 | Concurrency: 1 threads (target='dev')
2020-05-29 10:05:09.811636 (MainThread): 15:35:09 | 
2020-05-29 10:05:09.816783 (Thread-1): Began running node model.vbi_zoho_people.TB_P_ATTENDANCE
2020-05-29 10:05:09.817780 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:09.817780 (Thread-1): Opening a new connection, currently in state init
2020-05-29 10:05:09.817780 (Thread-1): Compiling model.vbi_zoho_people.TB_P_ATTENDANCE
2020-05-29 10:05:09.842844 (Thread-1): On "model.vbi_zoho_people.TB_P_ATTENDANCE": cache miss for schema "ZOHO_OA_EDW.ANALYTICS", this is inefficient
2020-05-29 10:05:10.033202 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:10.033202 (Thread-1): On model.vbi_zoho_people.TB_P_ATTENDANCE: BEGIN
2020-05-29 10:05:12.074147 (Thread-1): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-29 10:05:13.898039 (Thread-1): SQL status: SUCCESS 1 in 3.86 seconds
2020-05-29 10:05:13.898039 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:13.898039 (Thread-1): On model.vbi_zoho_people.TB_P_ATTENDANCE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_ATTENDANCE"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'ANALYTICS'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-29 10:05:15.331469 (Thread-1): SQL status: SUCCESS 9 in 1.43 seconds
2020-05-29 10:05:15.379541 (Thread-1): with database=ZOHO_OA_EDW, schema=ANALYTICS, relations=[<SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_ASSOCIATE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_EMPLOYEEINACTIVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_LEAVE_APPROVER">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_PROJECT_DEPARTMENT_CHANGES">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_APPLY_LEAVE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_DEPARTMENT">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_DESIGNATION">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_P_EMPLOYEE">, <SnowflakeRelation "ZOHO_OA_EDW"."ANALYTICS"."TB_REPORTING_CHANGES">]
2020-05-29 10:05:15.387538 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_ATTENDANCE"
2020-05-29 10:05:15.392546 (Thread-1): finished collecting timing info
2020-05-29 10:05:15.393597 (Thread-1): finished collecting timing info
2020-05-29 10:05:15.393597 (Thread-1): On model.vbi_zoho_people.TB_P_ATTENDANCE: ROLLBACK
2020-05-29 10:05:15.393597 (Thread-1): initiating rollback
2020-05-29 10:05:16.150583 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_ATTENDANCE
2020-05-29 10:05:16.155862 (MainThread): Connection 'model.vbi_zoho_people.TB_REPORTING_CHANGES' was properly closed.
2020-05-29 10:05:16.156910 (MainThread): Connection 'model.vbi_zoho_people.TB_P_ATTENDANCE' was left open.
2020-05-29 10:05:16.156910 (MainThread): On model.vbi_zoho_people.TB_P_ATTENDANCE: Close
2020-05-29 10:05:17.400335 (MainThread): 15:35:17 | Done.
2020-05-29 10:05:17.402291 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA50C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA5FE38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EA0FA60>]}
2020-05-29 10:05:17.402905 (MainThread): Flushing usage events
2020-05-29 10:05:30.045015 (MainThread): Running with dbt=0.16.1
2020-05-29 10:05:30.285709 (MainThread): Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
2020-05-29 10:05:30.667659 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['TB_P_ATTENDANCE'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\manikandanm\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-05-29 10:05:30.671663 (MainThread): Tracking: tracking
2020-05-29 10:05:30.671663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0D72C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFD9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0DFD90B8>]}
2020-05-29 10:05:30.702036 (MainThread): Partial parsing not enabled
2020-05-29 10:05:30.705987 (MainThread): Parsing macros\core.sql
2020-05-29 10:05:30.714076 (MainThread): Parsing macros\adapters\common.sql
2020-05-29 10:05:30.774845 (MainThread): Parsing macros\etc\datetime.sql
2020-05-29 10:05:30.790888 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-05-29 10:05:30.790888 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-05-29 10:05:30.798919 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-05-29 10:05:30.798919 (MainThread): Parsing macros\etc\get_relation_comment.sql
2020-05-29 10:05:30.798919 (MainThread): Parsing macros\etc\is_incremental.sql
2020-05-29 10:05:30.806929 (MainThread): Parsing macros\etc\query.sql
2020-05-29 10:05:30.806929 (MainThread): Parsing macros\materializations\helpers.sql
2020-05-29 10:05:30.822970 (MainThread): Parsing macros\materializations\common\merge.sql
2020-05-29 10:05:30.839012 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-05-29 10:05:30.839012 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-05-29 10:05:30.855064 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-05-29 10:05:30.887149 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-05-29 10:05:30.935272 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-05-29 10:05:30.935272 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-05-29 10:05:30.967357 (MainThread): Parsing macros\materializations\table\table.sql
2020-05-29 10:05:30.983399 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-05-29 10:05:30.986543 (MainThread): Parsing macros\materializations\view\view.sql
2020-05-29 10:05:30.995755 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-05-29 10:05:31.003706 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-05-29 10:05:31.003706 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-05-29 10:05:31.003706 (MainThread): Parsing macros\schema_tests\unique.sql
2020-05-29 10:05:31.003706 (MainThread): Parsing macros\adapters.sql
2020-05-29 10:05:31.038743 (MainThread): Parsing macros\catalog.sql
2020-05-29 10:05:31.041866 (MainThread): Parsing macros\materializations\incremental.sql
2020-05-29 10:05:31.055376 (MainThread): Parsing macros\materializations\merge.sql
2020-05-29 10:05:31.058726 (MainThread): Parsing macros\materializations\table.sql
2020-05-29 10:05:31.063862 (MainThread): Parsing macros\materializations\view.sql
2020-05-29 10:05:31.095023 (MainThread): Partial parsing not enabled
2020-05-29 10:05:31.143818 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_ASSOCIATE".
2020-05-29 10:05:31.143818 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.175897 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE copy".
2020-05-29 10:05:31.175897 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.183918 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_EMPLOYEEINACTIVE".
2020-05-29 10:05:31.183918 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.192012 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_LEAVE_APPROVER".
2020-05-29 10:05:31.192012 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.199961 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_PROJECT_DEPARTMENT_CHANGES".
2020-05-29 10:05:31.199961 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.217310 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_APPLY_LEAVE".
2020-05-29 10:05:31.217526 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.227232 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:31.227232 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.239568 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DEPARTMENT".
2020-05-29 10:05:31.239568 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.249778 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_DESIGNATION".
2020-05-29 10:05:31.251905 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.263956 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_EMPLOYEE".
2020-05-29 10:05:31.263956 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.271959 (MainThread): Acquiring new snowflake connection "model.vbi_zoho_people.TB_REPORTING_CHANGES".
2020-05-29 10:05:31.271959 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.758410 (MainThread): Found 11 models, 0 tests, 0 snapshots, 0 analyses, 130 macros, 0 operations, 0 seed files, 10 sources
2020-05-29 10:05:31.771795 (MainThread): 
2020-05-29 10:05:31.776067 (MainThread): Acquiring new snowflake connection "master".
2020-05-29 10:05:31.776067 (MainThread): Opening a new connection, currently in state init
2020-05-29 10:05:31.789347 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW".
2020-05-29 10:05:31.789347 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-05-29 10:05:31.973871 (ThreadPoolExecutor-0_0): Using snowflake connection "list_ZOHO_OA_EDW".
2020-05-29 10:05:31.973871 (ThreadPoolExecutor-0_0): On list_ZOHO_OA_EDW: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW"} */

    show terse schemas in database ZOHO_OA_EDW
    limit 10000
2020-05-29 10:05:34.217985 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='c:\\program files (x86)\\python38-32\\lib\\site-packages\\certifi\\cacert.pem'>
2020-05-29 10:05:35.605851 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.63 seconds
2020-05-29 10:05:35.763375 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-29 10:05:35.763375 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-05-29 10:05:35.764413 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-29 10:05:35.764413 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: BEGIN
2020-05-29 10:05:39.137242 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 3.37 seconds
2020-05-29 10:05:39.137242 (ThreadPoolExecutor-1_0): Using snowflake connection "list_ZOHO_OA_EDW_analytics".
2020-05-29 10:05:39.137242 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "connection_name": "list_ZOHO_OA_EDW_analytics"} */
select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           when table_type = 'EXTERNAL TABLE' then 'external'
           else table_type
      end as table_type
    from ZOHO_OA_EDW.INFORMATION_SCHEMA.tables
    where table_schema ilike 'analytics'
      and table_catalog ilike 'zoho_oa_edw'
2020-05-29 10:05:40.454135 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 1.32 seconds
2020-05-29 10:05:40.494150 (ThreadPoolExecutor-1_0): On list_ZOHO_OA_EDW_analytics: ROLLBACK
2020-05-29 10:05:40.494150 (ThreadPoolExecutor-1_0): initiating rollback
2020-05-29 10:05:41.755441 (MainThread): Using snowflake connection "master".
2020-05-29 10:05:41.755441 (MainThread): On master: BEGIN
2020-05-29 10:05:44.524268 (MainThread): SQL status: SUCCESS 1 in 2.77 seconds
2020-05-29 10:05:44.524268 (MainThread): On master: COMMIT
2020-05-29 10:05:44.524268 (MainThread): Using snowflake connection "master".
2020-05-29 10:05:44.524268 (MainThread): On master: COMMIT
2020-05-29 10:05:45.228752 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2020-05-29 10:05:45.228752 (MainThread): 15:35:45 | Concurrency: 1 threads (target='dev')
2020-05-29 10:05:45.236048 (MainThread): 15:35:45 | 
2020-05-29 10:05:45.338529 (Thread-1): Began running node model.vbi_zoho_people.TB_P_ATTENDANCE
2020-05-29 10:05:45.338529 (Thread-1): 15:35:45 | 1 of 1 START incremental model ANALYTICS.TB_P_ATTENDANCE............. [RUN]
2020-05-29 10:05:45.339526 (Thread-1): Acquiring new snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:45.340523 (Thread-1): Opening a new connection, currently in state init
2020-05-29 10:05:45.340523 (Thread-1): Compiling model.vbi_zoho_people.TB_P_ATTENDANCE
2020-05-29 10:05:45.413043 (Thread-1): Writing injected SQL for node "model.vbi_zoho_people.TB_P_ATTENDANCE"
2020-05-29 10:05:45.414531 (Thread-1): finished collecting timing info
2020-05-29 10:05:45.465714 (Thread-1): Writing runtime SQL for node "model.vbi_zoho_people.TB_P_ATTENDANCE"
2020-05-29 10:05:45.473793 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:45.473793 (Thread-1): On model.vbi_zoho_people.TB_P_ATTENDANCE: BEGIN
2020-05-29 10:05:48.757090 (Thread-1): SQL status: SUCCESS 1 in 3.28 seconds
2020-05-29 10:05:48.758350 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:48.759120 (Thread-1): On model.vbi_zoho_people.TB_P_ATTENDANCE: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "zohopeople", "target_name": "dev", "node_id": "model.vbi_zoho_people.TB_P_ATTENDANCE"} */


      create or replace transient table ZOHO_OA_EDW.ANALYTICS.TB_P_ATTENDANCE  as
      (

Select 
    SRC:"ApprovalStatus"::varchar(30) as APPROVAL_STATUS,
    to_date(SRC:"Attendance Day"::String , 'DD-Mon-YYYY') as ATTENDANCE_DAY,
    TRY_TO_TIME(SRC:"Break Time"::String) as BREAK_TIME,    
    SRC:"Description"::varchar(250) as DESCRIPTION,
    TRY_TO_TIME(SRC:"Deviation Time"::String) as DEVIATION_TIME,
    SRC:"Employee ID"::varchar(80) as EMPLOYEE_ID,
    to_timestamp(SRC:"Expected FromTime"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_FROMTIME,
    to_timestamp(SRC:"Expected ToTime"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_TOTIME,
    case
        when length(SRC:"From Time")=0 then
            to_timestamp('0001-01-01 00:00:00')
        else
            to_timestamp(SRC:"From Time"::String, 'DD-MON-YYYY HH:MI:SS')
    end
    as FROM_TIME,
    try_cast(SRC:"InputType"::String as Smallint) as INPUT_TYPE,
    TRY_TO_TIME(SRC:"Over Time"::String) as OVER_TIME,  
    try_cast(SRC:"Status"::String as Smallint) as STATUS,    
    case
        when length(SRC:"To Time")=0 then
            to_timestamp('0001-01-01 00:00:00')
        else
            to_timestamp(SRC:"To Time"::String, 'DD-MON-YYYY HH:MI:SS')
    end
    as TO_TIME,
    to_time(SRC:"Total Hours"::String, 'HH24:MI') as TOTAL_HOURS,
    to_time(SRC:"Working Hours"::String, 'HH24:MI') as WORKING_HOURS,
    SRC:"createdTime"::varchar(15) as CREATED_TIME_INT, 
    SRC:"modifiedTime"::varchar(15) as MODIFIED_TIME_INT,  
    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,
    SRC:"ownerID"::varchar(30) as OWNER_ID,    
    SRC:"ownerName"::varchar(80) as OWNER_NAME,
    SRC:"recordId"::varchar(20) as RECORDID
    
from ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_ATTENDANCEFORM_VIEW


      );
2020-05-29 10:05:50.352232 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2020-05-29 10:05:50.352232 (Thread-1): On model.vbi_zoho_people.TB_P_ATTENDANCE: COMMIT
2020-05-29 10:05:50.352232 (Thread-1): Using snowflake connection "model.vbi_zoho_people.TB_P_ATTENDANCE".
2020-05-29 10:05:50.352232 (Thread-1): On model.vbi_zoho_people.TB_P_ATTENDANCE: COMMIT
2020-05-29 10:05:50.814749 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2020-05-29 10:05:50.822763 (Thread-1): finished collecting timing info
2020-05-29 10:05:50.822763 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b04e7ff-763b-4d2e-9471-8b7fecbc4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E163508>]}
2020-05-29 10:05:50.822763 (Thread-1): 15:35:50 | 1 of 1 OK created incremental model ANALYTICS.TB_P_ATTENDANCE........ [SUCCESS 1 in 5.48s]
2020-05-29 10:05:50.833937 (Thread-1): Finished running node model.vbi_zoho_people.TB_P_ATTENDANCE
2020-05-29 10:05:50.837871 (MainThread): Using snowflake connection "master".
2020-05-29 10:05:50.837871 (MainThread): On master: BEGIN
2020-05-29 10:05:51.522748 (MainThread): SQL status: SUCCESS 1 in 0.68 seconds
2020-05-29 10:05:51.522748 (MainThread): On master: COMMIT
2020-05-29 10:05:51.522748 (MainThread): Using snowflake connection "master".
2020-05-29 10:05:51.522748 (MainThread): On master: COMMIT
2020-05-29 10:05:52.407265 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2020-05-29 10:05:52.407265 (MainThread): 15:35:52 | 
2020-05-29 10:05:52.413446 (MainThread): 15:35:52 | Finished running 1 incremental model in 20.63s.
2020-05-29 10:05:52.415109 (MainThread): Connection 'master' was left open.
2020-05-29 10:05:52.416147 (MainThread): On master: Close
2020-05-29 10:05:53.130092 (MainThread): Connection 'list_ZOHO_OA_EDW' was left open.
2020-05-29 10:05:53.130092 (MainThread): On list_ZOHO_OA_EDW: Close
2020-05-29 10:05:54.105128 (MainThread): Connection 'list_ZOHO_OA_EDW_analytics' was left open.
2020-05-29 10:05:54.105128 (MainThread): On list_ZOHO_OA_EDW_analytics: Close
2020-05-29 10:05:54.989112 (MainThread): Connection 'model.vbi_zoho_people.TB_P_ATTENDANCE' was left open.
2020-05-29 10:05:54.989112 (MainThread): On model.vbi_zoho_people.TB_P_ATTENDANCE: Close
2020-05-29 10:05:56.103723 (MainThread): 
2020-05-29 10:05:56.106006 (MainThread): Completed successfully
2020-05-29 10:05:56.108750 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-05-29 10:05:56.131341 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0E3DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0AC418>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0E0AC988>]}
2020-05-29 10:05:56.132334 (MainThread): Flushing usage events
