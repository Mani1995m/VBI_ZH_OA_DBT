{"results": [{"node": {"raw_sql": "{{\r\n    config(\r\n        materialized = 'incremental',\r\n        unique_key = 'RECORDID' \r\n    )\r\n}}\r\n\r\nSelect \r\n    SRC:\"ApprovalStatus\"::varchar(30) as APPROVAL_STATUS,\r\n    to_date(SRC:\"Attendance Day\"::String , 'DD-Mon-YYYY') as ATTENDANCE_DAY,\r\n    TRY_TO_TIME(SRC:\"Break Time\"::String) as BREAK_TIME,    \r\n    SRC:\"Description\"::varchar(250) as DESCRIPTION,\r\n    TRY_TO_TIME(SRC:\"Deviation Time\"::String) as DEVIATION_TIME,\r\n    SRC:\"Employee ID\"::varchar(80) as EMPLOYEE_ID,\r\n    to_timestamp(SRC:\"Expected FromTime\"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_FROMTIME,\r\n    to_timestamp(SRC:\"Expected ToTime\"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_TOTIME,\r\n    case\r\n        when length(SRC:\"From Time\")=0 then\r\n            to_timestamp('0001-01-01 00:00:00')\r\n        else\r\n            to_timestamp(SRC:\"From Time\"::String, 'DD-MON-YYYY HH:MI:SS')\r\n    end\r\n    as FROM_TIME,\r\n    try_cast(SRC:\"InputType\"::String as Smallint) as INPUT_TYPE,\r\n    TRY_TO_TIME(SRC:\"Over Time\"::String) as OVER_TIME,  \r\n    try_cast(SRC:\"Status\"::String as Smallint) as STATUS,    \r\n    case\r\n        when length(SRC:\"To Time\")=0 then\r\n            to_timestamp('0001-01-01 00:00:00')\r\n        else\r\n            to_timestamp(SRC:\"To Time\"::String, 'DD-MON-YYYY HH:MI:SS')\r\n    end\r\n    as TO_TIME,\r\n    to_time(SRC:\"Total Hours\"::String, 'HH24:MI') as TOTAL_HOURS,\r\n    to_time(SRC:\"Working Hours\"::String, 'HH24:MI') as WORKING_HOURS,\r\n    SRC:\"createdTime\"::varchar(15) as CREATED_TIME_INT, \r\n    SRC:\"modifiedTime\"::varchar(15) as MODIFIED_TIME_INT,  \r\n    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,\r\n    SRC:\"ownerID\"::varchar(30) as OWNER_ID,    \r\n    SRC:\"ownerName\"::varchar(80) as OWNER_NAME,\r\n    SRC:\"recordId\"::varchar(20) as RECORDID\r\n    \r\nfrom {{ source('ZOHO_PEOPLE_VIEW', 'TB_HIST_P_ATTENDANCEFORM_VIEW')}}\r\n\r\n{% if is_incremental() %}\r\n    where MODIFIED_TIME > ( select max(MODIFIED_TIME) from {{ this }} )\r\n{% endif %}", "database": "ZOHO_OA_EDW", "schema": "ANALYTICS", "fqn": ["vbi_zoho_people", "analytics", "TB_P_ATTENDANCE"], "unique_id": "model.vbi_zoho_people.TB_P_ATTENDANCE", "package_name": "vbi_zoho_people", "root_path": "D:\\OneDrive - Visual BI Solutions Inc\\Projects\\ZOHO DW\\DBT\\VBI_ZOHO_PEOPLE", "path": "analytics\\TB_P_ATTENDANCE.sql", "original_file_path": "models\\analytics\\TB_P_ATTENDANCE.sql", "name": "TB_P_ATTENDANCE", "resource_type": "model", "alias": "TB_P_ATTENDANCE", "config": {"enabled": true, "materialized": "incremental", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "unique_key": "RECORDID"}, "tags": [], "refs": [], "sources": [["ZOHO_PEOPLE_VIEW", "TB_HIST_P_ATTENDANCEFORM_VIEW"]], "depends_on": {"macros": ["macro.dbt.is_incremental", "macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.statement"], "nodes": ["source.vbi_zoho_people.ZOHO_PEOPLE_VIEW.TB_HIST_P_ATTENDANCEFORM_VIEW"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target\\run\\vbi_zoho_people\\analytics\\TB_P_ATTENDANCE.sql", "compiled": true, "compiled_sql": "\n\nSelect \n    SRC:\"ApprovalStatus\"::varchar(30) as APPROVAL_STATUS,\n    to_date(SRC:\"Attendance Day\"::String , 'DD-Mon-YYYY') as ATTENDANCE_DAY,\n    TRY_TO_TIME(SRC:\"Break Time\"::String) as BREAK_TIME,    \n    SRC:\"Description\"::varchar(250) as DESCRIPTION,\n    TRY_TO_TIME(SRC:\"Deviation Time\"::String) as DEVIATION_TIME,\n    SRC:\"Employee ID\"::varchar(80) as EMPLOYEE_ID,\n    to_timestamp(SRC:\"Expected FromTime\"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_FROMTIME,\n    to_timestamp(SRC:\"Expected ToTime\"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_TOTIME,\n    case\n        when length(SRC:\"From Time\")=0 then\n            to_timestamp('0001-01-01 00:00:00')\n        else\n            to_timestamp(SRC:\"From Time\"::String, 'DD-MON-YYYY HH:MI:SS')\n    end\n    as FROM_TIME,\n    try_cast(SRC:\"InputType\"::String as Smallint) as INPUT_TYPE,\n    TRY_TO_TIME(SRC:\"Over Time\"::String) as OVER_TIME,  \n    try_cast(SRC:\"Status\"::String as Smallint) as STATUS,    \n    case\n        when length(SRC:\"To Time\")=0 then\n            to_timestamp('0001-01-01 00:00:00')\n        else\n            to_timestamp(SRC:\"To Time\"::String, 'DD-MON-YYYY HH:MI:SS')\n    end\n    as TO_TIME,\n    to_time(SRC:\"Total Hours\"::String, 'HH24:MI') as TOTAL_HOURS,\n    to_time(SRC:\"Working Hours\"::String, 'HH24:MI') as WORKING_HOURS,\n    SRC:\"createdTime\"::varchar(15) as CREATED_TIME_INT, \n    SRC:\"modifiedTime\"::varchar(15) as MODIFIED_TIME_INT,  \n    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,\n    SRC:\"ownerID\"::varchar(30) as OWNER_ID,    \n    SRC:\"ownerName\"::varchar(80) as OWNER_NAME,\n    SRC:\"recordId\"::varchar(20) as RECORDID\n    \nfrom ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_ATTENDANCEFORM_VIEW\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSelect \n    SRC:\"ApprovalStatus\"::varchar(30) as APPROVAL_STATUS,\n    to_date(SRC:\"Attendance Day\"::String , 'DD-Mon-YYYY') as ATTENDANCE_DAY,\n    TRY_TO_TIME(SRC:\"Break Time\"::String) as BREAK_TIME,    \n    SRC:\"Description\"::varchar(250) as DESCRIPTION,\n    TRY_TO_TIME(SRC:\"Deviation Time\"::String) as DEVIATION_TIME,\n    SRC:\"Employee ID\"::varchar(80) as EMPLOYEE_ID,\n    to_timestamp(SRC:\"Expected FromTime\"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_FROMTIME,\n    to_timestamp(SRC:\"Expected ToTime\"::String, 'DD-MON-YYYY HH:MI:SS') as EXPECTED_TOTIME,\n    case\n        when length(SRC:\"From Time\")=0 then\n            to_timestamp('0001-01-01 00:00:00')\n        else\n            to_timestamp(SRC:\"From Time\"::String, 'DD-MON-YYYY HH:MI:SS')\n    end\n    as FROM_TIME,\n    try_cast(SRC:\"InputType\"::String as Smallint) as INPUT_TYPE,\n    TRY_TO_TIME(SRC:\"Over Time\"::String) as OVER_TIME,  \n    try_cast(SRC:\"Status\"::String as Smallint) as STATUS,    \n    case\n        when length(SRC:\"To Time\")=0 then\n            to_timestamp('0001-01-01 00:00:00')\n        else\n            to_timestamp(SRC:\"To Time\"::String, 'DD-MON-YYYY HH:MI:SS')\n    end\n    as TO_TIME,\n    to_time(SRC:\"Total Hours\"::String, 'HH24:MI') as TOTAL_HOURS,\n    to_time(SRC:\"Working Hours\"::String, 'HH24:MI') as WORKING_HOURS,\n    SRC:\"createdTime\"::varchar(15) as CREATED_TIME_INT, \n    SRC:\"modifiedTime\"::varchar(15) as MODIFIED_TIME_INT,  \n    to_timestamp_ntz(MODIFIED_TIME_INT::BIGINT,3) as MODIFIED_TIME,\n    SRC:\"ownerID\"::varchar(30) as OWNER_ID,    \n    SRC:\"ownerName\"::varchar(80) as OWNER_NAME,\n    SRC:\"recordId\"::varchar(20) as RECORDID\n    \nfrom ZOHO_OA_EDW.RAW_ZOHO.TB_HIST_P_ATTENDANCEFORM_VIEW\n\n", "wrapped_sql": null}, "error": null, "status": "SUCCESS 1", "execution_time": 5.483237028121948, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-05-29T10:05:45.340523Z", "completed_at": "2020-05-29T10:05:45.414042Z"}, {"name": "execute", "started_at": "2020-05-29T10:05:45.414531Z", "completed_at": "2020-05-29T10:05:50.822763Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-05-29T10:05:56.084483Z", "elapsed_time": 20.632195711135864}